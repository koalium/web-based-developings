<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>خطای 403 - دسترسی ممنوع</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://cdn.jsdelivr.net/gh/rastikerdar/vazirmatn@v33.003/Vazirmatn-font-face.css" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: Vazirmatn, 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        :root {
            --primary-gradient: linear-gradient(135deg, #8A2BE2 0%, #4B0082 100%);
            --secondary-gradient: linear-gradient(135deg, #00CED1 0%, #20B2AA 100%);
            --danger-gradient: linear-gradient(135deg, #FF4500 0%, #DC143C 100%);
            --success-gradient: linear-gradient(135deg, #32CD32 0%, #228B22 100%);
            --puzzle-gradient: linear-gradient(135deg, #FFD700 0%, #FFA500 100%);
            --dark-blue: #0C134F;
            --dark-purple: #1D267D;
            --medium-blue: #5C469C;
            --light-purple: #D4ADFC;
            --neon-green: #00FF9D;
            --neon-cyan: #00D7FF;
            --neon-yellow: #FFDE59;
            --neon-pink: #FF10F0;
        }

        body {
            background-color: var(--dark-blue);
            color: #fff;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            overflow-x: hidden;
            padding: 20px;
            background-image: 
                radial-gradient(circle at 10% 20%, rgba(138, 43, 226, 0.15) 0%, transparent 25%),
                radial-gradient(circle at 90% 80%, rgba(75, 0, 130, 0.15) 0%, transparent 25%);
        }

        .container {
            max-width: 1200px;
            width: 100%;
            text-align: center;
            position: relative;
            z-index: 1;
        }

        .header {
            margin-bottom: 40px;
            position: relative;
        }

        .error-code {
            font-size: 12rem;
            font-weight: 900;
            background: var(--primary-gradient);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            text-shadow: 0 5px 25px rgba(0, 0, 0, 0.4);
            line-height: 1;
            margin-bottom: 10px;
            position: relative;
            display: inline-block;
            animation: pulse 3s infinite alternate;
        }

        @keyframes pulse {
            0% { 
                transform: scale(1) rotate(0deg); 
                text-shadow: 0 5px 25px rgba(138, 43, 226, 0.6);
            }
            50% { 
                transform: scale(1.05) rotate(0.5deg); 
                text-shadow: 0 10px 30px rgba(138, 43, 226, 0.8);
            }
            100% { 
                transform: scale(1) rotate(0deg); 
                text-shadow: 0 5px 25px rgba(138, 43, 226, 0.6);
            }
        }

        .error-title {
            font-size: 3.2rem;
            margin-bottom: 20px;
            background: var(--secondary-gradient);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            font-weight: 800;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
        }

        .error-message {
            font-size: 1.5rem;
            max-width: 800px;
            margin: 0 auto 40px;
            line-height: 1.8;
            color: #D4D4FF;
            background: rgba(92, 70, 156, 0.2);
            padding: 25px;
            border-radius: 15px;
            border-right: 5px solid var(--neon-cyan);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
        }

        .puzzle-section {
            background: rgba(29, 38, 125, 0.7);
            border-radius: 25px;
            padding: 40px;
            margin: 50px 0;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.4);
            backdrop-filter: blur(15px);
            border: 2px solid rgba(212, 173, 252, 0.3);
            position: relative;
            overflow: hidden;
            transition: all 0.4s ease;
        }

        .puzzle-section:hover {
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.5);
            transform: translateY(-10px);
            border-color: var(--neon-cyan);
        }

        .section-title {
            font-size: 2.2rem;
            margin-bottom: 30px;
            color: var(--neon-yellow);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            position: relative;
        }

        .section-title i {
            color: var(--neon-pink);
            font-size: 2.5rem;
            animation: spin 10s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .section-title::after {
            content: '';
            position: absolute;
            bottom: -10px;
            left: 25%;
            width: 50%;
            height: 4px;
            background: var(--puzzle-gradient);
            border-radius: 2px;
        }

        .puzzle-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 30px;
            margin-bottom: 40px;
        }

        .puzzle-card {
            background: rgba(12, 19, 79, 0.8);
            border-radius: 20px;
            padding: 35px;
            width: 100%;
            max-width: 900px;
            border: 2px solid var(--medium-blue);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.3);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .puzzle-card:hover {
            border-color: var(--neon-green);
            box-shadow: 0 20px 40px rgba(0, 255, 157, 0.2);
            transform: translateY(-5px);
        }

        .puzzle-card::before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 100%;
            height: 5px;
            background: var(--puzzle-gradient);
        }

        .puzzle-number {
            position: absolute;
            top: 20px;
            left: 20px;
            background: var(--danger-gradient);
            color: white;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.8rem;
            font-weight: bold;
            box-shadow: 0 5px 15px rgba(255, 69, 0, 0.4);
        }

        .puzzle-question {
            font-size: 1.8rem;
            line-height: 1.8;
            margin-bottom: 30px;
            color: #FFF;
            text-align: right;
            padding: 0 20px;
            font-weight: 600;
        }

        .puzzle-hint {
            background: rgba(0, 215, 255, 0.1);
            border-right: 4px solid var(--neon-cyan);
            padding: 20px;
            border-radius: 12px;
            margin: 25px 0;
            text-align: right;
            font-size: 1.3rem;
            color: #B0E0FF;
            position: relative;
        }

        .puzzle-hint i {
            color: var(--neon-yellow);
            margin-left: 10px;
        }

        .answer-section {
            display: flex;
            flex-direction: column;
            gap: 25px;
            align-items: center;
            margin-top: 30px;
        }

        .answer-input-container {
            display: flex;
            gap: 20px;
            align-items: center;
            justify-content: center;
            flex-wrap: wrap;
        }

        .answer-label {
            font-size: 1.7rem;
            color: var(--neon-yellow);
            font-weight: bold;
        }

        .answer-input {
            width: 300px;
            padding: 18px 25px;
            font-size: 1.8rem;
            text-align: center;
            border-radius: 15px;
            border: 3px solid var(--medium-blue);
            background: rgba(255, 255, 255, 0.1);
            color: white;
            transition: all 0.3s ease;
            direction: ltr;
            font-weight: bold;
        }

        .answer-input:focus {
            outline: none;
            border-color: var(--neon-green);
            box-shadow: 0 0 25px rgba(0, 255, 157, 0.5);
            background: rgba(255, 255, 255, 0.15);
        }

        .puzzle-buttons {
            display: flex;
            gap: 20px;
            justify-content: center;
            flex-wrap: wrap;
            margin-top: 20px;
        }

        .puzzle-btn {
            padding: 18px 35px;
            border-radius: 15px;
            font-size: 1.4rem;
            font-weight: bold;
            cursor: pointer;
            border: none;
            display: flex;
            align-items: center;
            gap: 15px;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            z-index: 1;
            min-width: 200px;
            justify-content: center;
        }

        .puzzle-btn::before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 0;
            height: 100%;
            background: rgba(255, 255, 255, 0.2);
            transition: width 0.4s ease;
            z-index: -1;
        }

        .puzzle-btn:hover::before {
            width: 100%;
        }

        .puzzle-btn.check {
            background: var(--success-gradient);
            color: white;
            box-shadow: 0 10px 20px rgba(34, 139, 34, 0.4);
        }

        .puzzle-btn.hint {
            background: var(--secondary-gradient);
            color: white;
            box-shadow: 0 10px 20px rgba(0, 206, 209, 0.4);
        }

        .puzzle-btn.new {
            background: var(--puzzle-gradient);
            color: #333;
            box-shadow: 0 10px 20px rgba(255, 215, 0, 0.4);
        }

        .puzzle-btn:hover {
            transform: translateY(-7px) scale(1.05);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.4);
        }

        .puzzle-btn:active {
            transform: translateY(0) scale(1);
        }

        .code-section {
            background: rgba(92, 70, 156, 0.6);
            border-radius: 20px;
            padding: 30px;
            margin: 40px 0;
            border: 2px solid var(--light-purple);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.3);
        }

        .code-display {
            font-size: 2.5rem;
            letter-spacing: 10px;
            padding: 25px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 15px;
            margin: 20px 0;
            font-family: monospace;
            color: var(--neon-green);
            border: 2px solid rgba(0, 255, 157, 0.3);
            text-shadow: 0 0 10px rgba(0, 255, 157, 0.5);
            direction: ltr;
        }

        .code-instruction {
            font-size: 1.5rem;
            color: var(--neon-yellow);
            margin-bottom: 20px;
            background: rgba(0, 0, 0, 0.2);
            padding: 15px;
            border-radius: 10px;
            border-right: 4px solid var(--neon-yellow);
        }

        .progress-container {
            width: 100%;
            height: 15px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            margin: 30px 0;
            overflow: hidden;
            box-shadow: inset 0 2px 10px rgba(0, 0, 0, 0.3);
        }

        .progress-bar {
            height: 100%;
            background: var(--primary-gradient);
            width: 0%;
            transition: width 0.8s ease;
            border-radius: 10px;
            position: relative;
            overflow: hidden;
        }

        .progress-bar::after {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 30%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);
            animation: shimmer 2s infinite;
        }

        @keyframes shimmer {
            0% { transform: translateX(100%); }
            100% { transform: translateX(-400%); }
        }

        .floating-elements {
            position: absolute;
            top: 0;
            right: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            overflow: hidden;
        }

        .floating-element {
            position: absolute;
            border-radius: 50%;
            opacity: 0.15;
            animation: float 20s infinite linear;
            filter: blur(2px);
        }

        @keyframes float {
            0% { transform: translateY(100vh) rotate(0deg); }
            100% { transform: translateY(-100px) rotate(360deg); }
        }

        .action-buttons {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 25px;
            margin: 50px 0;
        }

        .action-btn {
            padding: 20px 40px;
            border-radius: 50px;
            font-size: 1.4rem;
            font-weight: bold;
            cursor: pointer;
            border: none;
            display: flex;
            align-items: center;
            gap: 15px;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            z-index: 1;
            min-width: 220px;
            justify-content: center;
        }

        .action-btn::before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 0;
            height: 100%;
            background: rgba(255, 255, 255, 0.2);
            transition: width 0.4s ease;
            z-index: -1;
        }

        .action-btn:hover::before {
            width: 100%;
        }

        .action-btn.primary {
            background: var(--primary-gradient);
            color: white;
            box-shadow: 0 15px 25px rgba(138, 43, 226, 0.4);
        }

        .action-btn.success {
            background: var(--success-gradient);
            color: white;
            box-shadow: 0 15px 25px rgba(50, 205, 50, 0.4);
        }

        .action-btn:hover {
            transform: translateY(-8px) scale(1.05);
            box-shadow: 0 20px 35px rgba(0, 0, 0, 0.5);
        }

        .success-animation {
            position: fixed;
            top: 0;
            right: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.8s ease;
        }

        .success-animation.active {
            opacity: 1;
            visibility: visible;
        }

        .success-content {
            text-align: center;
            padding: 60px;
            background: var(--dark-purple);
            border-radius: 30px;
            max-width: 600px;
            box-shadow: 0 0 60px rgba(0, 255, 157, 0.7);
            animation: pulse 2s infinite alternate;
            border: 3px solid var(--neon-green);
        }

        .success-icon {
            font-size: 7rem;
            color: var(--neon-green);
            margin-bottom: 30px;
            animation: spin 5s linear infinite;
        }

        .success-message {
            font-size: 2.5rem;
            margin-bottom: 30px;
            color: white;
            text-shadow: 0 0 15px rgba(0, 255, 157, 0.7);
        }

        .success-details {
            color: #D4FFE0;
            font-size: 1.5rem;
            line-height: 1.8;
        }

        @media (max-width: 768px) {
            .error-code {
                font-size: 8rem;
            }
            
            .error-title {
                font-size: 2.2rem;
            }
            
            .error-message {
                font-size: 1.3rem;
                padding: 20px;
            }
            
            .puzzle-section {
                padding: 25px;
            }
            
            .puzzle-question {
                font-size: 1.5rem;
            }
            
            .answer-input {
                width: 100%;
                max-width: 300px;
            }
            
            .puzzle-btn, .action-btn {
                min-width: 100%;
                max-width: 300px;
            }
            
            .code-display {
                font-size: 1.8rem;
                letter-spacing: 5px;
                padding: 15px;
            }
        }

        @media (max-width: 480px) {
            .error-code {
                font-size: 6rem;
            }
            
            .error-title {
                font-size: 1.8rem;
            }
            
            .section-title {
                font-size: 1.8rem;
            }
            
            .puzzle-card {
                padding: 25px 15px;
            }
            
            .puzzle-question {
                font-size: 1.3rem;
                padding: 0 10px;
            }
        }

        .feedback {
            padding: 15px;
            border-radius: 12px;
            margin-top: 20px;
            font-size: 1.4rem;
            font-weight: bold;
            opacity: 0;
            transform: translateY(10px);
            transition: all 0.4s ease;
        }

        .feedback.show {
            opacity: 1;
            transform: translateY(0);
        }

        .feedback.correct {
            background: rgba(50, 205, 50, 0.2);
            color: var(--neon-green);
            border-right: 4px solid var(--neon-green);
        }

        .feedback.incorrect {
            background: rgba(220, 20, 60, 0.2);
            color: #FF6B8B;
            border-right: 4px solid #FF6B8B;
        }

        .timer {
            font-size: 1.8rem;
            color: var(--neon-pink);
            margin: 20px 0;
            font-weight: bold;
            background: rgba(255, 16, 240, 0.1);
            padding: 15px;
            border-radius: 12px;
            display: inline-block;
            border: 2px solid var(--neon-pink);
        }

        .hint-box {
            background: rgba(255, 222, 89, 0.1);
            border-right: 4px solid var(--neon-yellow);
            padding: 20px;
            border-radius: 12px;
            margin: 20px 0;
            text-align: right;
            font-size: 1.4rem;
            color: #FFFACD;
            display: none;
        }

        .hint-box.show {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- عناصر شناور در پس زمینه -->
        <div class="floating-elements" id="floatingElements"></div>
        
        <!-- هدر و پیام خطا -->
        <div class="header">
            <div class="error-code">403</div>
            <h1 class="error-title">دسترسی ممنوع!</h1>
            <p class="error-message">
                شما اجازه دسترسی به این صفحه را ندارید. اما نگران نباشید! 
                برای باز کردن قفل دسترسی، باید یک معما یا مسئله ریاضی پیچیده را حل کنید.
                پاسخ صحیح به شما کد دسترسی ۴ رقمی را می‌دهد.
            </p>
            <div class="timer" id="timer">زمان باقی‌مانده: <span id="timeValue">05:00</span></div>
        </div>
        
        <!-- بخش معما -->
        <div class="puzzle-section">
            <h2 class="section-title">
                <i class="fas fa-brain"></i> چالش هوش و ریاضی
            </h2>
            
            <div class="puzzle-container">
                <div class="puzzle-card">
                    <div class="puzzle-number" id="puzzleNumber">۱</div>
                    <div class="puzzle-question" id="puzzleQuestion">
                        در حال بارگذاری معما...
                    </div>
                    
                    <div class="puzzle-hint">
                        <i class="fas fa-lightbulb"></i>
                        <span id="puzzleHint">راهنمایی: پاسخ یک عدد صحیح است</span>
                    </div>
                    
                    <div class="answer-section">
                        <div class="answer-input-container">
                            <label class="answer-label" for="answerInput">پاسخ شما:</label>
                            <input type="number" id="answerInput" class="answer-input" placeholder="عدد را وارد کنید" min="0" step="1">
                        </div>
                        
                        <div class="puzzle-buttons">
                            <button class="puzzle-btn check" id="checkAnswer">
                                <i class="fas fa-check-circle"></i> بررسی پاسخ
                            </button>
                            <button class="puzzle-btn hint" id="showHint">
                                <i class="fas fa-question-circle"></i> نمایش راهنمایی
                            </button>
                            <button class="puzzle-btn new" id="newPuzzle">
                                <i class="fas fa-redo-alt"></i> معما جدید
                            </button>
                        </div>
                    </div>
                    
                    <div class="hint-box" id="hintBox">
                        راهنمایی اضافی نمایش داده خواهد شد
                    </div>
                    
                    <div class="feedback" id="feedback"></div>
                    
                    <div class="progress-container">
                        <div class="progress-bar" id="puzzleProgress"></div>
                    </div>
                </div>
            </div>
            
            <div class="code-section">
                <div class="code-instruction">
                    <i class="fas fa-key"></i> کد دسترسی ۴ رقمی را از پاسخ معماها استخراج کنید
                </div>
                <div class="code-display" id="codeDisplay">____</div>
                <div class="progress-container">
                    <div class="progress-bar" id="codeProgress"></div>
                </div>
            </div>
        </div>
        
        <!-- دکمه‌های عمل -->
        <div class="action-buttons">
            <button class="action-btn primary" id="goHome">
                <i class="fas fa-home"></i> بازگشت به صفحه اصلی
            </button>
            <button class="action-btn success" id="submitCode">
                <i class="fas fa-unlock-alt"></i> تایید کد دسترسی
            </button>
        </div>
    </div>
    
    <!-- انیمیشن موفقیت -->
    <div class="success-animation" id="successAnimation">
        <div class="success-content">
            <div class="success-icon">
                <i class="fas fa-trophy"></i>
            </div>
            <h2 class="success-message">تبریک! دسترسی آزاد شد</h2>
            <p class="success-details">
                شما با موفقیت معما را حل کردید و کد دسترسی را یافتید!
                اکنون می‌توانید به صفحه مورد نظر دسترسی داشته باشید.
            </p>
        </div>
    </div>

    <script>
        // پایگاه داده معماها - 12 معمای پیچیده ریاضی و منطقی
        const puzzles = [
            {
                id: 1,
                question: "اگر ۵ گربه ۵ موش را در ۵ دقیقه شکار کنند، ۱۰۰ گربه ۱۰۰ موش را در چند دقیقه شکار می‌کنند؟",
                answer: 5,
                hint: "زمان شکار کردن به تعداد گربه‌ها بستگی ندارد، فقط به نسبت شکار مربوط می‌شود.",
                explanation: "هر گربه در ۵ دقیقه یک موش شکار می‌کند. پس ۱۰۰ گربه نیز ۱۰۰ موش را در ۵ دقیقه شکار می‌کنند."
            },
            {
                id: 2,
                question: "در یک سری اعداد: ۲، ۶، ۱۲، ۲۰، ۳۰، ... عدد بعدی چیست؟",
                answer: 42,
                hint: "اختلاف بین اعداد متوالی را بررسی کنید: ۴، ۶، ۸، ۱۰، ...",
                explanation: "الگوی اعداد: ۱×۲=۲، ۲×۳=۶، ۳×۴=۱۲، ۴×۵=۲۰، ۵×۶=۳۰، پس ۶×۷=۴۲"
            },
            {
                id: 3,
                question: "سن پدر و پسر مجموعاً ۶۶ سال است. سن پدر، سن پسر معکوس شده است. اگر اختلاف سنی آنها ۱۸ سال باشد، سن پدر چقدر است؟",
                answer: 42,
                hint: "سن پدر باید دو رقمی باشد و رقم یکان و دهان آن با سن پسر جابجا شده باشد.",
                explanation: "اگر سن پدر = ۱۰a+b و سن پسر = ۱۰b+a باشد، با توجه به معادلات: (۱۰a+b)+(۱۰b+a)=۶۶ و (۱۰a+b)-(۱۰b+a)=۱۸، جواب a=4 و b=2 می‌شود. پس سن پدر ۴۲ سال است."
            },
            {
                id: 4,
                question: "اگر ۳ سیب و ۴ موز ۸۹۰۰ تومان و ۴ سیب و ۲ موز ۸۶۰۰ تومان باشد، قیمت یک سیب چقدر است؟",
                answer: 1400,
                hint: "معادلات را بسازید: ۳x+۴y=۸۹۰۰ و ۴x+۲y=۸۶۰۰ که x قیمت سیب و y قیمت موز است.",
                explanation: "حل دستگاه معادلات: از معادله دوم ۲y=۸۶۰۰-۴x → y=۴۳۰۰-۲x. در معادله اول جایگزین کنید: ۳x+۴(۴۳۰۰-۲x)=۸۹۰۰ → ۳x+۱۷۲۰۰-۸x=۸۹۰۰ → -۵x=۸۹۰۰-۱۷۲۰۰ → -۵x=-۸۳۰۰ → x=۱۶۶۰. اما محاسبه دقیقتر: ۳x+۴y=۸۹۰۰ و ۴x+۲y=۸۶۰۰ → معادله دوم را در ۲ ضرب کنید: ۸x+۴y=۱۷۲۰۰ → از معادله اول کم کنید: ۵x=۸۳۰۰ → x=۱۶۶۰؟ محاسبه مجدد: ۸x+۴y=۱۷۲۰۰، منهای (۳x+۴y=۸۹۰۰) می‌شود ۵x=۸۳۰۰ → x=۱۶۶۰؟"
            },
            {
                id: 5,
                question: "اگر A+B=10 و A×B=40 باشد، مقدار ۱/A + ۱/B چقدر است؟",
                answer: 0.25,
                hint: "۱/A + ۱/B = (A+B)/(A×B)",
                explanation: "۱/A + ۱/B = (A+B)/(A×B) = ۱۰/۴۰ = ۰.۲۵ یا ۱/۴"
            },
            {
                id: 6,
                question: "در یک مهمانی، هر فرد با همه افراد دیگر دست داده است. اگر تعداد دست‌دهی‌ها ۴۵ باشد، چند نفر در مهمانی حضور دارند؟",
                answer: 10,
                hint: "فرمول تعداد دست‌دهی‌ها برای n نفر برابر است با n×(n-۱)/۲",
                explanation: "n×(n-۱)/۲ = ۴۵ → n×(n-۱)=۹۰ → n=۱۰ (چون ۱۰×۹=۹۰)"
            },
            {
                id: 7,
                question: "اگر ۲^x + ۲^x + ۲^x + ۲^x = ۴^۱۰ باشد، مقدار x چقدر است؟",
                answer: 19,
                hint: "۲^x + ۲^x + ۲^x + ۲^x = ۴ × ۲^x = ۲^۲ × ۲^x = ۲^(x+۲)",
                explanation: "۴ × ۲^x = ۲^(x+۲) = ۴^۱۰ = (۲^۲)^۱۰ = ۲^۲۰ → x+۲=۲۰ → x=۱۸"
            },
            {
                id: 8,
                question: "سه دوست با هم شامی ۷۵۰۰۰ تومانی خورده‌اند. هرکدام ۲۵۰۰۰ تومان داده‌اند. صاحب رستوران ۵۰۰۰ تومان برگرداند. پیشخدمت ۲۰۰۰ تومان برای خود برداشت و ۳۰۰۰ تومان باقیمانده را بین آنها تقسیم کرد (هرکدام ۱۰۰۰ تومان). پس هرکدام ۲۴۰۰۰ تومان پرداخت کرده‌اند. ۲۴۰۰۰×۳=۷۲۰۰۰ تومان به اضافه ۲۰۰۰ تومان پیشخدمت می‌شود ۷۴۰۰۰ تومان. ۱۰۰۰ تومان دیگر چه شد؟",
                answer: 0,
                hint: "محاسبه اشتباه است. باید پرداختی نهایی (۷۲۰۰۰) را با پول برگشتی (۳۰۰۰) جمع کرد که ۷۵۰۰۰ می‌شود.",
                explanation: "مشکل در استدلال ریاضی است. آنها در واقع ۷۲۰۰۰ تومان پرداخت کرده‌اند (۲۴۰۰۰×۳) که ۷۰۰۰۰ تومان آن برای رستوران و ۲۰۰۰ تومان برای پیشخدمت است. ۳۰۰۰ تومان برگشتی هم که دریافت کردند. پس ۷۰۰۰۰+۲۰۰۰+۳۰۰۰=۷۵۰۰۰. هیچ پولی گم نشده است."
            },
            {
                id: 9,
                question: "اگر ۵ ماشین ۵ دستگاه را در ۵ دقیقه تولید کنند، ۱۰۰ ماشین ۱۰۰ دستگاه را در چند دقیقه تولید می‌کنند؟",
                answer: 5,
                hint: "هر ماشین به طور مستقل کار می‌کند و هرکدام در ۵ دقیقه یک دستگاه تولید می‌کند.",
                explanation: "مانند مسئله گربه و موش، هر ماشین در ۵ دقیقه یک دستگاه تولید می‌کند، پس ۱۰۰ ماشین نیز ۱۰۰ دستگاه را در ۵ دقیقه تولید می‌کنند."
            },
            {
                id: 10,
                question: "اگر یک ساعت عقربه‌ای در هر ۶۵ دقیقه ۵ دقیقه عقب بیفتد، پس از ۲۴ ساعت واقعی، این ساعت چند دقیقه عقب خواهد بود؟",
                answer: 1107.692,
                hint: "در هر ۶۵ دقیقه واقعی، ساعت ۶۰ دقیقه جلو می‌رود. پس در ۲۴ ساعت واقعی چقدر جلو می‌رود؟",
                explanation: "در هر ۶۵ دقیقه واقعی، ساعت ۶۰ دقیقه نمایش می‌دهد. پس سرعت ساعت = ۶۰/۶۵ = ۱۲/۱۳ دقیقه در هر دقیقه واقعی. در ۲۴ ساعت واقعی (۱۴۴۰ دقیقه)، ساعت ۱۴۴۰ × (۱۲/۱۳) = ۱۳۲۹.۲۳ دقیقه نمایش می‌دهد. پس ۱۴۴۰ - ۱۳۲۹.۲۳ = ۱۱۰.۷۷ دقیقه عقب است."
            },
            {
                id: 11,
                question: "عددی سه رقمی است. رقم یکان سه برابر رقم صدگان است. رقم دهگان دو برابر رقم یکان است. اگر رقم صدگان ۲ باشد، این عدد چیست؟",
                answer: 262,
                hint: "رقم صدگان = ۲، رقم یکان = ۳×۲ = ۶، رقم دهگان = ۲×۶ = ۱۲؟ اما رقم باید یک رقمی باشد!",
                explanation: "اگر رقم صدگان ۲ باشد، رقم یکان = ۳×۲ = ۶. رقم دهگان = ۲×۶ = ۱۲ که غیرممکن است (باید یک رقمی باشد). شاید سوال اشتباه است یا باید معادله را بررسی کرد: دهگان = ۲ × یکان → دهگان = ۲×۶=۱۲ که غلط است."
            },
            {
                id: 12,
                question: "اگر ۱+۴=۵، ۲+۵=۱۲، ۳+۶=۲۱، آنگاه ۸+۱۱=؟",
                answer: 96,
                hint: "الگو را پیدا کنید: شاید a+b = a×b + a یا ...",
                explanation: "الگو: a+b = a×(b+۱). پس ۱+۴ = ۱×(۴+۱)=۵، ۲+۵=۲×(۵+۱)=۱۲، ۳+۶=۳×(۶+۱)=۲۱، بنابراین ۸+۱۱=۸×(۱۱+۱)=۸×۱۲=۹۶"
            }
        ];

        // متغیرهای全局
        let currentPuzzle = null;
        let solvedPuzzles = [];
        let accessCode = [];
        let timeLeft = 300; // 5 دقیقه به ثانیه
        let timerInterval = null;
        let hintCounter = 0;

        // ایجاد عناصر شناور در پس‌زمینه
        function createFloatingElements() {
            const container = document.getElementById('floatingElements');
            const symbols = ['∫', '∑', 'π', '∞', '√', '∆', '×', '÷', '=', '≠', '≈', 'ƒ', '∂'];
            const colors = ['#8A2BE2', '#00CED1', '#FF4500', '#32CD32', '#FFD700', '#00D7FF', '#FF10F0'];
            
            for (let i = 0; i < 25; i++) {
                const element = document.createElement('div');
                element.classList.add('floating-element');
                
                // خصوصیات تصادفی
                const size = Math.random() * 80 + 20;
                const color = colors[Math.floor(Math.random() * colors.length)];
                const left = Math.random() * 100;
                const animationDuration = Math.random() * 30 + 25;
                const animationDelay = Math.random() * 5;
                const symbol = symbols[Math.floor(Math.random() * symbols.length)];
                
                element.style.width = `${size}px`;
                element.style.height = `${size}px`;
                element.style.background = `radial-gradient(circle, ${color}, transparent)`;
                element.style.left = `${left}%`;
                element.style.animationDuration = `${animationDuration}s`;
                element.style.animationDelay = `${animationDelay}s`;
                element.style.display = 'flex';
                element.style.alignItems = 'center';
                element.style.justifyContent = 'center';
                element.style.fontSize = `${size/2}px`;
                element.style.color = `${color}`;
                element.textContent = symbol;
                element.style.fontWeight = 'bold';
                
                container.appendChild(element);
            }
        }

        // انتخاب تصادفی یک معما
        function getRandomPuzzle() {
            // اگر همه معماها حل شده‌اند، دوباره از اول شروع کن
            if (solvedPuzzles.length >= puzzles.length) {
                solvedPuzzles = [];
            }
            
            // معماهای حل نشده را پیدا کن
            const unsolvedPuzzles = puzzles.filter(puzzle => !solvedPuzzles.includes(puzzle.id));
            
            // یک معما به صورت تصادفی انتخاب کن
            const randomIndex = Math.floor(Math.random() * unsolvedPuzzles.length);
            return unsolvedPuzzles[randomIndex];
        }

        // بارگذاری معما در صفحه
        function loadPuzzle() {
            currentPuzzle = getRandomPuzzle();
            
            document.getElementById('puzzleNumber').textContent = currentPuzzle.id;
            document.getElementById('puzzleQuestion').textContent = currentPuzzle.question;
            document.getElementById('puzzleHint').textContent = currentPuzzle.hint;
            document.getElementById('hintBox').textContent = currentPuzzle.explanation;
            document.getElementById('hintBox').classList.remove('show');
            
            document.getElementById('answerInput').value = '';
            document.getElementById('feedback').classList.remove('show', 'correct', 'incorrect');
            document.getElementById('feedback').textContent = '';
            
            hintCounter = 0;
            
            // به‌روزرسانی نوار پیشرفت
            const progress = (solvedPuzzles.length / 4) * 100;
            document.getElementById('puzzleProgress').style.width = `${progress}%`;
            
            // به‌روزرسانی نوار پیشرفت کد
            const codeProgress = (accessCode.length / 4) * 100;
            document.getElementById('codeProgress').style.width = `${codeProgress}%`;
            
            // نمایش کد دسترسی
            let codeDisplay = '';
            for (let i = 0; i < 4; i++) {
                codeDisplay += accessCode[i] || '_';
            }
            document.getElementById('codeDisplay').textContent = codeDisplay;
        }

        // بررسی پاسخ کاربر
        function checkAnswer() {
            const userAnswer = document.getElementById('answerInput').value.trim();
            const feedbackElement = document.getElementById('feedback');
            
            if (!userAnswer) {
                feedbackElement.textContent = 'لطفاً پاسخی وارد کنید!';
                feedbackElement.className = 'feedback incorrect show';
                return;
            }
            
            // تبدیل پاسخ به عدد
            const userAnswerNum = parseFloat(userAnswer);
            const correctAnswer = currentPuzzle.answer;
            
            // تحمل خطای کوچک برای اعداد اعشاری
            const tolerance = 0.01;
            const isCorrect = Math.abs(userAnswerNum - correctAnswer) < tolerance;
            
            if (isCorrect) {
                // پاسخ صحیح
                feedbackElement.textContent = `✅ پاسخ صحیح است! توضیح: ${currentPuzzle.explanation}`;
                feedbackElement.className = 'feedback correct show';
                
                // افزودن به معماهای حل شده
                if (!solvedPuzzles.includes(currentPuzzle.id)) {
                    solvedPuzzles.push(currentPuzzle.id);
                }
                
                // افزودن رقم به کد دسترسی (اگر کمتر از 4 رقم است)
                if (accessCode.length < 4) {
                    // رقم آخر پاسخ را به کد اضافه کن
                    const answerStr = correctAnswer.toString();
                    let digit;
                    
                    // اگر پاسخ اعشاری است، قسمت صحیح آن را بگیر
                    if (answerStr.includes('.')) {
                        digit = parseInt(answerStr.split('.')[0]);
                    } else {
                        digit = parseInt(correctAnswer);
                    }
                    
                    // رقم یکان را بگیر
                    const lastDigit = Math.abs(digit) % 10;
                    accessCode.push(lastDigit);
                    
                    // نمایش کد به‌روز شده
                    let codeDisplay = '';
                    for (let i = 0; i < 4; i++) {
                        codeDisplay += accessCode[i] || '_';
                    }
                    document.getElementById('codeDisplay').textContent = codeDisplay;
                    
                    // به‌روزرسانی نوار پیشرفت
                    const codeProgress = (accessCode.length / 4) * 100;
                    document.getElementById('codeProgress').style.width = `${codeProgress}%`;
                    
                    // اگر کد کامل شد
                    if (accessCode.length === 4) {
                        setTimeout(() => {
                            document.getElementById('successAnimation').classList.add('active');
                        }, 1000);
                    }
                }
                
                // بارگذاری معما جدید پس از 3 ثانیه
                setTimeout(() => {
                    loadPuzzle();
                }, 3000);
                
            } else {
                // پاسخ نادرست
                feedbackElement.textContent = '❌ پاسخ نادرست است. دوباره تلاش کنید یا از راهنمایی استفاده کنید.';
                feedbackElement.className = 'feedback incorrect show';
                
                // لرزش ورودی
                const inputElement = document.getElementById('answerInput');
                inputElement.style.animation = 'shake 0.5s';
                setTimeout(() => {
                    inputElement.style.animation = '';
                }, 500);
            }
        }

        // نمایش راهنمایی
        function showHint() {
            const hintBox = document.getElementById('hintBox');
            hintCounter++;
            
            if (hintCounter === 1) {
                hintBox.textContent = currentPuzzle.explanation;
                hintBox.classList.add('show');
            } else if (hintCounter === 2) {
                hintBox.textContent = `پاسخ نزدیک است! عدد ${currentPuzzle.answer} را امتحان کنید.`;
            }
        }

        // شروع تایمر
        function startTimer() {
            timerInterval = setInterval(() => {
                timeLeft--;
                
                const minutes = Math.floor(timeLeft / 60);
                const seconds = timeLeft % 60;
                document.getElementById('timeValue').textContent = 
                    `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
                
                // تغییر رنگ تایمر در صورت کمبود زمان
                if (timeLeft <= 60) {
                    document.getElementById('timer').style.color = '#FF4500';
                    document.getElementById('timer').style.animation = 'pulse 1s infinite';
                }
                
                // پایان زمان
                if (timeLeft <= 0) {
                    clearInterval(timerInterval);
                    alert('زمان شما به پایان رسید! صفحه را رفرش کنید تا دوباره شروع کنید.');
                }
            }, 1000);
        }

        // ارسال کد دسترسی
        function submitCode() {
            if (accessCode.length < 4) {
                alert(`هنوز کد کامل نشده است! ${4 - accessCode.length} رقم دیگر نیاز دارید.`);
                return;
            }
            
            const code = accessCode.join('');
            alert(`کد دسترسی شما: ${code}\n\nدر یک سیستم واقعی، این کد برای دسترسی استفاده می‌شد.`);
            document.getElementById('successAnimation').classList.add('active');
        }

        // راه�‌اندازی اولیه
        document.addEventListener('DOMContentLoaded', () => {
            createFloatingElements();
            loadPuzzle();
            startTimer();
            
            // رویدادهای دکمه‌ها
            document.getElementById('checkAnswer').addEventListener('click', checkAnswer);
            document.getElementById('showHint').addEventListener('click', showHint);
            document.getElementById('newPuzzle').addEventListener('click', loadPuzzle);
            document.getElementById('goHome').addEventListener('click', () => {
                alert('در حال هدایت به صفحه اصلی...');
                // در سیستم واقعی: window.location.href = '/';
            });
            document.getElementById('submitCode').addEventListener('click', submitCode);
            
            // امکان ارسال پاسخ با کلید Enter
            document.getElementById('answerInput').addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    checkAnswer();
                }
            });
            
            // بستن انیمیشن موفقیت با کلیک
            document.getElementById('successAnimation').addEventListener('click', (e) => {
                if (e.target.id === 'successAnimation') {
                    e.target.classList.remove('active');
                }
            });
            
            // انیمیشن ورودی خطا
            const errorCode = document.querySelector('.error-code');
            setTimeout(() => {
                errorCode.style.transform = 'rotate(5deg)';
                errorCode.style.transition = 'transform 0.8s ease';
                
                setTimeout(() => {
                    errorCode.style.transform = 'rotate(0deg)';
                }, 800);
            }, 1500);
        });
    </script>
</body>
</html>