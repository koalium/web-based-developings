<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HVAC & Air Wash System Calculator</title>
    <script src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js" defer></script>
    <style>
        :root {
            --primary: #667eea;
            --secondary: #764ba2;
            --success: #28a745;
            --warning: #ffc107;
            --danger: #dc3545;
            --light: #f8f9fa;
            --dark: #343a40;
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            overflow: hidden;
        }
        
        header {
            background: linear-gradient(45deg, var(--primary), var(--secondary));
            color: white;
            padding: 20px;
            text-align: center;
        }
        
        h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }
        
        .subtitle {
            font-size: 1.2rem;
            opacity: 0.9;
        }
        
        .main-content {
            display: grid;
            grid-template-columns: 300px 1fr;
            min-height: 80vh;
        }
        
        .sidebar {
            background: var(--light);
            padding: 20px;
            border-right: 1px solid #dee2e6;
        }
        
        .nav-item {
            display: block;
            padding: 12px 15px;
            margin-bottom: 8px;
            background: white;
            border-radius: 8px;
            text-decoration: none;
            color: var(--dark);
            font-weight: 500;
            transition: all 0.3s;
            border-left: 4px solid transparent;
        }
        
        .nav-item:hover, .nav-item.active {
            background: var(--primary);
            color: white;
            border-left-color: var(--secondary);
        }
        
        .content {
            padding: 20px;
            overflow-y: auto;
            max-height: 80vh;
        }
        
        .section {
            margin-bottom: 30px;
            padding: 20px;
            border: 1px solid #dee2e6;
            border-radius: 10px;
            background: white;
            box-shadow: 0 4px 6px rgba(0,0,0,0.05);
        }
        
        .section h2 {
            color: var(--primary);
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--light);
        }
        
        .input-group {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 15px;
            margin-bottom: 15px;
        }
        
        .input-field {
            margin-bottom: 15px;
        }
        
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
            color: var(--dark);
        }
        
        input, select {
            width: 100%;
            padding: 10px;
            border: 1px solid #ced4da;
            border-radius: 5px;
            font-size: 16px;
            transition: border-color 0.3s;
        }
        
        input:focus, select:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.25);
        }
        
        button {
            background: var(--primary);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            margin: 5px;
            transition: background 0.3s;
        }
        
        button:hover {
            background: var(--secondary);
        }
        
        .btn-success {
            background: var(--success);
        }
        
        .btn-warning {
            background: var(--warning);
            color: var(--dark);
        }
        
        .btn-danger {
            background: var(--danger);
        }
        
        .results {
            background: #e8f5e8;
            padding: 20px;
            border-radius: 8px;
            margin-top: 20px;
        }
        
        .result-item {
            margin: 10px 0;
            padding: 10px;
            background: white;
            border-radius: 4px;
            border-left: 4px solid var(--primary);
        }
        
        .controls {
            text-align: center;
            margin: 20px 0;
        }
        
        .json-area {
            width: 100%;
            height: 200px;
            margin-top: 10px;
            font-family: monospace;
            font-size: 12px;
            padding: 10px;
            border: 1px solid #ced4da;
            border-radius: 5px;
        }
        
        .collapsible {
            margin-bottom: 15px;
        }
        
        .collapsible-header {
            background: var(--light);
            padding: 15px;
            border-radius: 8px;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-weight: 600;
        }
        
        .collapsible-content {
            padding: 15px;
            border: 1px solid #dee2e6;
            border-top: none;
            border-radius: 0 0 8px 8px;
            display: none;
        }
        
        .collapsible.active .collapsible-content {
            display: block;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
        }
        
        th, td {
            border: 1px solid #dee2e6;
            padding: 10px;
            text-align: center;
        }
        
        th {
            background: var(--light);
        }
        
        .warning {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
            color: #856404;
        }
        
        .error {
            background: #f8d7da;
            border: 1px solid #f5c6cb;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
            color: #721c24;
        }
        
        .good {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
            color: #155724;
        }
        
        .advice-section {
            background: #e3f2fd;
            border-left: 4px solid #2196f3;
            padding: 15px;
            margin-top: 20px;
            border-radius: 5px;
        }
        
        .advice-section h4 {
            color: #1976d2;
            margin-bottom: 10px;
        }
        
        .space-block {
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
            background: #f8f9fa;
        }
        
        .space-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .space-title {
            font-weight: 600;
            color: var(--primary);
        }
        
        .remove-btn {
            background: var(--danger);
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 4px;
            cursor: pointer;
        }
        
        .cost-table {
            width: 100%;
            margin: 15px 0;
        }
        
        .cost-table th {
            background: var(--primary);
            color: white;
        }
        
        .cost-table tr:nth-child(even) {
            background: #f8f9fa;
        }
        
        .total-cost {
            font-weight: bold;
            font-size: 1.2em;
            color: var(--primary);
            margin-top: 15px;
            padding: 10px;
            background: #e8f5e8;
            border-radius: 5px;
        }
        
        .component-list {
            list-style-type: none;
            padding: 0;
        }
        
        .component-list li {
            padding: 8px 0;
            border-bottom: 1px solid #dee2e6;
        }
        
        .component-list li:last-child {
            border-bottom: none;
        }
    </style>
</head>
<body>
    <div class="container" x-data="hvacCalculator()">
        <header>
            <h1>HVAC & Air Wash System Calculator</h1>
            <p class="subtitle">Complete HVAC system design and calculation tool</p>
        </header>
        
        <div class="main-content">
            <div class="sidebar">
                <a href="#" class="nav-item active" @click="activeSection = 'problem'">Problem Definition</a>
                <a href="#" class="nav-item" @click="activeSection = 'building'">Building Dimension</a>
                <a href="#" class="nav-item" @click="activeSection = 'load'">Load Estimation</a>
                <a href="#" class="nav-item" @click="activeSection = 'ac'">AC Station</a>
                <a href="#" class="nav-item" @click="activeSection = 'airflow'">Air Flow</a>
                <a href="#" class="nav-item" @click="activeSection = 'duct'">Duct & Vent</a>
                <a href="#" class="nav-item" @click="activeSection = 'arf'">ARF</a>
                <a href="#" class="nav-item" @click="activeSection = 'dust'">Dust Collector</a>
                <a href="#" class="nav-item" @click="activeSection = 'airwash'">Air Washer</a>
                <a href="#" class="nav-item" @click="activeSection = 'damper'">Damper & Coil</a>
                <a href="#" class="nav-item" @click="activeSection = 'fan'">Fan & Motors</a>
                <a href="#" class="nav-item" @click="activeSection = 'report'">Report</a>
                <a href="#" class="nav-item" @click="activeSection = 'mto'">MTO</a>
                <a href="#" class="nav-item" @click="activeSection = 'cost'">Cost Estimation</a>
                <a href="#" class="nav-item" @click="activeSection = 'bom'">BOM</a>
            </div>
            
            <div class="content">
                <!-- Problem Definition Section -->
                <div x-show="activeSection === 'problem'" class="section">
                    <h2>Problem Definition</h2>
                    <div class="input-group">
                        <div class="input-field">
                            <label for="projectName">Project Name:</label>
                            <input type="text" id="projectName" x-model="projectData.name" placeholder="Enter project name">
                        </div>
                        <div class="input-field">
                            <label for="projectLocation">Location:</label>
                            <input type="text" id="projectLocation" x-model="projectData.location" placeholder="Enter project location">
                        </div>
                    </div>
                    <div class="input-field">
                        <label for="projectDescription">Project Description:</label>
                        <textarea id="projectDescription" x-model="projectData.description" rows="4" placeholder="Describe the HVAC system requirements..." style="width: 100%; padding: 10px; border: 1px solid #ced4da; border-radius: 5px;"></textarea>
                    </div>
                    <div class="input-group">
                        <div class="input-field">
                            <label for="designerName">Designer Name:</label>
                            <input type="text" id="designerName" x-model="projectData.designer" placeholder="Enter designer name">
                        </div>
                        <div class="input-field">
                            <label for="designDate">Design Date:</label>
                            <input type="date" id="designDate" x-model="projectData.date">
                        </div>
                    </div>
                </div>
                
                <!-- Building Dimension Section -->
                <div x-show="activeSection === 'building'" class="section">
                    <h2>Building Dimension</h2>
                    <div class="input-group">
                        <div class="input-field">
                            <label for="buildingLength">Building Length (m):</label>
                            <input type="number" id="buildingLength" x-model="building.length" step="0.1" value="50">
                        </div>
                        <div class="input-field">
                            <label for="buildingWidth">Building Width (m):</label>
                            <input type="number" id="buildingWidth" x-model="building.width" step="0.1" value="30">
                        </div>
                        <div class="input-field">
                            <label for="buildingHeight">Building Height (m):</label>
                            <input type="number" id="buildingHeight" x-model="building.height" step="0.1" value="5">
                        </div>
                    </div>
                    <div class="input-group">
                        <div class="input-field">
                            <label for="wallArea">Wall Area (m²):</label>
                            <input type="number" id="wallArea" x-model="building.wallArea" step="0.1" value="800">
                        </div>
                        <div class="input-field">
                            <label for="roofArea">Roof Area (m²):</label>
                            <input type="number" id="roofArea" x-model="building.roofArea" step="0.1" value="1500">
                        </div>
                    </div>
                    <div class="input-field">
                        <label for="wallMaterial">Wall Material:</label>
                        <select id="wallMaterial" x-model="building.wallMaterial">
                            <option value="brick">Brick</option>
                            <option value="concrete">Concrete</option>
                            <option value="steel">Steel Panel</option>
                            <option value="wood">Wood</option>
                        </select>
                    </div>
                    <div class="input-field">
                        <label for="roofMaterial">Roof Material:</label>
                        <select id="roofMaterial" x-model="building.roofMaterial">
                            <option value="concrete">Concrete</option>
                            <option value="metal">Metal</option>
                            <option value="tile">Tile</option>
                            <option value="asphalt">Asphalt</option>
                        </select>
                    </div>
                </div>
                
                <!-- Load Estimation Section -->
                <div x-show="activeSection === 'load'" class="section">
                    <h2>Load Estimation</h2>
                    <div class="input-group">
                        <div class="input-field">
                            <label for="sunlightPower">Sunlight Power (W/m²):</label>
                            <input type="number" id="sunlightPower" x-model="loadEstimation.sunlightPower" step="0.1" value="800">
                        </div>
                        <div class="input-field">
                            <label for="machinePower">Machine Power (kW):</label>
                            <input type="number" id="machinePower" x-model="loadEstimation.machinePower" step="0.1" value="150">
                        </div>
                    </div>
                    <div class="input-group">
                        <div class="input-field">
                            <label for="hottestTemp">Hottest Day Temp (°C):</label>
                            <input type="number" id="hottestTemp" x-model="loadEstimation.hottestTemp" step="0.1" value="45">
                        </div>
                        <div class="input-field">
                            <label for="hottestHumidity">Hottest Day Humidity (%):</label>
                            <input type="number" id="hottestHumidity" x-model="loadEstimation.hottestHumidity" step="0.1" value="70">
                        </div>
                    </div>
                    <div class="input-group">
                        <div class="input-field">
                            <label for="coldestTemp">Coldest Day Temp (°C):</label>
                            <input type="number" id="coldestTemp" x-model="loadEstimation.coldestTemp" step="0.1" value="-5">
                        </div>
                        <div class="input-field">
                            <label for="coldestHumidity">Coldest Day Humidity (%):</label>
                            <input type="number" id="coldestHumidity" x-model="loadEstimation.coldestHumidity" step="0.1" value="30">
                        </div>
                    </div>
                    <div class="input-group">
                        <div class="input-field">
                            <label for="insideTemp">Inside Temperature (°C):</label>
                            <input type="number" id="insideTemp" x-model="loadEstimation.insideTemp" step="0.1" value="22">
                        </div>
                        <div class="input-field">
                            <label for="insideHumidity">Inside Humidity (%):</label>
                            <input type="number" id="insideHumidity" x-model="loadEstimation.insideHumidity" step="0.1" value="50">
                        </div>
                    </div>
                    <div class="controls">
                        <button @click="calculateLoadEstimation()">Calculate Load Estimation</button>
                    </div>
                    <div x-show="loadEstimation.results" class="results">
                        <h3>Load Estimation Results</h3>
                        <div class="result-item">
                            <strong>Roof Area:</strong> <span x-text="building.roofArea.toFixed(2)"></span> m²
                        </div>
                        <div class="result-item">
                            <strong>Sunlight Heating:</strong> <span x-text="loadEstimation.results.sunlightHeating.toFixed(2)"></span> kW
                        </div>
                        <div class="result-item">
                            <strong>Total Added Heat:</strong> <span x-text="loadEstimation.results.totalAddedHeat.toFixed(2)"></span> kW
                        </div>
                        <div class="result-item">
                            <strong>Wall Heat Conduction:</strong> <span x-text="loadEstimation.results.wallHeatConduction.toFixed(2)"></span> kW
                        </div>
                        <div class="result-item">
                            <strong>Roof Heat Conduction:</strong> <span x-text="loadEstimation.results.roofHeatConduction.toFixed(2)"></span> kW
                        </div>
                        <div class="result-item">
                            <strong>Total Heat Load:</strong> <span x-text="loadEstimation.results.totalHeatLoad.toFixed(2)"></span> kW
                        </div>
                    </div>
                </div>
                
                <!-- AC Station Section -->
                <div x-show="activeSection === 'ac'" class="section">
                    <h2>AC Station</h2>
                    <div class="input-group">
                        <div class="input-field">
                            <label for="acType">AC System Type:</label>
                            <select id="acType" x-model="acStation.type">
                                <option value="split">Split System</option>
                                <option value="package">Package Unit</option>
                                <option value="vrf">VRF System</option>
                                <option value="chiller">Chiller System</option>
                            </select>
                        </div>
                        <div class="input-field">
                            <label for="acCapacity">AC Capacity (kW):</label>
                            <input type="number" id="acCapacity" x-model="acStation.capacity" step="0.1" value="200">
                        </div>
                    </div>
                    <div class="input-group">
                        <div class="input-field">
                            <label for="coolingTower">Cooling Tower Capacity (m³/h):</label>
                            <input type="number" id="coolingTower" x-model="acStation.coolingTower" step="0.1" value="50">
                        </div>
                        <div class="input-field">
                            <label for="chiller">Chiller Capacity (TR):</label>
                            <input type="number" id="chiller" x-model="acStation.chiller" step="0.1" value="60">
                        </div>
                    </div>
                    <div class="input-field">
                        <label for="acDescription">AC Station Description:</label>
                        <textarea id="acDescription" x-model="acStation.description" rows="3" style="width: 100%; padding: 10px; border: 1px solid #ced4da; border-radius: 5px;"></textarea>
                    </div>
                </div>
                
                <!-- Air Flow Section -->
                <div x-show="activeSection === 'airflow'" class="section">
                    <h2>Air Flow</h2>
                    <div class="controls">
                        <button @click="addSpace()">Add Space</button>
                    </div>
                    
                    <template x-for="(space, index) in airflow.spaces" :key="index">
                        <div class="space-block">
                            <div class="space-header">
                                <div class="space-title">AC Space <span x-text="index + 1"></span></div>
                                <button class="remove-btn" @click="removeSpace(index)">Remove</button>
                            </div>
                            <div class="input-group">
                                <div class="input-field">
                                    <label :for="'spaceName_' + index">Space Name:</label>
                                    <input type="text" :id="'spaceName_' + index" x-model="space.name" placeholder="Enter space name">
                                </div>
                                <div class="input-field">
                                    <label :for="'spaceWidth_' + index">Width (m):</label>
                                    <input type="number" :id="'spaceWidth_' + index" x-model="space.width" step="0.1" value="21">
                                </div>
                                <div class="input-field">
                                    <label :for="'spaceLength_' + index">Length (m):</label>
                                    <input type="number" :id="'spaceLength_' + index" x-model="space.length" step="0.1" value="44">
                                </div>
                                <div class="input-field">
                                    <label :for="'spaceHeight_' + index">Height (m):</label>
                                    <input type="number" :id="'spaceHeight_' + index" x-model="space.height" step="0.1" value="4.4">
                                </div>
                                <div class="input-field">
                                    <label :for="'spaceACH_' + index">ACH:</label>
                                    <input type="number" :id="'spaceACH_' + index" x-model="space.ach" step="0.1" value="33">
                                </div>
                            </div>
                            <div class="controls">
                                <button @click="calculateSpace(index)">Calculate Space</button>
                            </div>
                            <div x-show="space.results" class="results">
                                <h4>Space Calculation Results</h4>
                                <div class="result-item">
                                    <strong>Area:</strong> <span x-text="space.results.area.toFixed(2)"></span> m²
                                </div>
                                <div class="result-item">
                                    <strong>Volume:</strong> <span x-text="space.results.volume.toFixed(2)"></span> m³
                                </div>
                                <div class="result-item">
                                    <strong>Airflow (m³/hr):</strong> <span x-text="space.results.airflowM3Hr.toFixed(2)"></span>
                                </div>
                                <div class="result-item">
                                    <strong>Airflow (m³/s):</strong> <span x-text="space.results.airflowM3S.toFixed(3)"></span>
                                </div>
                                <div class="result-item">
                                    <strong>Airflow (CFM):</strong> <span x-text="space.results.airflowCFM.toFixed(2)"></span>
                                </div>
                            </div>
                        </div>
                    </template>
                </div>
                
                <!-- Duct & Vent Section -->
                <div x-show="activeSection === 'duct'" class="section">
                    <h2>Duct & Vent</h2>
                    
                    <!-- Supply Duct -->
                    <div class="collapsible" :class="{ active: ductVent.supplyDuctOpen }">
                        <div class="collapsible-header" @click="ductVent.supplyDuctOpen = !ductVent.supplyDuctOpen">
                            Supply Duct
                            <span x-text="ductVent.supplyDuctOpen ? '−' : '+'"></span>
                        </div>
                        <div class="collapsible-content">
                            <div class="input-group">
                                <div class="input-field">
                                    <label for="supplyDuctShape">Duct Shape:</label>
                                    <select id="supplyDuctShape" x-model="ductVent.supplyDuct.shape">
                                        <option value="circular">Circular</option>
                                        <option value="rectangular">Rectangular</option>
                                    </select>
                                </div>
                                <div class="input-field" x-show="ductVent.supplyDuct.shape === 'circular'">
                                    <label for="supplyDuctDiameter">Diameter (m):</label>
                                    <input type="number" id="supplyDuctDiameter" x-model="ductVent.supplyDuct.diameter" step="0.01" value="1.2">
                                </div>
                                <div class="input-field" x-show="ductVent.supplyDuct.shape === 'rectangular'">
                                    <label for="supplyDuctWidth">Width (m):</label>
                                    <input type="number" id="supplyDuctWidth" x-model="ductVent.supplyDuct.width" step="0.01" value="1.8">
                                </div>
                                <div class="input-field" x-show="ductVent.supplyDuct.shape === 'rectangular'">
                                    <label for="supplyDuctHeight">Height (m):</label>
                                    <input type="number" id="supplyDuctHeight" x-model="ductVent.supplyDuct.height" step="0.01" value="1.2">
                                </div>
                                <div class="input-field">
                                    <label for="supplyDuctNumber">Number of Ducts:</label>
                                    <input type="number" id="supplyDuctNumber" x-model="ductVent.supplyDuct.number" value="4">
                                </div>
                            </div>
                            <div class="input-group">
                                <div class="input-field">
                                    <label for="supplyVentWidth">Vent Width (m):</label>
                                    <input type="number" id="supplyVentWidth" x-model="ductVent.supplyDuct.ventWidth" step="0.01" value="0.5">
                                </div>
                                <div class="input-field">
                                    <label for="supplyVentLength">Vent Length (m):</label>
                                    <input type="number" id="supplyVentLength" x-model="ductVent.supplyDuct.ventLength" step="0.01" value="1.2">
                                </div>
                                <div class="input-field">
                                    <label for="supplyVentNumber">Number of Vents:</label>
                                    <input type="number" id="supplyVentNumber" x-model="ductVent.supplyDuct.ventNumber" value="8">
                                </div>
                            </div>
                            <div class="controls">
                                <button @click="calculateSupplyDuct()">Calculate Supply Duct</button>
                            </div>
                            <div x-show="ductVent.supplyDuct.results" class="results">
                                <h4>Supply Duct Results</h4>
                                <div class="result-item">
                                    <strong>Duct Cross Section Area:</strong> <span x-text="ductVent.supplyDuct.results.ductArea.toFixed(4)"></span> m²
                                </div>
                                <div class="result-item">
                                    <strong>Total Duct Area:</strong> <span x-text="ductVent.supplyDuct.results.totalDuctArea.toFixed(4)"></span> m²
                                </div>
                                <div class="result-item">
                                    <strong>Air Velocity in Duct:</strong> <span x-text="ductVent.supplyDuct.results.ductVelocity.toFixed(2)"></span> m/s
                                    <span x-show="ductVent.supplyDuct.results.ductVelocityStatus === 'HIGH'" class="error">(HIGH - Reduce duct size or increase number)</span>
                                    <span x-show="ductVent.supplyDuct.results.ductVelocityStatus === 'LOW'" class="warning">(LOW - Increase duct size or reduce number)</span>
                                    <span x-show="ductVent.supplyDuct.results.ductVelocityStatus === 'OK'" class="good">(OK - Within optimal range)</span>
                                </div>
                                <div class="result-item">
                                    <strong>Vent Area:</strong> <span x-text="ductVent.supplyDuct.results.ventArea.toFixed(4)"></span> m²
                                </div>
                                <div class="result-item">
                                    <strong>Total Vent Area:</strong> <span x-text="ductVent.supplyDuct.results.totalVentArea.toFixed(4)"></span> m²
                                </div>
                                <div class="result-item">
                                    <strong>Air Velocity in Vent:</strong> <span x-text="ductVent.supplyDuct.results.ventVelocity.toFixed(2)"></span> m/s
                                    <span x-show="ductVent.supplyDuct.results.ventVelocityStatus === 'HIGH'" class="error">(HIGH - Reduce vent size or increase number)</span>
                                    <span x-show="ductVent.supplyDuct.results.ventVelocityStatus === 'LOW'" class="warning">(LOW - Increase vent size or reduce number)</span>
                                    <span x-show="ductVent.supplyDuct.results.ventVelocityStatus === 'OK'" class="good">(OK - Within optimal range)</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Return Duct -->
                    <div class="collapsible" :class="{ active: ductVent.returnDuctOpen }">
                        <div class="collapsible-header" @click="ductVent.returnDuctOpen = !ductVent.returnDuctOpen">
                            Return Duct
                            <span x-text="ductVent.returnDuctOpen ? '−' : '+'"></span>
                        </div>
                        <div class="collapsible-content">
                            <div class="input-group">
                                <div class="input-field">
                                    <label for="returnDuctWidth">Duct Width (m):</label>
                                    <input type="number" id="returnDuctWidth" x-model="ductVent.returnDuct.width" step="0.01" value="1.5">
                                </div>
                                <div class="input-field">
                                    <label for="returnDuctHeight">Duct Height (m):</label>
                                    <input type="number" id="returnDuctHeight" x-model="ductVent.returnDuct.height" step="0.01" value="1.0">
                                </div>
                                <div class="input-field">
                                    <label for="returnDuctNumber">Number of Ducts:</label>
                                    <input type="number" id="returnDuctNumber" x-model="ductVent.returnDuct.number" value="2">
                                </div>
                            </div>
                            <div class="input-group">
                                <div class="input-field">
                                    <label for="returnVentWidth">Vent Width (m):</label>
                                    <input type="number" id="returnVentWidth" x-model="ductVent.returnDuct.ventWidth" step="0.01" value="0.05">
                                </div>
                                <div class="input-field">
                                    <label for="returnVentLength">Vent Length (m):</label>
                                    <input type="number" id="returnVentLength" x-model="ductVent.returnDuct.ventLength" step="0.01" :value="ductVent.returnDuct.width">
                                </div>
                                <div class="input-field">
                                    <label for="returnVentNumber">Number of Vents:</label>
                                    <input type="number" id="returnVentNumber" x-model="ductVent.returnDuct.ventNumber" value="4">
                                </div>
                            </div>
                            <div class="controls">
                                <button @click="calculateReturnDuct()">Calculate Return Duct</button>
                            </div>
                            <div x-show="ductVent.returnDuct.results" class="results">
                                <h4>Return Duct Results</h4>
                                <div class="result-item">
                                    <strong>Duct Cross Section Area:</strong> <span x-text="ductVent.returnDuct.results.ductArea.toFixed(4)"></span> m²
                                </div>
                                <div class="result-item">
                                    <strong>Total Duct Area:</strong> <span x-text="ductVent.returnDuct.results.totalDuctArea.toFixed(4)"></span> m²
                                </div>
                                <div class="result-item">
                                    <strong>Air Velocity in Duct:</strong> <span x-text="ductVent.returnDuct.results.ductVelocity.toFixed(2)"></span> m/s
                                    <span x-show="ductVent.returnDuct.results.ductVelocityStatus === 'HIGH'" class="error">(HIGH - Reduce duct size or increase number)</span>
                                    <span x-show="ductVent.returnDuct.results.ductVelocityStatus === 'LOW'" class="warning">(LOW - Increase duct size or reduce number)</span>
                                    <span x-show="ductVent.returnDuct.results.ductVelocityStatus === 'OK'" class="good">(OK - Within optimal range)</span>
                                </div>
                                <div class="result-item">
                                    <strong>Vent Area:</strong> <span x-text="ductVent.returnDuct.results.ventArea.toFixed(4)"></span> m²
                                </div>
                                <div class="result-item">
                                    <strong>Total Vent Area:</strong> <span x-text="ductVent.returnDuct.results.totalVentArea.toFixed(4)"></span> m²
                                </div>
                                <div class="result-item">
                                    <strong>Air Velocity in Vent:</strong> <span x-text="ductVent.returnDuct.results.ventVelocity.toFixed(2)"></span> m/s
                                    <span x-show="ductVent.returnDuct.results.ventVelocityStatus === 'HIGH'" class="error">(HIGH - Reduce vent size or increase number)</span>
                                    <span x-show="ductVent.returnDuct.results.ventVelocityStatus === 'LOW'" class="warning">(LOW - Increase vent size or reduce number)</span>
                                    <span x-show="ductVent.returnDuct.results.ventVelocityStatus === 'OK'" class="good">(OK - Within optimal range)</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- ARF Section -->
                <div x-show="activeSection === 'arf'" class="section">
                    <h2>Air Rotary Filter (ARF)</h2>
                    <div class="input-group">
                        <div class="input-field">
                            <label for="filterNumber">Number of Filters:</label>
                            <input type="number" id="filterNumber" x-model="arf.filterNumber" value="4">
                        </div>
                    </div>
                    
                    <table>
                        <thead>
                            <tr>
                                <th>Diameter (m) / Length (m)</th>
                                <th>1.7</th>
                                <th>3.4</th>
                                <th>5.1</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>2.0</td>
                                <td><input type="radio" name="filterSize" value="2.0_1.7" x-model="arf.selectedSize" @change="calculateARF()"></td>
                                <td><input type="radio" name="filterSize" value="2.0_3.4" x-model="arf.selectedSize" @change="calculateARF()"></td>
                                <td><input type="radio" name="filterSize" value="2.0_5.1" x-model="arf.selectedSize" @change="calculateARF()"></td>
                            </tr>
                            <tr>
                                <td>2.5</td>
                                <td><input type="radio" name="filterSize" value="2.5_1.7" x-model="arf.selectedSize" @change="calculateARF()"></td>
                                <td><input type="radio" name="filterSize" value="2.5_3.4" x-model="arf.selectedSize" @change="calculateARF()"></td>
                                <td><input type="radio" name="filterSize" value="2.5_5.1" x-model="arf.selectedSize" @change="calculateARF()"></td>
                            </tr>
                            <tr>
                                <td>3.0</td>
                                <td><input type="radio" name="filterSize" value="3.0_1.7" x-model="arf.selectedSize" @change="calculateARF()"></td>
                                <td><input type="radio" name="filterSize" value="3.0_3.4" x-model="arf.selectedSize" @change="calculateARF()"></td>
                                <td><input type="radio" name="filterSize" value="3.0_5.1" x-model="arf.selectedSize" @change="calculateARF()"></td>
                            </tr>
                        </tbody>
                    </table>
                    
                    <div x-show="arf.results" class="results">
                        <h3>ARF Calculation Results</h3>
                        <div class="result-item">
                            <strong>Selected Filter Size:</strong> <span x-text="arf.selectedSize.replace('_', 'm diameter, ').replace('_', 'm length')"></span>
                        </div>
                        <div class="result-item">
                            <strong>Single Filter Area:</strong> <span x-text="arf.results.singleFilterArea.toFixed(4)"></span> m²
                        </div>
                        <div class="result-item">
                            <strong>Total Filter Area:</strong> <span x-text="arf.results.totalFilterArea.toFixed(4)"></span> m²
                        </div>
                        <div class="result-item">
                            <strong>Air Velocity:</strong> <span x-text="arf.results.airVelocity.toFixed(2)"></span> m/s
                            <span x-show="arf.results.airVelocity > 1.05" class="error">(HIGH - Above threshold, increase filter area)</span>
                            <span x-show="arf.results.airVelocity >= 0.9 && arf.results.airVelocity <= 1.05" class="good">(OPTIMAL - Within recommended range)</span>
                            <span x-show="arf.results.airVelocity < 0.9" class="warning">(LOW - Below optimal, could reduce filter area)</span>
                        </div>
                        <div class="advice-section" x-show="arf.results.advice">
                            <h4>Recommendations</h4>
                            <p x-text="arf.results.advice"></p>
                        </div>
                    </div>
                </div>

                <!-- Dust Collector Section -->
                <div x-show="activeSection === 'dust'" class="section">
                    <h2>Dust Collector System</h2>
                    <div class="input-group">
                        <div class="input-field">
                            <label for="arfMotorPower">ARF Motor Power (kW):</label>
                            <input type="number" id="arfMotorPower" x-model="dustCollector.arfMotorPower" step="0.1" value="5.5">
                        </div>
                        <div class="input-field">
                            <label for="dustFanPower">Dust Fan Power (kW):</label>
                            <input type="number" id="dustFanPower" x-model="dustCollector.dustFanPower" step="0.1" value="3.3">
                        </div>
                        <div class="input-field">
                            <label for="dustFanNumber">Number of Dust Fans:</label>
                            <input type="number" id="dustFanNumber" x-model="dustCollector.dustFanNumber" value="2">
                        </div>
                    </div>
                    <div class="input-group">
                        <div class="input-field">
                            <label for="mobileBagNumber">Mobile Dust Bags:</label>
                            <input type="number" id="mobileBagNumber" x-model="dustCollector.mobileBagNumber" value="2">
                        </div>
                        <div class="input-field">
                            <label for="fixedBagNumber">Fixed Dust Bags:</label>
                            <input type="number" id="fixedBagNumber" x-model="dustCollector.fixedBagNumber" value="2">
                        </div>
                        <div class="input-field">
                            <label for="vacuumPower">Vacuum Motor Power (kW):</label>
                            <input type="number" id="vacuumPower" x-model="dustCollector.vacuumPower" step="0.1" value="7.5">
                        </div>
                    </div>
                    <div class="controls">
                        <button @click="calculateDustCollector()">Calculate Dust Collector</button>
                    </div>
                    <div x-show="dustCollector.results" class="results">
                        <h3>Dust Collector Results</h3>
                        <div class="result-item">
                            <strong>Total ARF Motor Power:</strong> <span x-text="dustCollector.results.totalArfPower.toFixed(1)"></span> kW
                        </div>
                        <div class="result-item">
                            <strong>Total Dust Fan Power:</strong> <span x-text="dustCollector.results.totalDustFanPower.toFixed(1)"></span> kW
                        </div>
                        <div class="result-item">
                            <strong>Total System Power:</strong> <span x-text="dustCollector.results.totalSystemPower.toFixed(1)"></span> kW
                        </div>
                        <div class="result-item">
                            <strong>Dust Collection Capacity:</strong> <span x-text="dustCollector.results.dustCapacity.toFixed(0)"></span> kg/h
                        </div>
                        <div class="advice-section">
                            <h4>Dust Collector Configuration</h4>
                            <p>Each ARF unit requires a dedicated motor for rotation and dust dislodging.</p>
                            <p>Two dust fans (3.3 kW each) provide suction for the collection system.</p>
                            <p>System includes 2 mobile dust bags for flexible collection points and 2 fixed dust bags for main collection.</p>
                            <p>Vacuum mechanism with <span x-text="dustCollector.vacuumPower"></span> kW motor provides additional cleaning capability.</p>
                            <p>Duct connections should be designed with smooth bends to minimize pressure drop.</p>
                        </div>
                    </div>
                </div>
                
                <!-- Air Washer Section -->
                <div x-show="activeSection === 'airwash'" class="section">
                    <h2>Air Washer System</h2>
                    <div class="input-group">
                        <div class="input-field">
                            <label for="airwashAirflow">Airflow (m³/s):</label>
                            <input type="number" id="airwashAirflow" x-model="airwash.airflow" step="0.1" value="55">
                        </div>
                        <div class="input-field">
                            <label for="zoneWidth">Zone Width (m):</label>
                            <input type="number" id="zoneWidth" x-model="airwash.zoneWidth" step="0.1" value="5.3">
                        </div>
                        <div class="input-field">
                            <label for="zoneHeight">Zone Height (m):</label>
                            <input type="number" id="zoneHeight" x-model="airwash.zoneHeight" step="0.1" value="3.2">
                        </div>
                    </div>
                    <div class="input-group">
                        <div class="input-field">
                            <label for="nozzleSpace">Nozzle Spacing (mm):</label>
                            <input type="number" id="nozzleSpace" x-model="airwash.nozzleSpace" value="76">
                        </div>
                        <div class="input-field">
                            <label for="riserSpace">Riser Spacing (mm):</label>
                            <input type="number" id="riserSpace" x-model="airwash.riserSpace" value="304">
                        </div>
                        <div class="input-field">
                            <label for="collectorDiameter">Collector Diameter (m):</label>
                            <input type="number" id="collectorDiameter" x-model="airwash.collectorDiameter" step="0.01" value="0.1">
                        </div>
                    </div>
                    <div class="input-group">
                        <div class="input-field">
                            <label for="nozzleWaterFlow">Nozzle Water Flow (L/min):</label>
                            <input type="number" id="nozzleWaterFlow" x-model="airwash.nozzleWaterFlow" step="0.1" value="2.5">
                        </div>
                        <div class="input-field">
                            <label for="pumpHead">Pump Head (m):</label>
                            <input type="number" id="pumpHead" x-model="airwash.pumpHead" step="0.1" value="34">
                        </div>
                        <div class="input-field">
                            <label for="rowNumber">Number of Rows:</label>
                            <input type="number" id="rowNumber" x-model="airwash.rowNumber" value="2">
                        </div>
                    </div>
                    <div class="controls">
                        <button @click="calculateAirWash()">Calculate Air Wash System</button>
                    </div>
                    <div x-show="airwash.results" class="results">
                        <h3>Air Wash System Results</h3>
                        <div class="result-item">
                            <strong>Zone Area:</strong> <span x-text="airwash.results.zoneArea.toFixed(2)"></span> m²
                        </div>
                        <div class="result-item">
                            <strong>Air Velocity:</strong> <span x-text="airwash.results.airVelocity.toFixed(2)"></span> m/s
                            <span x-show="airwash.results.airVelocity > 3.95" class="error">(HIGH - Above maximum threshold)</span>
                            <span x-show="airwash.results.airVelocity >= 3.4 && airwash.results.airVelocity <= 3.95" class="good">(OPTIMAL - Within recommended range)</span>
                            <span x-show="airwash.results.airVelocity < 3.4" class="warning">(LOW - Below optimal range)</span>
                        </div>
                        <div class="result-item">
                            <strong>Riser Length:</strong> <span x-text="airwash.results.riserLength.toFixed(2)"></span> m
                        </div>
                        <div class="result-item">
                            <strong>Nozzles per Riser:</strong> <span x-text="airwash.results.nozzlePerRiser"></span>
                        </div>
                        <div class="result-item">
                            <strong>Risers per Collector:</strong> <span x-text="airwash.results.riserPerCollector"></span>
                        </div>
                        <div class="result-item">
                            <strong>Total Nozzles:</strong> <span x-text="airwash.results.totalNozzles"></span>
                        </div>
                        <div class="result-item">
                            <strong>Total Water Flow:</strong> <span x-text="airwash.results.totalWaterFlow.toFixed(1)"></span> L/min
                        </div>
                        <div class="result-item">
                            <strong>Total Water Flow (m³/h):</strong> <span x-text="airwash.results.totalWaterFlowM3H.toFixed(2)"></span>
                        </div>
                        <div class="result-item">
                            <strong>Pump Power:</strong> <span x-text="airwash.results.pumpPower.toFixed(2)"></span> kW
                        </div>
                        <div class="result-item">
                            <strong>Selected Motor Power:</strong> <span x-text="airwash.results.motorPower"></span> kW
                        </div>
                        <div class="advice-section">
                            <h4>Air Wash System Recommendations</h4>
                            <p>Use galvanized plates for air baffles in Zone 0 to create proper air flow lamination.</p>
                            <p>Install plastic formed sheet eliminators after Zone 2 to trap water droplets and prevent liquid from entering the duct system.</p>
                            <p>Return collected water to the recycle pump for reuse to minimize water consumption.</p>
                            <p>Consider using stainless steel or corrosion-resistant materials for nozzles and risers in high-humidity environments.</p>
                        </div>
                    </div>
                </div>

                <!-- Damper & Coil Section -->
                <div x-show="activeSection === 'damper'" class="section">
                    <h2>Damper & Coil Systems</h2>
                    
                    <!-- Fresh Air & Exhaust Dampers -->
                    <div class="collapsible" :class="{ active: damperCoil.freshExhaustOpen }">
                        <div class="collapsible-header" @click="damperCoil.freshExhaustOpen = !damperCoil.freshExhaustOpen">
                            Fresh Air & Exhaust Dampers
                            <span x-text="damperCoil.freshExhaustOpen ? '−' : '+'"></span>
                        </div>
                        <div class="collapsible-content">
                            <div class="input-group">
                                <div class="input-field">
                                    <label for="freshDamperWidth">Fresh Damper Width (mm):</label>
                                    <input type="number" id="freshDamperWidth" x-model="damperCoil.freshDamper.width" value="1520">
                                </div>
                                <div class="input-field">
                                    <label for="freshDamperHeight">Fresh Damper Height (mm):</label>
                                    <input type="number" id="freshDamperHeight" x-model="damperCoil.freshDamper.height" value="2820">
                                </div>
                                <div class="input-field">
                                    <label for="freshDamperNumber">Number of Dampers:</label>
                                    <input type="number" id="freshDamperNumber" x-model="damperCoil.freshDamper.number" value="2">
                                </div>
                            </div>
                            <div class="controls">
                                <button @click="calculateFreshDamper()">Calculate Fresh Air Dampers</button>
                            </div>
                            <div x-show="damperCoil.freshDamper.results" class="results">
                                <h4>Fresh Air Damper Results</h4>
                                <div class="result-item">
                                    <strong>Single Damper Area:</strong> <span x-text="damperCoil.freshDamper.results.singleArea.toFixed(2)"></span> m²
                                </div>
                                <div class="result-item">
                                    <strong>Total Damper Area:</strong> <span x-text="damperCoil.freshDamper.results.totalArea.toFixed(2)"></span> m²
                                </div>
                                <div class="result-item">
                                    <strong>Air Velocity:</strong> <span x-text="damperCoil.freshDamper.results.velocity.toFixed(2)"></span> m/s
                                    <span x-show="damperCoil.freshDamper.results.velocity > 7.23" class="error">(HIGH - Above maximum threshold)</span>
                                    <span x-show="damperCoil.freshDamper.results.velocity >= 5.5 && damperCoil.freshDamper.results.velocity <= 7.23" class="good">(ACCEPTABLE - Within range)</span>
                                    <span x-show="damperCoil.freshDamper.results.velocity < 5.5" class="warning">(LOW - Below optimal)</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Return Dampers -->
                    <div class="collapsible" :class="{ active: damperCoil.returnDamperOpen }">
                        <div class="collapsible-header" @click="damperCoil.returnDamperOpen = !damperCoil.returnDamperOpen">
                            Return Dampers
                            <span x-text="damperCoil.returnDamperOpen ? '−' : '+'"></span>
                        </div>
                        <div class="collapsible-content">
                            <div class="input-group">
                                <div class="input-field">
                                    <label for="returnDamperWidth">Return Damper Width (mm):</label>
                                    <input type="number" id="returnDamperWidth" x-model="damperCoil.returnDamper.width" value="1200">
                                </div>
                                <div class="input-field">
                                    <label for="returnDamperHeight">Return Damper Height (mm):</label>
                                    <input type="number" id="returnDamperHeight" x-model="damperCoil.returnDamper.height" value="1800">
                                </div>
                                <div class="input-field">
                                    <label for="returnDamperNumber">Number of Dampers:</label>
                                    <input type="number" id="returnDamperNumber" x-model="damperCoil.returnDamper.number" value="2">
                                </div>
                            </div>
                            <div class="controls">
                                <button @click="calculateReturnDamper()">Calculate Return Dampers</button>
                            </div>
                            <div x-show="damperCoil.returnDamper.results" class="results">
                                <h4>Return Damper Results</h4>
                                <div class="result-item">
                                    <strong>Single Damper Area:</strong> <span x-text="damperCoil.returnDamper.results.singleArea.toFixed(2)"></span> m²
                                </div>
                                <div class="result-item">
                                    <strong>Total Damper Area:</strong> <span x-text="damperCoil.returnDamper.results.totalArea.toFixed(2)"></span> m²
                                </div>
                                <div class="result-item">
                                    <strong>Air Velocity:</strong> <span x-text="damperCoil.returnDamper.results.velocity.toFixed(2)"></span> m/s
                                    <span x-show="damperCoil.returnDamper.results.velocity > 6.5" class="error">(HIGH - Above maximum threshold)</span>
                                    <span x-show="damperCoil.returnDamper.results.velocity >= 4.5 && damperCoil.returnDamper.results.velocity <= 6.5" class="good">(ACCEPTABLE - Within range)</span>
                                    <span x-show="damperCoil.returnDamper.results.velocity < 4.5" class="warning">(LOW - Below optimal)</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Heating Coils -->
                    <div class="collapsible" :class="{ active: damperCoil.heatingCoilOpen }">
                        <div class="collapsible-header" @click="damperCoil.heatingCoilOpen = !damperCoil.heatingCoilOpen">
                            Heating Coils
                            <span x-text="damperCoil.heatingCoilOpen ? '−' : '+'"></span>
                        </div>
                        <div class="collapsible-content">
                            <div class="input-group">
                                <div class="input-field">
                                    <label for="coilWidth">Coil Width (m):</label>
                                    <input type="number" id="coilWidth" x-model="damperCoil.heatingCoil.width" step="0.1" value="1.2">
                                </div>
                                <div class="input-field">
                                    <label for="coilHeight">Coil Height (m):</label>
                                    <input type="number" id="coilHeight" x-model="damperCoil.heatingCoil.height" step="0.1" value="1.8">
                                </div>
                                <div class="input-field">
                                    <label for="coilRows">Number of Tube Rows:</label>
                                    <select id="coilRows" x-model="damperCoil.heatingCoil.rows">
                                        <option value="1">1 Row</option>
                                        <option value="2">2 Rows</option>
                                        <option value="3">3 Rows</option>
                                    </select>
                                </div>
                                <div class="input-field">
                                    <label for="coilNumber">Number of Coils:</label>
                                    <input type="number" id="coilNumber" x-model="damperCoil.heatingCoil.number" value="2">
                                </div>
                            </div>
                            <div class="controls">
                                <button @click="calculateHeatingCoil()">Calculate Heating Coils</button>
                            </div>
                            <div x-show="damperCoil.heatingCoil.results" class="results">
                                <h4>Heating Coil Results</h4>
                                <div class="result-item">
                                    <strong>Single Coil Area:</strong> <span x-text="damperCoil.heatingCoil.results.singleArea.toFixed(2)"></span> m²
                                </div>
                                <div class="result-item">
                                    <strong>Total Coil Area:</strong> <span x-text="damperCoil.heatingCoil.results.totalArea.toFixed(2)"></span> m²
                                </div>
                                <div class="result-item">
                                    <strong>Heating Capacity:</strong> <span x-text="damperCoil.heatingCoil.results.capacity.toFixed(0)"></span> kW
                                </div>
                                <div class="result-item">
                                    <strong>Air Velocity through Coils:</strong> <span x-text="damperCoil.heatingCoil.results.velocity.toFixed(2)"></span> m/s
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Fan & Motors Section -->
                <div x-show="activeSection === 'fan'" class="section">
                    <h2>Fan & Motors Selection</h2>
                    <div class="input-group">
                        <div class="input-field">
                            <label for="fanDiameter">Fan Diameter (mm):</label>
                            <select id="fanDiameter" x-model="fans.fanDiameter">
                                <option value="1120">1120 mm</option>
                                <option value="1400">1400 mm</option>
                                <option value="1600">1600 mm</option>
                            </select>
                        </div>
                        <div class="input-field">
                            <label for="bladeAngle">Blade Angle (degrees):</label>
                            <input type="number" id="bladeAngle" x-model="fans.bladeAngle" min="10" max="30" value="20">
                        </div>
                        <div class="input-field">
                            <label for="fanCount">Number of Fans:</label>
                            <input type="number" id="fanCount" x-model="fans.fanCount" value="2">
                        </div>
                    </div>
                    <div class="input-group">
                        <div class="input-field">
                            <label for="motorPower">Motor Power (kW):</label>
                            <select id="motorPower" x-model="fans.motorPower">
                                <option value="18">18 kW</option>
                                <option value="22">22 kW</option>
                                <option value="30">30 kW</option>
                                <option value="37">37 kW</option>
                                <option value="45">45 kW</option>
                            </select>
                        </div>
                        <div class="input-field">
                            <label for="rpm">Motor RPM:</label>
                            <input type="number" id="rpm" x-model="fans.rpm" value="1000">
                        </div>
                        <div class="input-field">
                            <label for="phase">Electrical Phase:</label>
                            <select id="phase" x-model="fans.phase">
                                <option value="3">3 Phase</option>
                            </select>
                        </div>
                    </div>
                    <div class="controls">
                        <button @click="calculateFans()">Calculate Fan System</button>
                    </div>
                    <div x-show="fans.results" class="results">
                        <h3>Fan & Motor Results</h3>
                        <div class="result-item">
                            <strong>Fan Type:</strong> Luwa Aluminum Fan
                        </div>
                        <div class="result-item">
                            <strong>Fan Diameter:</strong> <span x-text="fans.fanDiameter"></span> mm
                        </div>
                        <div class="result-item">
                            <strong>Number of Blades:</strong> 10
                        </div>
                        <div class="result-item">
                            <strong>Blade Angle:</strong> <span x-text="fans.bladeAngle"></span>°
                        </div>
                        <div class="result-item">
                            <strong>Total Airflow Capacity:</strong> <span x-text="fans.results.totalAirflow.toFixed(0)"></span> m³/h
                        </div>
                        <div class="result-item">
                            <strong>Total Motor Power:</strong> <span x-text="fans.results.totalPower.toFixed(0)"></span> kW
                        </div>
                        <div class="result-item">
                            <strong>Static Pressure:</strong> <span x-text="fans.results.staticPressure.toFixed(0)"></span> Pa
                        </div>
                        <div class="advice-section">
                            <h4>Fan Selection Recommendations</h4>
                            <p>Luwa aluminum fans provide excellent corrosion resistance and durability.</p>
                            <p>10-blade design with adjustable angles (10-30°) allows for performance optimization.</p>
                            <p>Consider VFD (Variable Frequency Drive) for energy savings and soft starting.</p>
                            <p>Ensure proper fan housing and duct connections to minimize turbulence and noise.</p>
                        </div>
                    </div>
                </div>

                <!-- MTO Section -->
                <div x-show="activeSection === 'mto'" class="section">
                    <h2>Material Take-Off (MTO)</h2>
                    <div class="controls">
                        <button @click="calculateMTO()">Generate MTO</button>
                    </div>
                    <div x-show="mto.results" class="results">
                        <h3>Material Take-Off Summary</h3>
                        <table class="cost-table">
                            <thead>
                                <tr>
                                    <th>Component</th>
                                    <th>Quantity</th>
                                    <th>Unit</th>
                                    <th>Description</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>ARF Units</td>
                                    <td x-text="arf.filterNumber"></td>
                                    <td>pcs</td>
                                    <td>Air Rotary Filters with motors</td>
                                </tr>
                                <tr>
                                    <td>Dust Fans</td>
                                    <td x-text="dustCollector.dustFanNumber"></td>
                                    <td>pcs</td>
                                    <td>3.3 kW dust collection fans</td>
                                </tr>
                                <tr>
                                    <td>Dust Bags (Mobile)</td>
                                    <td x-text="dustCollector.mobileBagNumber"></td>
                                    <td>pcs</td>
                                    <td>Mobile dust collection bags</td>
                                </tr>
                                <tr>
                                    <td>Dust Bags (Fixed)</td>
                                    <td x-text="dustCollector.fixedBagNumber"></td>
                                    <td>pcs</td>
                                    <td>Fixed dust collection bags</td>
                                </tr>
                                <tr>
                                    <td>Supply Ducts</td>
                                    <td x-text="ductVent.supplyDuct.number"></td>
                                    <td>pcs</td>
                                    <td x-text="'Supply ducts (' + ductVent.supplyDuct.shape + ')'"></td>
                                </tr>
                                <tr>
                                    <td>Return Ducts</td>
                                    <td x-text="ductVent.returnDuct.number"></td>
                                    <td>pcs</td>
                                    <td>Return air ducts</td>
                                </tr>
                                <tr>
                                    <td>Air Wash Nozzles</td>
                                    <td x-text="airwash.results ? airwash.results.totalNozzles : 0"></td>
                                    <td>pcs</td>
                                    <td>Water spray nozzles</td>
                                </tr>
                                <tr>
                                    <td>Fans</td>
                                    <td x-text="fans.fanCount"></td>
                                    <td>pcs</td>
                                    <td x-text="'Luwa fans - ' + fans.fanDiameter + 'mm'"></td>
                                </tr>
                                <tr>
                                    <td>Dampers</td>
                                    <td x-text="(damperCoil.freshDamper.number + damperCoil.returnDamper.number)"></td>
                                    <td>pcs</td>
                                    <td>Fresh air and return dampers</td>
                                </tr>
                                <tr>
                                    <td>Heating Coils</td>
                                    <td x-text="damperCoil.heatingCoil.number"></td>
                                    <td>pcs</td>
                                    <td x-text="'Heating coils - ' + damperCoil.heatingCoil.rows + ' rows'"></td>
                                </tr>
                                <tr>
                                    <td>Pumps</td>
                                    <td>2</td>
                                    <td>pcs</td>
                                    <td>Circulation and booster pumps</td>
                                </tr>
                                <tr>
                                    <td>Motors</td>
                                    <td x-text="mto.results.totalMotors"></td>
                                    <td>pcs</td>
                                    <td>Various power ratings</td>
                                </tr>
                                <tr>
                                    <td>Ducting</td>
                                    <td x-text="mto.results.ductLength"></td>
                                    <td>m</td>
                                    <td>Galvanized steel ducting</td>
                                </tr>
                                <tr>
                                    <td>Insulation</td>
                                    <td x-text="mto.results.insulationArea"></td>
                                    <td>m²</td>
                                    <td>Fiberglass insulation</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Cost Estimation Section -->
                <div x-show="activeSection === 'cost'" class="section">
                    <h2>Cost Estimation</h2>
                    <div class="controls">
                        <button @click="calculateCost()">Calculate Total Cost</button>
                    </div>
                    <div x-show="costEstimation.results" class="results">
                        <h3>Cost Estimation Summary</h3>
                        <table class="cost-table">
                            <thead>
                                <tr>
                                    <th>Component</th>
                                    <th>Quantity</th>
                                    <th>Unit Cost ($)</th>
                                    <th>Total Cost ($)</th>
                                </tr>
                            </thead>
                            <tbody>
                                <template x-for="(item, index) in costEstimation.results.items" :key="index">
                                    <tr>
                                        <td x-text="item.name"></td>
                                        <td x-text="item.quantity"></td>
                                        <td x-text="item.unitCost.toFixed(2)"></td>
                                        <td x-text="item.totalCost.toFixed(2)"></td>
                                    </tr>
                                </template>
                            </tbody>
                        </table>
                        <div class="total-cost">
                            Total Estimated Cost: $<span x-text="costEstimation.results.totalCost.toFixed(2)"></span>
                        </div>
                        <div class="advice-section">
                            <h4>Cost Optimization Suggestions</h4>
                            <p>Consider local suppliers for ductwork and structural components to reduce shipping costs.</p>
                            <p>Evaluate energy-efficient motors for long-term operational savings.</p>
                            <p>Standardize components where possible to benefit from bulk pricing.</p>
                            <p>Plan for 15-20% contingency for unexpected expenses during installation.</p>
                        </div>
                    </div>
                </div>

                <!-- BOM Section -->
                <div x-show="activeSection === 'bom'" class="section">
                    <h2>Bill of Materials (BOM)</h2>
                    <div class="controls">
                        <button @click="generateBOM()">Generate BOM</button>
                    </div>
                    <div x-show="bom.results" class="results">
                        <h3>Bill of Materials</h3>
                        <ul class="component-list">
                            <template x-for="(item, index) in bom.results.items" :key="index">
                                <li>
                                    <strong x-text="item.name"></strong>: 
                                    <span x-text="item.quantity"></span> <span x-text="item.unit"></span>
                                    - <span x-text="item.description"></span>
                                </li>
                            </template>
                        </ul>
                    </div>
                </div>
                
                <!-- JSON Data Section -->
                <div x-show="activeSection === 'report'" class="section">
                    <h2>JSON Data</h2>
                    <textarea class="json-area" x-model="jsonData" placeholder="JSON data will appear here..."></textarea>
                    <div class="controls">
                        <button @click="saveToJSON()" class="btn-success">Save to JSON</button>
                        <button @click="loadFromJSON()" class="btn-warning">Load from JSON</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        function hvacCalculator() {
            return {
                activeSection: 'problem',
                projectData: {
                    name: '',
                    location: '',
                    description: '',
                    designer: '',
                    date: new Date().toISOString().split('T')[0]
                },
                building: {
                    length: 50,
                    width: 30,
                    height: 5,
                    wallArea: 800,
                    roofArea: 1500,
                    wallMaterial: 'brick',
                    roofMaterial: 'concrete'
                },
                loadEstimation: {
                    sunlightPower: 800,
                    machinePower: 150,
                    hottestTemp: 45,
                    hottestHumidity: 70,
                    coldestTemp: -5,
                    coldestHumidity: 30,
                    insideTemp: 22,
                    insideHumidity: 50,
                    results: null
                },
                acStation: {
                    type: 'split',
                    capacity: 200,
                    coolingTower: 50,
                    chiller: 60,
                    description: ''
                },
                airflow: {
                    spaces: [
                        {
                            name: 'Main Hall',
                            width: 21,
                            length: 44,
                            height: 4.4,
                            ach: 33,
                            results: null
                        }
                    ]
                },
                ductVent: {
                    supplyDuctOpen: true,
                    returnDuctOpen: false,
                    supplyDuct: {
                        shape: 'circular',
                        diameter: 1.2,
                        width: 1.8,
                        height: 1.2,
                        number: 4,
                        ventWidth: 0.5,
                        ventLength: 1.2,
                        ventNumber: 8,
                        results: null
                    },
                    returnDuct: {
                        width: 1.5,
                        height: 1.0,
                        number: 2,
                        ventWidth: 0.05,
                        ventLength: 1.5,
                        ventNumber: 4,
                        results: null
                    }
                },
                arf: {
                    filterNumber: 4,
                    selectedSize: '2.5_3.4',
                    results: null
                },
                dustCollector: {
                    arfMotorPower: 5.5,
                    dustFanPower: 3.3,
                    dustFanNumber: 2,
                    mobileBagNumber: 2,
                    fixedBagNumber: 2,
                    vacuumPower: 7.5,
                    results: null
                },
                airwash: {
                    airflow: 55,
                    zoneWidth: 5.3,
                    zoneHeight: 3.2,
                    nozzleSpace: 76,
                    riserSpace: 304,
                    collectorDiameter: 0.1,
                    nozzleWaterFlow: 2.5,
                    pumpHead: 34,
                    rowNumber: 2,
                    results: null
                },
                damperCoil: {
                    freshExhaustOpen: true,
                    returnDamperOpen: false,
                    heatingCoilOpen: false,
                    freshDamper: {
                        width: 1520,
                        height: 2820,
                        number: 2,
                        results: null
                    },
                    returnDamper: {
                        width: 1200,
                        height: 1800,
                        number: 2,
                        results: null
                    },
                    heatingCoil: {
                        width: 1.2,
                        height: 1.8,
                        rows: 2,
                        number: 2,
                        results: null
                    }
                },
                fans: {
                    fanDiameter: 1400,
                    bladeAngle: 20,
                    fanCount: 2,
                    motorPower: 22,
                    rpm: 1000,
                    phase: 3,
                    results: null
                },
                mto: {
                    results: null
                },
                costEstimation: {
                    results: null
                },
                bom: {
                    results: null
                },
                jsonData: '',
                
                // Methods
                addSpace() {
                    this.airflow.spaces.push({
                        name: `Space ${this.airflow.spaces.length + 1}`,
                        width: 21,
                        length: 44,
                        height: 4.4,
                        ach: 33,
                        results: null
                    });
                },
                
                removeSpace(index) {
                    this.airflow.spaces.splice(index, 1);
                },
                
                calculateSpace(index) {
                    const space = this.airflow.spaces[index];
                    const area = space.width * space.length;
                    const volume = area * space.height;
                    const airflowM3Hr = volume * space.ach;
                    const airflowM3S = airflowM3Hr / 3600;
                    const airflowCFM = airflowM3Hr / 1.699;
                    
                    space.results = {
                        area: area,
                        volume: volume,
                        airflowM3Hr: airflowM3Hr,
                        airflowM3S: airflowM3S,
                        airflowCFM: airflowCFM
                    };
                },
                
                calculateSupplyDuct() {
                    const duct = this.ductVent.supplyDuct;
                    let ductArea;
                    
                    if (duct.shape === 'circular') {
                        ductArea = Math.PI * Math.pow(duct.diameter / 2, 2);
                    } else {
                        ductArea = duct.width * duct.height;
                    }
                    
                    const totalDuctArea = ductArea * duct.number;
                    
                    // Get airflow from first space or use default
                    const airflow = this.airflow.spaces.length > 0 && this.airflow.spaces[0].results 
                        ? this.airflow.spaces[0].results.airflowM3S 
                        : 10;
                    
                    const ductVelocity = airflow / totalDuctArea;
                    
                    // Check velocity limits
                    let ductVelocityStatus;
                    if (ductVelocity > 8) ductVelocityStatus = 'HIGH';
                    else if (ductVelocity < 3) ductVelocityStatus = 'LOW';
                    else ductVelocityStatus = 'OK';
                    
                    // Vent calculations
                    const ventArea = duct.ventWidth * duct.ventLength;
                    const totalVentArea = ventArea * duct.ventNumber;
                    const ventVelocity = airflow / totalVentArea;
                    
                    // Check vent velocity limits
                    let ventVelocityStatus;
                    if (ventVelocity > 4) ventVelocityStatus = 'HIGH';
                    else if (ventVelocity < 1) ventVelocityStatus = 'LOW';
                    else ventVelocityStatus = 'OK';
                    
                    duct.results = {
                        ductArea: ductArea,
                        totalDuctArea: totalDuctArea,
                        ductVelocity: ductVelocity,
                        ductVelocityStatus: ductVelocityStatus,
                        ventArea: ventArea,
                        totalVentArea: totalVentArea,
                        ventVelocity: ventVelocity,
                        ventVelocityStatus: ventVelocityStatus
                    };
                },
                
                calculateReturnDuct() {
                    const duct = this.ductVent.returnDuct;
                    const ductArea = duct.width * duct.height;
                    const totalDuctArea = ductArea * duct.number;
                    
                    // Get airflow from first space or use default
                    const airflow = this.airflow.spaces.length > 0 && this.airflow.spaces[0].results 
                        ? this.airflow.spaces[0].results.airflowM3S 
                        : 10;
                    
                    const ductVelocity = airflow / totalDuctArea;
                    
                    // Check velocity limits
                    let ductVelocityStatus;
                    if (ductVelocity > 6) ductVelocityStatus = 'HIGH';
                    else if (ductVelocity < 2) ductVelocityStatus = 'LOW';
                    else ductVelocityStatus = 'OK';
                    
                    // Vent calculations
                    const ventArea = duct.ventWidth * duct.ventLength;
                    const totalVentArea = ventArea * duct.ventNumber;
                    const ventVelocity = airflow / totalVentArea;
                    
                    // Check vent velocity limits
                    let ventVelocityStatus;
                    if (ventVelocity > 3) ventVelocityStatus = 'HIGH';
                    else if (ventVelocity < 0.5) ventVelocityStatus = 'LOW';
                    else ventVelocityStatus = 'OK';
                    
                    duct.results = {
                        ductArea: ductArea,
                        totalDuctArea: totalDuctArea,
                        ductVelocity: ductVelocity,
                        ductVelocityStatus: ductVelocityStatus,
                        ventArea: ventArea,
                        totalVentArea: totalVentArea,
                        ventVelocity: ventVelocity,
                        ventVelocityStatus: ventVelocityStatus
                    };
                },
                
                calculateARF() {
                    if (!this.arf.selectedSize) return;
                    
                    const [diameter, length] = this.arf.selectedSize.split('_').map(Number);
                    const singleFilterArea = Math.PI * Math.pow(diameter / 2, 2);
                    const totalFilterArea = singleFilterArea * this.arf.filterNumber;
                    
                    // Get airflow from first space or use default
                    const airflow = this.airflow.spaces.length > 0 && this.airflow.spaces[0].results 
                        ? this.airflow.spaces[0].results.airflowM3S 
                        : 10;
                    
                    const airVelocity = airflow / totalFilterArea;
                    
                    let advice = '';
                    if (airVelocity > 1.05) {
                        advice = 'Air velocity is above the recommended threshold. Consider increasing the filter area by adding more filters or selecting larger filters.';
                    } else if (airVelocity >= 0.9 && airVelocity <= 1.05) {
                        advice = 'Air velocity is within the optimal range for minimal pressure drop.';
                    } else {
                        advice = 'Air velocity is below the optimal range. You could reduce the filter area to save costs while maintaining acceptable performance.';
                    }
                    
                    this.arf.results = {
                        singleFilterArea: singleFilterArea,
                        totalFilterArea: totalFilterArea,
                        airVelocity: airVelocity,
                        advice: advice
                    };
                },

                calculateDustCollector() {
                    const dc = this.dustCollector;
                    
                    const totalArfPower = this.arf.filterNumber * dc.arfMotorPower;
                    const totalDustFanPower = dc.dustFanNumber * dc.dustFanPower;
                    const totalSystemPower = totalArfPower + totalDustFanPower + dc.vacuumPower;
                    
                    // Estimate dust collection capacity based on system parameters
                    const dustCapacity = totalSystemPower * 15; // kg/h
                    
                    this.dustCollector.results = {
                        totalArfPower: totalArfPower,
                        totalDustFanPower: totalDustFanPower,
                        totalSystemPower: totalSystemPower,
                        dustCapacity: dustCapacity
                    };
                },
                
                calculateAirWash() {
                    const aw = this.airwash;
                    const zoneArea = aw.zoneWidth * aw.zoneHeight;
                    const airVelocity = aw.airflow / zoneArea;
                    
                    const riserLength = aw.zoneHeight - aw.collectorDiameter;
                    const nozzlePerRiser = Math.floor(riserLength / (aw.nozzleSpace / 1000));
                    const riserPerCollector = Math.floor(aw.zoneWidth / (aw.riserSpace / 1000)) - 1;
                    const totalNozzles = aw.rowNumber * riserPerCollector * nozzlePerRiser;
                    
                    const totalWaterFlow = totalNozzles * aw.nozzleWaterFlow;
                    const totalWaterFlowM3H = totalWaterFlow * 0.06;
                    
                    // Pump power calculation
                    const pumpPower = (totalWaterFlowM3H * aw.pumpHead * 1000 * 9.81) / (3600 * 0.75 * 1000);
                    
                    // Standard motor sizes
                    const standardSizes = [0.37, 0.55, 0.75, 1.1, 1.5, 2.2, 3.0, 4.0, 5.5, 7.5, 11, 15, 18.5, 22, 30, 37, 45, 55, 75, 90, 110];
                    const requiredPower = pumpPower * 1.2; // 20% safety factor
                    let motorPower = standardSizes[standardSizes.length - 1];
                    
                    for (let size of standardSizes) {
                        if (size >= requiredPower) {
                            motorPower = size;
                            break;
                        }
                    }
                    
                    this.airwash.results = {
                        zoneArea: zoneArea,
                        airVelocity: airVelocity,
                        riserLength: riserLength,
                        nozzlePerRiser: nozzlePerRiser,
                        riserPerCollector: riserPerCollector,
                        totalNozzles: totalNozzles,
                        totalWaterFlow: totalWaterFlow,
                        totalWaterFlowM3H: totalWaterFlowM3H,
                        pumpPower: pumpPower,
                        motorPower: motorPower
                    };
                },

                calculateFreshDamper() {
                    const damper = this.damperCoil.freshDamper;
                    const singleArea = (damper.width / 1000) * (damper.height / 1000);
                    const totalArea = singleArea * damper.number;
                    
                    // Get airflow from first space or use default
                    const airflow = this.airflow.spaces.length > 0 && this.airflow.spaces[0].results 
                        ? this.airflow.spaces[0].results.airflowM3S 
                        : 10;
                    
                    const velocity = airflow / totalArea;
                    
                    damper.results = {
                        singleArea: singleArea,
                        totalArea: totalArea,
                        velocity: velocity
                    };
                },

                calculateReturnDamper() {
                    const damper = this.damperCoil.returnDamper;
                    const singleArea = (damper.width / 1000) * (damper.height / 1000);
                    const totalArea = singleArea * damper.number;
                    
                    // Get airflow from first space or use default
                    const airflow = this.airflow.spaces.length > 0 && this.airflow.spaces[0].results 
                        ? this.airflow.spaces[0].results.airflowM3S 
                        : 10;
                    
                    const velocity = airflow / totalArea;
                    
                    damper.results = {
                        singleArea: singleArea,
                        totalArea: totalArea,
                        velocity: velocity
                    };
                },

                calculateHeatingCoil() {
                    const coil = this.damperCoil.heatingCoil;
                    const singleArea = coil.width * coil.height;
                    const totalArea = singleArea * coil.number;
                    
                    // Get airflow from first space or use default
                    const airflow = this.airflow.spaces.length > 0 && this.airflow.spaces[0].results 
                        ? this.airflow.spaces[0].results.airflowM3S 
                        : 10;
                    
                    const velocity = airflow / totalArea;
                    
                    // Estimate heating capacity based on coil area and rows
                    const capacity = totalArea * coil.rows * 2.5; // kW
                    
                    coil.results = {
                        singleArea: singleArea,
                        totalArea: totalArea,
                        velocity: velocity,
                        capacity: capacity
                    };
                },

                calculateFans() {
                    const f = this.fans;
                    
                    // Calculate airflow capacity based on fan diameter
                    let airflowPerFan;
                    if (f.fanDiameter == 1120) airflowPerFan = 15000;
                    else if (f.fanDiameter == 1400) airflowPerFan = 25000;
                    else airflowPerFan = 35000; // 1600mm
                    
                    const totalAirflow = airflowPerFan * f.fanCount;
                    const totalPower = f.motorPower * f.fanCount;
                    
                    // Estimate static pressure based on system
                    const staticPressure = 500 + (f.bladeAngle - 10) * 25;
                    
                    this.fans.results = {
                        totalAirflow: totalAirflow,
                        totalPower: totalPower,
                        staticPressure: staticPressure
                    };
                },

                calculateMTO() {
                    // Calculate duct length based on building dimensions
                    const ductLength = (this.building.length + this.building.width) * 2 * 1.5;
                    const insulationArea = ductLength * 3.14 * 1.2; // Approximate
                    
                    this.mto.results = {
                        totalMotors: this.arf.filterNumber + this.dustCollector.dustFanNumber + 2, // +2 for pumps
                        ductLength: Math.round(ductLength),
                        insulationArea: Math.round(insulationArea)
                    };
                },

                calculateCost() {
                    const items = [
                        { name: 'ARF Units', quantity: this.arf.filterNumber, unitCost: 8500, totalCost: 0 },
                        { name: 'Dust Fans', quantity: this.dustCollector.dustFanNumber, unitCost: 3200, totalCost: 0 },
                        { name: 'Dust Bags', quantity: this.dustCollector.mobileBagNumber + this.dustCollector.fixedBagNumber, unitCost: 1200, totalCost: 0 },
                        { name: 'Supply Ducts', quantity: this.ductVent.supplyDuct.number, unitCost: 2800, totalCost: 0 },
                        { name: 'Return Ducts', quantity: this.ductVent.returnDuct.number, unitCost: 2200, totalCost: 0 },
                        { name: 'Air Wash System', quantity: 1, unitCost: 45000, totalCost: 0 },
                        { name: 'Fans & Motors', quantity: this.fans.fanCount, unitCost: this.fans.motorPower * 350, totalCost: 0 },
                        { name: 'Dampers', quantity: this.damperCoil.freshDamper.number + this.damperCoil.returnDamper.number, unitCost: 1800, totalCost: 0 },
                        { name: 'Heating Coils', quantity: this.damperCoil.heatingCoil.number, unitCost: 4200, totalCost: 0 },
                        { name: 'Pumps', quantity: 2, unitCost: 5500, totalCost: 0 },
                        { name: 'Ducting Material', quantity: 150, unitCost: 85, totalCost: 0 },
                        { name: 'Insulation', quantity: 200, unitCost: 45, totalCost: 0 },
                        { name: 'Controls & Instrumentation', quantity: 1, unitCost: 15000, totalCost: 0 },
                        { name: 'Installation Labor', quantity: 1, unitCost: 35000, totalCost: 0 }
                    ];
                    
                    // Calculate total costs
                    let totalCost = 0;
                    items.forEach(item => {
                        item.totalCost = item.quantity * item.unitCost;
                        totalCost += item.totalCost;
                    });
                    
                    this.costEstimation.results = {
                        items: items,
                        totalCost: totalCost
                    };
                },

                generateBOM() {
                    const items = [
                        { name: 'ARF Filter Unit', quantity: this.arf.filterNumber, unit: 'pcs', description: 'Air Rotary Filter with motor drive' },
                        { name: 'Dust Collection Fan', quantity: this.dustCollector.dustFanNumber, unit: 'pcs', description: '3.3 kW centrifugal fan' },
                        { name: 'Mobile Dust Bag', quantity: this.dustCollector.mobileBagNumber, unit: 'pcs', description: 'Portable dust collection bag' },
                        { name: 'Fixed Dust Bag', quantity: this.dustCollector.fixedBagNumber, unit: 'pcs', description: 'Stationary dust collection bag' },
                        { name: 'Vacuum Motor', quantity: 1, unit: 'pcs', description: this.dustCollector.vacuumPower + ' kW vacuum system' },
                        { name: 'Supply Air Duct', quantity: this.ductVent.supplyDuct.number, unit: 'pcs', description: this.ductVent.supplyDuct.shape + ' supply duct' },
                        { name: 'Return Air Duct', quantity: this.ductVent.returnDuct.number, unit: 'pcs', description: 'Return air duct' },
                        { name: 'Air Wash Nozzle', quantity: this.airwash.results ? this.airwash.results.totalNozzles : 0, unit: 'pcs', description: 'Water spray nozzle' },
                        { name: 'Luwa Aluminum Fan', quantity: this.fans.fanCount, unit: 'pcs', description: this.fans.fanDiameter + 'mm diameter, 10 blades' },
                        { name: 'Fan Motor', quantity: this.fans.fanCount, unit: 'pcs', description: this.fans.motorPower + ' kW, ' + this.fans.rpm + ' RPM' },
                        { name: 'Fresh Air Damper', quantity: this.damperCoil.freshDamper.number, unit: 'pcs', description: 'Fresh air intake damper' },
                        { name: 'Return Air Damper', quantity: this.damperCoil.returnDamper.number, unit: 'pcs', description: 'Return air damper' },
                        { name: 'Heating Coil', quantity: this.damperCoil.heatingCoil.number, unit: 'pcs', description: this.damperCoil.heatingCoil.rows + ' row heating coil' },
                        { name: 'Circulation Pump', quantity: 1, unit: 'pcs', description: 'Water circulation pump' },
                        { name: 'Booster Pump', quantity: 1, unit: 'pcs', description: 'System booster pump' },
                        { name: 'Control Panel', quantity: 1, unit: 'pcs', description: 'Main system control panel' },
                        { name: 'Ducting', quantity: 150, unit: 'm', description: 'Galvanized steel ducting' },
                        { name: 'Insulation', quantity: 200, unit: 'm²', description: 'Fiberglass insulation' },
                        { name: 'Mounting Hardware', quantity: 1, unit: 'kit', description: 'Assembly hardware and fasteners' }
                    ];
                    
                    this.bom.results = {
                        items: items
                    };
                },
                
                calculateLoadEstimation() {
                    const le = this.loadEstimation;
                    const b = this.building;
                    
                    const sunlightHeating = (b.roofArea * le.sunlightPower) / 1000;
                    const totalAddedHeat = sunlightHeating + le.machinePower;
                    
                    // Simplified heat conduction calculation
                    // In a real application, you would use more detailed formulas
                    const wallHeatConduction = b.wallArea * (le.hottestTemp - le.insideTemp) * 0.5;
                    const roofHeatConduction = b.roofArea * (le.hottestTemp - le.insideTemp) * 0.8;
                    
                    const totalHeatLoad = totalAddedHeat + wallHeatConduction + roofHeatConduction;
                    
                    le.results = {
                        sunlightHeating: sunlightHeating,
                        totalAddedHeat: totalAddedHeat,
                        wallHeatConduction: wallHeatConduction,
                        roofHeatConduction: roofHeatConduction,
                        totalHeatLoad: totalHeatLoad
                    };
                },
                
                saveToJSON() {
                    const data = {
                        projectData: this.projectData,
                        building: this.building,
                        loadEstimation: this.loadEstimation,
                        acStation: this.acStation,
                        airflow: this.airflow,
                        ductVent: this.ductVent,
                        arf: this.arf,
                        dustCollector: this.dustCollector,
                        airwash: this.airwash,
                        damperCoil: this.damperCoil,
                        fans: this.fans,
                        mto: this.mto,
                        costEstimation: this.costEstimation,
                        bom: this.bom,
                        timestamp: new Date().toISOString()
                    };
                    
                    this.jsonData = JSON.stringify(data, null, 2);
                    
                    // Download as file
                    const blob = new Blob([this.jsonData], { type: 'application/json' });
                    const url = URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = `hvac_calculation_${new Date().toISOString().split('T')[0]}.json`;
                    a.click();
                    URL.revokeObjectURL(url);
                },
                
                loadFromJSON() {
                    if (!this.jsonData.trim()) {
                        alert('Please paste JSON data in the textarea first.');
                        return;
                    }
                    
                    try {
                        const data = JSON.parse(this.jsonData);
                        
                        // Update all data models
                        Object.keys(data).forEach(key => {
                            if (this[key] !== undefined) {
                                this[key] = data[key];
                            }
                        });
                        
                        alert('Data loaded successfully!');
                    } catch (error) {
                        alert('Invalid JSON format: ' + error.message);
                    }
                }
            };
        }
    </script>
</body>
</html>