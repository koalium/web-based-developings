<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>سیستم طراحی تهویه نساجی و PLC | نسخه حرفه‌ای</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: {
                            50: '#eff6ff',
                            100: '#dbeafe',
                            200: '#bfdbfe',
                            300: '#93c5fd',
                            400: '#60a5fa',
                            500: '#3b82f6',
                            600: '#2563eb',
                            700: '#1d4ed8',
                            800: '#1e40af',
                            900: '#1e3a8a',
                        },
                        secondary: {
                            50: '#f8fafc',
                            100: '#f1f5f9',
                            200: '#e2e8f0',
                            300: '#cbd5e1',
                            400: '#94a3b8',
                            500: '#64748b',
                            600: '#475569',
                            700: '#334155',
                            800: '#1e293b',
                            900: '#0f172a',
                        },
                        textile: {
                            blue: '#1e3a8a',
                            green: '#10b981',
                            orange: '#f59e0b',
                            red: '#ef4444',
                            purple: '#8b5cf6'
                        }
                    },
                    fontFamily: {
                        'vazir': ['Vazirmatn', 'sans-serif'],
                        'iran-sans': ['IRANSans', 'sans-serif']
                    }
                }
            }
        }
    </script>
    
    <!-- Alpine.js -->
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Persian Font -->
    <link href="https://cdn.jsdelivr.net/gh/rastikerdar/vazirmatn@v33.003/Vazirmatn-font-face.css" rel="stylesheet" type="text/css" />
    
    <style>
        :root {
            --color-primary: #1e3a8a;
            --color-secondary: #64748b;
            --color-accent: #10b981;
        }
        
        * {
            font-family: 'Vazirmatn', sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
            min-height: 100vh;
        }
        
        .rtl {
            direction: rtl;
            text-align: right;
        }
        
        .persian-number {
            font-feature-settings: "ss01";
        }
        
        .glass-effect {
            background: rgba(255, 255, 255, 0.85);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .scrollbar-thin {
            scrollbar-width: thin;
            scrollbar-color: #cbd5e1 transparent;
        }
        
        .scrollbar-thin::-webkit-scrollbar {
            width: 6px;
        }
        
        .scrollbar-thin::-webkit-scrollbar-track {
            background: transparent;
        }
        
        .scrollbar-thin::-webkit-scrollbar-thumb {
            background-color: #cbd5e1;
            border-radius: 20px;
        }
        
        .gradient-bg {
            background: linear-gradient(120deg, #a5b4fc 0%, #c4b5fd 100%);
        }
        
        .text-shadow {
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        
        .neumorphism {
            border-radius: 20px;
            background: #f0f0f0;
            box-shadow:  10px 10px 20px #d9d9d9, -10px -10px 20px #ffffff;
        }
        
        .icon-3d {
            transform-style: preserve-3d;
            perspective: 1000px;
        }
        
        .animate-float {
            animation: float 6s ease-in-out infinite;
        }
        
        @keyframes float {
            0% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
            100% { transform: translateY(0px); }
        }
        
        .animate-pulse-slow {
            animation: pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }
        
        .grid-stack {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 1.5rem;
        }
        
        .component-3d {
            transform: translateZ(20px);
            transition: all 0.3s ease;
        }
        
        .component-3d:hover {
            transform: translateZ(30px) rotateX(5deg);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
        }
        
        .motor-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        
        .sensor-card {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
        }
        
        .control-card {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
        }
        
        .hvac-card {
            background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
            color: white;
        }
        
        .bom-card {
            background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
            color: white;
        }
        
        .dashboard-card {
            transition: all 0.3s ease;
            border-left: 4px solid;
        }
        
        .dashboard-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }
        
        .input-3d {
            background: rgba(255, 255, 255, 0.9);
            border: 1px solid rgba(0, 0, 0, 0.1);
            box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.05), 0 1px 0 rgba(255, 255, 255, 0.8);
        }
        
        .tab-active {
            border-bottom: 3px solid #3b82f6;
            color: #3b82f6;
            font-weight: 600;
        }
        
        .tab-inactive {
            color: #64748b;
            transition: all 0.2s ease;
        }
        
        .tab-inactive:hover {
            color: #3b82f6;
            border-bottom: 3px solid #93c5fd;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            transition: all 0.3s ease;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(102, 126, 234, 0.4);
        }
        
        .btn-secondary {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            transition: all 0.3s ease;
        }
        
        .btn-secondary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(245, 87, 108, 0.4);
        }
        
        .btn-success {
            background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
            color: white;
            transition: all 0.3s ease;
        }
        
        .btn-success:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(67, 233, 123, 0.4);
        }
        
        .btn-warning {
            background: linear-gradient(135deg, #ff9a9e 0%, #fad0c4 100%);
            color: #333;
            transition: all 0.3s ease;
        }
        
        .btn-warning:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(255, 154, 158, 0.4);
        }
        
        .btn-danger {
            background: linear-gradient(135deg, #ff5858 0%, #f09819 100%);
            color: white;
            transition: all 0.3s ease;
        }
        
        .btn-danger:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(255, 88, 88, 0.4);
        }
        
        .modal-overlay {
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(5px);
        }
        
        .modal-content {
            animation: modalAppear 0.3s ease-out;
        }
        
        @keyframes modalAppear {
            from {
                opacity: 0;
                transform: translateY(-20px) scale(0.95);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }
        
        .chart-container {
            position: relative;
            height: 300px;
            width: 100%;
        }
        
        .motor-animation {
            animation: rotate 20s linear infinite;
            transform-origin: center;
        }
        
        @keyframes rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        
        .fan-animation {
            animation: spin 2s linear infinite;
        }
        
        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        
        .pulse-dot {
            animation: pulseDot 2s infinite;
        }
        
        @keyframes pulseDot {
            0% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.2); opacity: 0.7; }
            100% { transform: scale(1); opacity: 1; }
        }
        
        .notification-badge {
            position: absolute;
            top: -5px;
            right: -5px;
            background: #ef4444;
            color: white;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            animation: pulse 1.5s infinite;
        }
        
        .tooltip {
            position: relative;
        }
        
        .tooltip:hover .tooltip-text {
            visibility: visible;
            opacity: 1;
            transform: translateY(0);
        }
        
        .tooltip-text {
            visibility: hidden;
            opacity: 0;
            position: absolute;
            z-index: 10;
            background: #1e293b;
            color: white;
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 14px;
            white-space: nowrap;
            transition: all 0.3s ease;
            transform: translateY(10px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
        }
        
        .tooltip-text::after {
            content: "";
            position: absolute;
            top: -5px;
            left: 50%;
            transform: translateX(-50%);
            border-width: 0 5px 5px 5px;
            border-style: solid;
            border-color: transparent transparent #1e293b transparent;
        }
        
        .draggable {
            cursor: move;
            user-select: none;
        }
        
        .dropzone {
            border: 2px dashed #cbd5e1;
            transition: all 0.3s ease;
        }
        
        .dropzone.dragover {
            border-color: #3b82f6;
            background: rgba(59, 130, 246, 0.05);
        }
        
        .component-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
        }
        
        .component-item {
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            padding: 15px;
            transition: all 0.3s ease;
            background: white;
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
        }
        
        .component-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            border-color: #3b82f6;
        }
        
        .component-icon {
            width: 60px;
            height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 20%);
            border-radius: 12px;
            margin-bottom: 10px;
            color: white;
            font-size: 24px;
        }
        
        .stage-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            display: inline-block;
            margin-right: 5px;
        }
        
        .stage-active {
            background: #10b981;
            box-shadow: 0 0 10px #10b981;
        }
        
        .stage-inactive {
            background: #cbd5e1;
        }
        
        .stage-completed {
            background: #3b82f6;
        }
        
        .progress-bar {
            height: 8px;
            border-radius: 4px;
            background: #e2e8f0;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #3b82f6, #8b5cf6);
            transition: width 0.5s ease;
        }
        
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
            animation: slideIn 0.3s ease;
        }
        
        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        .data-table {
            width: 100%;
            border-collapse: collapse;
        }
        
        .data-table th {
            background: #f8fafc;
            padding: 12px 15px;
            text-align: right;
            border-bottom: 2px solid #e2e8f0;
            font-weight: 600;
        }
        
        .data-table td {
            padding: 10px 15px;
            border-bottom: 1px solid #e2e8f0;
        }
        
        .data-table tr:hover {
            background: #f1f5f9;
        }
        
        .context-menu {
            position: absolute;
            background: white;
            border-radius: 8px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
            z-index: 100;
            min-width: 180px;
            overflow: hidden;
        }
        
        .context-menu-item {
            padding: 10px 15px;
            transition: all 0.2s ease;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .context-menu-item:hover {
            background: #f1f5f9;
        }
        
        .context-menu-divider {
            height: 1px;
            background: #e2e8f0;
            margin: 5px 0;
        }
        
        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 50px;
            height: 24px;
        }
        
        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        
        .toggle-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #cbd5e1;
            transition: .4s;
            border-radius: 34px;
        }
        
        .toggle-slider:before {
            position: absolute;
            content: "";
            height: 16px;
            width: 16px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }
        
        input:checked + .toggle-slider {
            background-color: #3b82f6;
        }
        
        input:checked + .toggle-slider:before {
            transform: translateX(26px);
        }
        
        .color-picker {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            cursor: pointer;
            border: 2px solid white;
            box-shadow: 0 0 0 2px #e2e8f0;
        }
        
        .color-picker.active {
            box-shadow: 0 0 0 3px #3b82f6;
        }
        
        .dark-mode {
            background: #1e293b;
            color: #f8fafc;
        }
        
        .dark-mode .glass-effect {
            background: rgba(30, 41, 59, 0.85);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .dark-mode .input-3d {
            background: rgba(30, 41, 59, 0.9);
            border: 1px solid rgba(255, 255, 255, 0.1);
            color: #f8fafc;
        }
        
        .dark-mode .component-item {
            background: #334155;
            border-color: #475569;
        }
        
        .dark-mode .data-table th {
            background: #0f172a;
            border-color: #334155;
            color: #f8fafc;
        }
        
        .dark-mode .data-table td {
            border-color: #334155;
            color: #cbd5e1;
        }
        
        .dark-mode .data-table tr:hover {
            background: #334155;
        }
        
        .dark-mode .tooltip-text {
            background: #0f172a;
        }
        
        .dark-mode .tooltip-text::after {
            border-color: transparent transparent #0f172a transparent;
        }
        
        .dark-mode .context-menu {
            background: #334155;
        }
        
        .dark-mode .context-menu-item:hover {
            background: #475569;
        }
        
        .dark-mode .context-menu-divider {
            background: #475569;
        }
    </style>
</head>
<body class="rtl text-gray-800 bg-gradient-to-br from-blue-50 to-indigo-100 min-h-screen" 
      x-data="app()"
      x-init="initApp()"
      :class="{ 'dark-mode': darkMode }">
    
    <!-- Navigation -->
    <nav class="glass-effect sticky top-0 z-50 shadow-md">
        <div class="container mx-auto px-4 py-3">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4 space-x-reverse">
                    <div class="flex items-center">
                        <div class="bg-gradient-to-r from-blue-600 to-purple-600 w-10 h-10 rounded-lg flex items-center justify-center">
                            <i class="fas fa-fan text-white text-xl"></i>
                        </div>
                        <div class="mr-3">
                            <h1 class="text-xl font-bold text-gray-800 dark:text-white">تهویه نساجی حرفه‌ای</h1>
                            <p class="text-sm text-gray-600 dark:text-gray-300">طراحی HVAC + PLC + کنترل</p>
                        </div>
                    </div>
                    
                    <div class="hidden md:flex items-center space-x-6 space-x-reverse">
                        <button @click="activeTab = 'dashboard'" 
                                :class="activeTab === 'dashboard' ? 'tab-active' : 'tab-inactive'"
                                class="pb-2">
                            <i class="fas fa-tachometer-alt ml-1"></i>
                            داشبورد
                        </button>
                        <button @click="activeTab = 'project'" 
                                :class="activeTab === 'project' ? 'tab-active' : 'tab-inactive'"
                                class="pb-2">
                            <i class="fas fa-project-diagram ml-1"></i>
                            پروژه
                        </button>
                        <button @click="activeTab = 'saloon'" 
                                :class="activeTab === 'saloon' ? 'tab-inactive' : 'tab-inactive'"
                                class="pb-2">
                            <i class="fas fa-industry ml-1"></i>
                            سالن‌ها
                        </button>
                        <button @click="activeTab = 'ac-station'" 
                                :class="activeTab === 'ac-station' ? 'tab-active' : 'tab-inactive'"
                                class="pb-2">
                            <i class="fas fa-wind ml-1"></i>
                            ایستگاه تهویه
                        </button>
                        <button @click="activeTab = 'filter-plan'" 
                                :class="activeTab === 'filter-plan' ? 'tab-active' : 'tab-inactive'"
                                class="pb-2">
                            <i class="fas fa-filter ml-1"></i>
                            فیلتر پلن
                        </button>
                        <button @click="activeTab = 'plc'" 
                                :class="activeTab === 'plc' ? 'tab-active' : 'tab-inactive'"
                                class="pb-2">
                            <i class="fas fa-microchip ml-1"></i>
                            طراحی PLC
                        </button>
                        <button @click="activeTab = 'bom'" 
                                :class="activeTab === 'bom' ? 'tab-active' : 'tab-inactive'"
                                class="pb-2">
                            <i class="fas fa-clipboard-list ml-1"></i>
                            BOM/MTO
                        </button>
                        <button @click="activeTab = 'reports'" 
                                :class="activeTab === 'reports' ? 'tab-active' : 'tab-inactive'"
                                class="pb-2">
                            <i class="fas fa-chart-bar ml-1"></i>
                            گزارش‌ها
                        </button>
                    </div>
                </div>
                
                <div class="flex items-center space-x-4 space-x-reverse">
                    <button @click="darkMode = !darkMode" class="p-2 rounded-full bg-gray-100 dark:bg-gray-800 text-gray-800 dark:text-white">
                        <i :class="darkMode ? 'fas fa-sun' : 'fas fa-moon'"></i>
                    </button>
                    
                    <div class="relative">
                        <button @click="notificationsOpen = !notificationsOpen" class="p-2 rounded-full bg-gray-100 dark:bg-gray-800 text-gray-800 dark:text-white relative">
                            <i class="fas fa-bell"></i>
                            <span x-show="unreadNotifications > 0" class="notification-badge" x-text="unreadNotifications"></span>
                        </button>
                        
                        <!-- Notifications Dropdown -->
                        <div x-show="notificationsOpen" 
                             @click.outside="notificationsOpen = false"
                             class="absolute left-0 mt-2 w-80 bg-white dark:bg-gray-800 rounded-lg shadow-xl z-50 border border-gray-200 dark:border-gray-700">
                            <div class="p-4 border-b border-gray-200 dark:border-gray-700">
                                <h3 class="font-bold text-gray-800 dark:text-white">اعلان‌ها</h3>
                            </div>
                            <div class="max-h-80 overflow-y-auto">
                                <template x-for="notification in notifications" :key="notification.id">
                                    <div class="p-4 border-b border-gray-100 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-700 cursor-pointer"
                                         :class="{ 'bg-blue-50 dark:bg-blue-900': !notification.read }"
                                         @click="markNotificationRead(notification.id)">
                                        <div class="flex items-start">
                                            <div class="ml-3">
                                                <p class="text-sm font-medium text-gray-800 dark:text-white" x-text="notification.title"></p>
                                                <p class="text-xs text-gray-600 dark:text-gray-300 mt-1" x-text="notification.message"></p>
                                                <p class="text-xs text-gray-500 dark:text-gray-400 mt-1" x-text="notification.time"></p>
                                            </div>
                                            <div class="mr-auto">
                                                <span class="inline-flex items-center px-2 py-1 rounded-full text-xs"
                                                      :class="{
                                                          'bg-green-100 text-green-800': notification.type === 'success',
                                                          'bg-blue-100 text-blue-800': notification.type === 'info',
                                                          'bg-yellow-100 text-yellow-800': notification.type === 'warning',
                                                          'bg-red-100 text-red-800': notification.type === 'error'
                                                      }"
                                                      x-text="notification.type === 'success' ? 'موفق' : 
                                                              notification.type === 'info' ? 'اطلاع' : 
                                                              notification.type === 'warning' ? 'هشدار' : 'خطا'"></span>
                                            </div>
                                        </div>
                                    </div>
                                </template>
                            </div>
                            <div class="p-3 text-center border-t border-gray-200 dark:border-gray-700">
                                <button @click="clearNotifications" class="text-sm text-blue-600 dark:text-blue-400 hover:underline">پاک کردن همه</button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="relative">
                        <button @click="userMenuOpen = !userMenuOpen" class="flex items-center space-x-2 space-x-reverse">
                            <div class="w-10 h-10 rounded-full bg-gradient-to-r from-blue-500 to-purple-500 flex items-center justify-center text-white font-bold">
                                <span>ا</span>
                            </div>
                            <div class="hidden md:block text-right">
                                <p class="text-sm font-medium text-gray-800 dark:text-white">کاربر سیستم</p>
                                <p class="text-xs text-gray-600 dark:text-gray-300">مهندس طراح</p>
                            </div>
                        </button>
                        
                        <!-- User Menu Dropdown -->
                        <div x-show="userMenuOpen" 
                             @click.outside="userMenuOpen = false"
                             class="absolute left-0 mt-2 w-48 bg-white dark:bg-gray-800 rounded-lg shadow-xl z-50 border border-gray-200 dark:border-gray-700">
                            <div class="p-4 border-b border-gray-200 dark:border-gray-700">
                                <p class="font-medium text-gray-800 dark:text-white">کاربر سیستم</p>
                                <p class="text-sm text-gray-600 dark:text-gray-300">مهندس طراح</p>
                            </div>
                            <div class="py-2">
                                <a href="#" class="context-menu-item">
                                    <i class="fas fa-user text-gray-500"></i>
                                    <span>پروفایل کاربری</span>
                                </a>
                                <a href="#" class="context-menu-item">
                                    <i class="fas fa-cog text-gray-500"></i>
                                    <span>تنظیمات</span>
                                </a>
                                <div class="context-menu-divider"></div>
                                <a href="#" class="context-menu-item">
                                    <i class="fas fa-question-circle text-gray-500"></i>
                                    <span>راهنما</span>
                                </a>
                                <a href="#" class="context-menu-item">
                                    <i class="fas fa-download text-gray-500"></i>
                                    <span>خروجی PDF</span>
                                </a>
                                <div class="context-menu-divider"></div>
                                <button @click="logout" class="context-menu-item w-full text-right">
                                    <i class="fas fa-sign-out-alt text-gray-500"></i>
                                    <span>خروج از سیستم</span>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </nav>
    
    <!-- Mobile Navigation -->
    <div class="md:hidden bg-white dark:bg-gray-800 border-t border-gray-200 dark:border-gray-700 fixed bottom-0 left-0 right-0 z-40">
        <div class="flex justify-around py-3">
            <button @click="activeTab = 'dashboard'" class="flex flex-col items-center" :class="{ 'text-blue-600': activeTab === 'dashboard' }">
                <i class="fas fa-tachometer-alt text-lg"></i>
                <span class="text-xs mt-1">داشبورد</span>
            </button>
            <button @click="activeTab = 'project'" class="flex flex-col items-center" :class="{ 'text-blue-600': activeTab === 'project' }">
                <i class="fas fa-project-diagram text-lg"></i>
                <span class="text-xs mt-1">پروژه</span>
            </button>
            <button @click="activeTab = 'ac-station'" class="flex flex-col items-center" :class="{ 'text-blue-600': activeTab === 'ac-station' }">
                <i class="fas fa-wind text-lg"></i>
                <span class="text-xs mt-1">تهویه</span>
            </button>
            <button @click="activeTab = 'plc'" class="flex flex-col items-center" :class="{ 'text-blue-600': activeTab === 'plc' }">
                <i class="fas fa-microchip text-lg"></i>
                <span class="text-xs mt-1">PLC</span>
            </button>
            <button @click="activeTab = 'bom'" class="flex flex-col items-center" :class="{ 'text-blue-600': activeTab === 'bom' }">
                <i class="fas fa-clipboard-list text-lg"></i>
                <span class="text-xs mt-1">BOM</span>
            </button>
        </div>
    </div>
    
    <!-- Main Content -->
    <main class="container mx-auto px-4 py-6 pb-20 md:pb-6">
        
        <!-- Dashboard -->
        <div x-show="activeTab === 'dashboard'" x-transition>
            <div class="mb-8">
                <h2 class="text-2xl font-bold text-gray-800 dark:text-white mb-4">داشبورد طراحی تهویه نساجی</h2>
                <p class="text-gray-600 dark:text-gray-300">سیستم جامع طراحی HVAC، PLC و کنترل برای صنایع نساجی</p>
            </div>
            
            <!-- Stats Cards -->
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                <div class="dashboard-card bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 border-l-4 border-blue-500">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-gray-500 dark:text-gray-400 text-sm">تعداد پروژه‌ها</p>
                            <p class="text-2xl font-bold text-gray-800 dark:text-white mt-1" x-text="projectCount"></p>
                        </div>
                        <div class="w-12 h-12 rounded-full bg-blue-100 dark:bg-blue-900 flex items-center justify-center">
                            <i class="fas fa-project-diagram text-blue-600 dark:text-blue-300 text-xl"></i>
                        </div>
                    </div>
                    <div class="mt-4">
                        <div class="flex items-center text-sm text-gray-600 dark:text-gray-300">
                            <i class="fas fa-arrow-up text-green-500 ml-1"></i>
                            <span>۱۲٪ نسبت به ماه قبل</span>
                        </div>
                    </div>
                </div>
                
                <div class="dashboard-card bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 border-l-4 border-green-500">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-gray-500 dark:text-gray-400 text-sm">سالن‌های طراحی شده</p>
                            <p class="text-2xl font-bold text-gray-800 dark:text-white mt-1" x-text="saloonCount"></p>
                        </div>
                        <div class="w-12 h-12 rounded-full bg-green-100 dark:bg-green-900 flex items-center justify-center">
                            <i class="fas fa-industry text-green-600 dark:text-green-300 text-xl"></i>
                        </div>
                    </div>
                    <div class="mt-4">
                        <div class="flex items-center text-sm text-gray-600 dark:text-gray-300">
                            <i class="fas fa-arrow-up text-green-500 ml-1"></i>
                            <span>۸٪ نسبت به ماه قبل</span>
                        </div>
                    </div>
                </div>
                
                <div class="dashboard-card bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 border-l-4 border-purple-500">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-gray-500 dark:text-gray-400 text-sm">ایستگاه‌های تهویه</p>
                            <p class="text-2xl font-bold text-gray-800 dark:text-white mt-1" x-text="acStationCount"></p>
                        </div>
                        <div class="w-12 h-12 rounded-full bg-purple-100 dark:bg-purple-900 flex items-center justify-center">
                            <i class="fas fa-wind text-purple-600 dark:text-purple-300 text-xl"></i>
                        </div>
                    </div>
                    <div class="mt-4">
                        <div class="flex items-center text-sm text-gray-600 dark:text-gray-300">
                            <i class="fas fa-arrow-up text-green-500 ml-1"></i>
                            <span>۱۵٪ نسبت به ماه قبل</span>
                        </div>
                    </div>
                </div>
                
                <div class="dashboard-card bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 border-l-4 border-yellow-500">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-gray-500 dark:text-gray-400 text-sm">مقدار BOM تولیدی</p>
                            <p class="text-2xl font-bold text-gray-800 dark:text-white mt-1">$<span x-text="totalBomCost.toLocaleString()"></span></p>
                        </div>
                        <div class="w-12 h-12 rounded-full bg-yellow-100 dark:bg-yellow-900 flex items-center justify-center">
                            <i class="fas fa-dollar-sign text-yellow-600 dark:text-yellow-300 text-xl"></i>
                        </div>
                    </div>
                    <div class="mt-4">
                        <div class="flex items-center text-sm text-gray-600 dark:text-gray-300">
                            <i class="fas fa-arrow-up text-green-500 ml-1"></i>
                            <span>۲۲٪ نسبت به ماه قبل</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Quick Actions -->
            <div class="mb-8">
                <h3 class="text-lg font-bold text-gray-800 dark:text-white mb-4">اقدامات سریع</h3>
                <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                    <button @click="activeTab = 'project'; newProject()" class="btn-primary p-4 rounded-xl flex flex-col items-center justify-center">
                        <i class="fas fa-plus-circle text-2xl mb-2"></i>
                        <span>پروژه جدید</span>
                    </button>
                    
                    <button @click="activeTab = 'saloon'; newSaloon()" class="btn-secondary p-4 rounded-xl flex flex-col items-center justify-center">
                        <i class="fas fa-industry text-2xl mb-2"></i>
                        <span>سالن جدید</span>
                    </button>
                    
                    <button @click="activeTab = 'ac-station'; newACStation()" class="btn-success p-4 rounded-xl flex flex-col items-center justify-center">
                        <i class="fas fa-wind text-2xl mb-2"></i>
                        <span>ایستگاه تهویه</span>
                    </button>
                    
                    <button @click="activeTab = 'plc'; newPLCProject()" class="btn-warning p-4 rounded-xl flex flex-col items-center justify-center">
                        <i class="fas fa-microchip text-2xl mb-2"></i>
                        <span>طراحی PLC</span>
                    </button>
                </div>
            </div>
            
            <!-- Recent Projects -->
            <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 mb-8">
                <div class="flex items-center justify-between mb-6">
                    <h3 class="text-lg font-bold text-gray-800 dark:text-white">پروژه‌های اخیر</h3>
                    <button @click="activeTab = 'project'" class="text-blue-600 dark:text-blue-400 hover:underline">مشاهده همه</button>
                </div>
                <div class="overflow-x-auto">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>نام پروژه</th>
                                <th>محل</th>
                                <th>تاریخ ایجاد</th>
                                <th>وضعیت</th>
                                <th>هزینه تخمینی</th>
                                <th>عملیات</th>
                            </tr>
                        </thead>
                        <tbody>
                            <template x-for="project in recentProjects" :key="project.id">
                                <tr>
                                    <td>
                                        <div class="flex items-center">
                                            <div class="w-8 h-8 rounded-full bg-gradient-to-r from-blue-500 to-purple-500 flex items-center justify-center text-white font-bold text-xs ml-3">
                                                <span x-text="project.name.charAt(0)"></span>
                                            </div>
                                            <span x-text="project.name"></span>
                                        </div>
                                    </td>
                                    <td x-text="project.location"></td>
                                    <td x-text="project.date"></td>
                                    <td>
                                        <span class="inline-flex items-center px-3 py-1 rounded-full text-xs"
                                              :class="{
                                                  'bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200': project.status === 'completed',
                                                  'bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200': project.status === 'in-progress',
                                                  'bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200': project.status === 'planned'
                                              }">
                                            <span x-show="project.status === 'completed'" class="stage-indicator stage-active"></span>
                                            <span x-show="project.status === 'in-progress'" class="stage-indicator bg-yellow-500"></span>
                                            <span x-show="project.status === 'planned'" class="stage-indicator stage-inactive"></span>
                                            <span x-text="project.status === 'completed' ? 'تکمیل' : 
                                                          project.status === 'in-progress' ? 'در حال انجام' : 'برنامه‌ریزی'"></span>
                                        </span>
                                    </td>
                                    <td>$<span x-text="project.estimatedCost.toLocaleString()"></span></td>
                                    <td>
                                        <div class="flex space-x-2 space-x-reverse">
                                            <button @click="openProject(project.id)" class="text-blue-600 dark:text-blue-400 hover:text-blue-800">
                                                <i class="fas fa-eye"></i>
                                            </button>
                                            <button @click="editProject(project.id)" class="text-green-600 dark:text-green-400 hover:text-green-800">
                                                <i class="fas fa-edit"></i>
                                            </button>
                                            <button @click="deleteProject(project.id)" class="text-red-600 dark:text-red-400 hover:text-red-800">
                                                <i class="fas fa-trash"></i>
                                            </button>
                                        </div>
                                    </td>
                                </tr>
                            </template>
                        </tbody>
                    </table>
                </div>
            </div>
            
            <!-- System Status -->
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                <!-- PLC Templates -->
                <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6">
                    <h3 class="text-lg font-bold text-gray-800 dark:text-white mb-4">تمپلیت‌های PLC آماده</h3>
                    <div class="space-y-4">
                        <div class="flex items-center justify-between p-4 bg-gray-50 dark:bg-gray-700 rounded-lg">
                            <div class="flex items-center">
                                <div class="w-10 h-10 rounded-lg bg-gradient-to-r from-blue-500 to-blue-600 flex items-center justify-center text-white ml-3">
                                    <i class="fas fa-bolt"></i>
                                </div>
                                <div>
                                    <p class="font-medium text-gray-800 dark:text-white">AC Station Soft Starter</p>
                                    <p class="text-sm text-gray-600 dark:text-gray-300">تمپلیت ایستگاه AC با سافت استارتر</p>
                                </div>
                            </div>
                            <button @click="activeTab = 'plc'; loadTemplate('soft-starter')" class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700">
                                                <span class="fa-solid fa-download ml-1"></span>
                                                بارگذاری
                                            </button>
                                        </div>
                                        
                                        <div class="flex items-center justify-between p-4 bg-gray-50 dark:bg-gray-700 rounded-lg">
                                            <div class="flex items-center">
                                                <div class="w-10 h-10 rounded-lg bg-gradient-to-r from-green-500 to-green-600 flex items-center justify-center text-white ml-3">
                                                    <i class="fas fa-tachometer-alt"></i>
                                                </div>
                                                <div>
                                                    <p class="font-medium text-gray-800 dark:text-white">AC Station VFD</p>
                                                    <p class="text-sm text-gray-600 dark:text-gray-300">تمپلیت ایستگاه AC با درایو فرکانس متغیر</p>
                                                </div>
                                            </div>
                                            <button @click="activeTab = 'plc'; loadTemplate('vfd')" class="px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700">
                                                <span class="fa-solid fa-download ml-1"></span>
                                                بارگذاری
                                            </button>
                                        </div>
                                        
                                        <div class="flex items-center justify-between p-4 bg-gray-50 dark:bg-gray-700 rounded-lg">
                                            <div class="flex items-center">
                                                <div class="w-10 h-10 rounded-lg bg-gradient-to-r from-purple-500 to-purple-600 flex items-center justify-center text-white ml-3">
                                                    <i class="fas fa-filter"></i>
                                                </div>
                                                <div>
                                                    <p class="font-medium text-gray-800 dark:text-white">Filter Plant Soft Starter</p>
                                                    <p class="text-sm text-gray-600 dark:text-gray-300">تمپلیت فیلتر پلن با سافت استارتر</p>
                                                </div>
                                            </div>
                                            <button @click="activeTab = 'plc'; loadTemplate('filter-soft')" class="px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700">
                                                <span class="fa-solid fa-download ml-1"></span>
                                                بارگذاری
                                            </button>
                                        </div>
                                        
                                        <div class="flex items-center justify-between p-4 bg-gray-50 dark:bg-gray-700 rounded-lg">
                                            <div class="flex items-center">
                                                <div class="w-10 h-10 rounded-lg bg-gradient-to-r from-yellow-500 to-yellow-600 flex items-center justify-center text-white ml-3">
                                                    <i class="fas fa-filter"></i>
                                                </div>
                                                <div>
                                                    <p class="font-medium text-gray-800 dark:text-white">Filter Plant VFD</p>
                                                    <p class="text-sm text-gray-600 dark:text-gray-300">تمپلیت فیلتر پلن با درایو فرکانس متغیر</p>
                                                </div>
                                            </div>
                                            <button @click="activeTab = 'plc'; loadTemplate('filter-vfd')" class="px-4 py-2 bg-yellow-600 text-white rounded-lg hover:bg-yellow-700">
                                                <span class="fa-solid fa-download ml-1"></span>
                                                بارگذاری
                                            </button>
                                        </div>
                                    </div>
                                </div>
                
                                <!-- HVAC Calculations -->
                                <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6">
                                    <h3 class="text-lg font-bold text-gray-800 dark:text-white mb-4">محاسبات سریع HVAC</h3>
                                    <div class="space-y-6">
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">جریان هوا مورد نیاز (m³/s)</label>
                                            <input type="number" x-model="quickCalc.airflow" class="input-3d w-full p-3 rounded-lg border-0 focus:ring-2 focus:ring-blue-500">
                                        </div>
                                        
                                        <div class="grid grid-cols-2 gap-4">
                                            <div>
                                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">دمای هوای ورودی (°C)</label>
                                                <input type="number" x-model="quickCalc.inletTemp" class="input-3d w-full p-3 rounded-lg border-0 focus:ring-2 focus:ring-blue-500">
                                            </div>
                                            
                                            <div>
                                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">دمای هوای خروجی (°C)</label>
                                                <input type="number" x-model="quickCalc.outletTemp" class="input-3d w-full p-3 rounded-lg border-0 focus:ring-2 focus:ring-blue-500">
                                            </div>
                                        </div>
                                        
                                        <div class="grid grid-cols-2 gap-4">
                                            <div>
                                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">رطوبت ورودی (%)</label>
                                                <input type="number" x-model="quickCalc.inletHumidity" class="input-3d w-full p-3 rounded-lg border-0 focus:ring-2 focus:ring-blue-500">
                                            </div>
                                            
                                            <div>
                                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">رطوبت خروجی (%)</label>
                                                <input type="number" x-model="quickCalc.outletHumidity" class="input-3d w-full p-3 rounded-lg border-0 focus:ring-2 focus:ring-blue-500">
                                            </div>
                                        </div>
                                        
                                        <button @click="calculateHVAC()" class="btn-primary w-full p-3 rounded-lg font-medium">
                                            <i class="fas fa-calculator ml-2"></i>
                                            محاسبه بار حرارتی و برودتی
                                        </button>
                                        
                                        <div x-show="quickCalcResult" class="p-4 bg-gradient-to-r from-blue-50 to-blue-100 dark:from-blue-900 dark:to-blue-800 rounded-lg">
                                            <h4 class="font-bold text-gray-800 dark:text-white mb-2">نتایج محاسبه:</h4>
                                            <div class="grid grid-cols-2 gap-4">
                                                <div>
                                                    <p class="text-sm text-gray-600 dark:text-gray-300">بار حرارتی</p>
                                                    <p class="text-lg font-bold text-gray-800 dark:text-white" x-text="quickCalcResult.heating + ' kW'"></p>
                                                </div>
                                                <div>
                                                    <p class="text-sm text-gray-600 dark:text-gray-300">بار برودتی</p>
                                                    <p class="text-lg font-bold text-gray-800 dark:text-white" x-text="quickCalcResult.cooling + ' kW'"></p>
                                                </div>
                                                <div>
                                                    <p class="text-sm text-gray-600 dark:text-gray-300">رطوبت‌گیری</p>
                                                    <p class="text-lg font-bold text-gray-800 dark:text-white" x-text="quickCalcResult.dehumidification + ' kg/h'"></p>
                                                </div>
                                                <div>
                                                    <p class="text-sm text-gray-600 dark:text-gray-300">رطوبت‌زنی</p>
                                                    <p class="text-lg font-bold text-gray-800 dark:text-white" x-text="quickCalcResult.humidification + ' kg/h'"></p>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Project Management -->
                        <div x-show="activeTab === 'project'" x-transition>
                            <div class="mb-8">
                                <div class="flex items-center justify-between">
                                    <h2 class="text-2xl font-bold text-gray-800 dark:text-white">مدیریت پروژه‌ها</h2>
                                    <button @click="showNewProjectModal = true" class="btn-primary px-6 py-3 rounded-lg flex items-center">
                                        <i class="fas fa-plus ml-2"></i>
                                        پروژه جدید
                                    </button>
                                </div>
                                <p class="text-gray-600 dark:text-gray-300 mt-2">ایجاد و مدیریت پروژه‌های تهویه نساجی</p>
                            </div>
                            
                            <!-- Projects Grid -->
                            <div class="grid-stack mb-8">
                                <template x-for="project in projects" :key="project.id">
                                    <div class="component-3d bg-white dark:bg-gray-800 rounded-xl shadow-lg overflow-hidden">
                                        <div class="p-6">
                                            <div class="flex items-center justify-between mb-4">
                                                <div class="flex items-center">
                                                    <div class="w-12 h-12 rounded-lg bg-gradient-to-r from-blue-500 to-purple-500 flex items-center justify-center text-white font-bold text-lg">
                                                        <span x-text="project.name.charAt(0)"></span>
                                                    </div>
                                                    <div class="mr-3">
                                                        <h3 class="font-bold text-gray-800 dark:text-white" x-text="project.name"></h3>
                                                        <p class="text-sm text-gray-600 dark:text-gray-300" x-text="project.location"></p>
                                                    </div>
                                                </div>
                                                <div class="relative">
                                                    <button @click="projectMenuOpen = project.id" class="p-2 text-gray-500 hover:text-gray-800 dark:hover:text-white">
                                                        <i class="fas fa-ellipsis-v"></i>
                                                    </button>
                                                    
                                                    <!-- Project Context Menu -->
                                                    <div x-show="projectMenuOpen === project.id" 
                                                         @click.outside="projectMenuOpen = null"
                                                         class="context-menu">
                                                        <button @click="openProject(project.id)" class="context-menu-item">
                                                            <i class="fas fa-eye text-gray-500"></i>
                                                            <span>مشاهده</span>
                                                        </button>
                                                        <button @click="editProject(project.id)" class="context-menu-item">
                                                            <i class="fas fa-edit text-gray-500"></i>
                                                            <span>ویرایش</span>
                                                        </button>
                                                        <button @click="duplicateProject(project.id)" class="context-menu-item">
                                                            <i class="fas fa-copy text-gray-500"></i>
                                                            <span>تکثیر</span>
                                                        </button>
                                                        <div class="context-menu-divider"></div>
                                                        <button @click="exportProject(project.id)" class="context-menu-item">
                                                            <i class="fas fa-download text-gray-500"></i>
                                                            <span>خروجی</span>
                                                        </button>
                                                        <button @click="deleteProject(project.id)" class="context-menu-item text-red-600">
                                                            <i class="fas fa-trash text-red-500"></i>
                                                            <span>حذف</span>
                                                        </button>
                                                    </div>
                                                </div>
                                            </div>
                                            
                                            <p class="text-gray-600 dark:text-gray-300 text-sm mb-4" x-text="project.description"></p>
                                            
                                            <div class="flex items-center justify-between mb-4">
                                                <div>
                                                    <p class="text-sm text-gray-500 dark:text-gray-400">وضعیت</p>
                                                    <span class="inline-flex items-center px-3 py-1 rounded-full text-xs mt-1"
                                                          :class="{
                                                              'bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200': project.status === 'completed',
                                                              'bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200': project.status === 'in-progress',
                                                              'bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200': project.status === 'planned'
                                                          }">
                                                        <span x-show="project.status === 'completed'" class="stage-indicator stage-active"></span>
                                                        <span x-show="project.status === 'in-progress'" class="stage-indicator bg-yellow-500"></span>
                                                        <span x-show="project.status === 'planned'" class="stage-indicator stage-inactive"></span>
                                                        <span x-text="project.status === 'completed' ? 'تکمیل' : 
                                                                      project.status === 'in-progress' ? 'در حال انجام' : 'برنامه‌ریزی'"></span>
                                                    </span>
                                                </div>
                                                
                                                <div>
                                                    <p class="text-sm text-gray-500 dark:text-gray-400">هزینه</p>
                                                    <p class="font-bold text-gray-800 dark:text-white">$<span x-text="project.estimatedCost.toLocaleString()"></span></p>
                                                </div>
                                            </div>
                                            
                                            <div class="mb-4">
                                                <p class="text-sm text-gray-500 dark:text-gray-400 mb-1">پیشرفت</p>
                                                <div class="progress-bar">
                                                    <div class="progress-fill" :style="`width: ${project.progress}%`"></div>
                                                </div>
                                                <p class="text-xs text-gray-500 dark:text-gray-400 mt-1 text-left" x-text="`${project.progress}%`"></p>
                                            </div>
                                            
                                            <div class="flex items-center justify-between text-sm text-gray-500 dark:text-gray-400">
                                                <div class="flex items-center">
                                                    <i class="fas fa-user ml-1"></i>
                                                    <span x-text="project.author"></span>
                                                </div>
                                                <div class="flex items-center">
                                                    <i class="fas fa-calendar ml-1"></i>
                                                    <span x-text="project.date"></span>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <div class="bg-gray-50 dark:bg-gray-700 px-6 py-3 flex justify-between">
                                            <button @click="openProject(project.id)" class="text-blue-600 dark:text-blue-400 hover:underline">
                                                <i class="fas fa-external-link-alt ml-1"></i>
                                                ورود به پروژه
                                            </button>
                                            <button @click="activeTab = 'bom'; generateBOM(project.id)" class="text-green-600 dark:text-green-400 hover:underline">
                                                <i class="fas fa-clipboard-list ml-1"></i>
                                                تولید BOM
                                            </button>
                                        </div>
                                    </div>
                                </template>
                            </div>
                            
                            <!-- No Projects Message -->
                            <div x-show="projects.length === 0" class="text-center py-12">
                                <div class="w-24 h-24 mx-auto mb-6 rounded-full bg-gradient-to-r from-blue-100 to-purple-100 dark:from-blue-900 dark:to-purple-900 flex items-center justify-center">
                                    <i class="fas fa-project-diagram text-4xl text-blue-600 dark:text-blue-300"></i>
                                </div>
                                <h3 class="text-xl font-bold text-gray-800 dark:text-white mb-2">هنوز پروژه‌ای ایجاد نکرده‌اید</h3>
                                                <p class="text-gray-600 dark:text-gray-300 mb-6">با ایجاد یک پروژه جدید شروع کنید</p>
                                                <button @click="showNewProjectModal = true" class="btn-primary px-8 py-3 rounded-lg">
                                                    <i class="fas fa-plus ml-2"></i>
                                                    ایجاد پروژه جدید
                                                </button>
                                            </div>
                                        </div>
                                        
                                        <!-- AC Station Design -->
                                        <div x-show="activeTab === 'ac-station'" x-transition>
                                            <div class="mb-8">
                                                <div class="flex items-center justify-between">
                                                    <h2 class="text-2xl font-bold text-gray-800 dark:text-white">طراحی ایستگاه تهویه</h2>
                                                    <div class="flex space-x-3 space-x-reverse">
                                                        <button @click="showACStationModal = true" class="btn-primary px-6 py-3 rounded-lg flex items-center">
                                                            <i class="fas fa-plus ml-2"></i>
                                                            ایستگاه جدید
                                                        </button>
                                                        <button @click="calculateACStation()" class="btn-success px-6 py-3 rounded-lg flex items-center">
                                                            <i class="fas fa-calculator ml-2"></i>
                                                            محاسبه
                                                        </button>
                                                    </div>
                                                </div>
                                                <p class="text-gray-600 dark:text-gray-300 mt-2">طراحی کامل ایستگاه تهویه نساجی با تمام جزئیات</p>
                                            </div>
                                            
                                            <!-- AC Station Tabs -->
                                            <div class="mb-8">
                                                <div class="flex overflow-x-auto border-b border-gray-200 dark:border-gray-700">
                                                    <button @click="acStationTab = 'airflow'" 
                                                            :class="acStationTab === 'airflow' ? 'tab-active' : 'tab-inactive'"
                                                            class="px-6 py-3 font-medium whitespace-nowrap">
                                                        <i class="fas fa-wind ml-2"></i>
                                                        جریان هوا
                                                    </button>
                                                    <button @click="acStationTab = 'duct'" 
                                                            :class="acStationTab === 'duct' ? 'tab-active' : 'tab-inactive'"
                                                            class="px-6 py-3 font-medium whitespace-nowrap">
                                                        <i class="fas fa-road ml-2"></i>
                                                        کانال‌ها
                                                    </button>
                                                    <button @click="acStationTab = 'vent'" 
                                                            :class="acStationTab === 'vent' ? 'tab-active' : 'tab-inactive'"
                                                            class="px-6 py-3 font-medium whitespace-nowrap">
                                                        <i class="fas fa-vent-damper ml-2"></i>
                                                        دریچه‌ها
                                                    </button>
                                                    <button @click="acStationTab = 'arf'" 
                                                            :class="acStationTab === 'arf' ? 'tab-active' : 'tab-inactive'"
                                                            class="px-6 py-3 font-medium whitespace-nowrap">
                                                        <i class="fas fa-filter ml-2"></i>
                                                        فیلتر دورانی
                                                    </button>
                                                    <button @click="acStationTab = 'damper'" 
                                                            :class="acStationTab === 'damper' ? 'tab-active' : 'tab-inactive'"
                                                            class="px-6 py-3 font-medium whitespace-nowrap">
                                                        <i class="fas fa-window-minimize ml-2"></i>
                                                        دمپرها
                                                    </button>
                                                    <button @click="acStationTab = 'coil'" 
                                                            :class="acStationTab === 'coil' ? 'tab-active' : 'tab-inactive'"
                                                            class="px-6 py-3 font-medium whitespace-nowrap">
                                                        <i class="fas fa-fire ml-2"></i>
                                                        کویل گرمایش
                                                    </button>
                                                    <button @click="acStationTab = 'airwasher'" 
                                                            :class="acStationTab === 'airwasher' ? 'tab-active' : 'tab-inactive'"
                                                            class="px-6 py-3 font-medium whitespace-nowrap">
                                                        <i class="fas fa-shower ml-2"></i>
                                                        ایرواشر
                                                    </button>
                                                    <button @click="acStationTab = 'fan'" 
                                                            :class="acStationTab === 'fan' ? 'tab-active' : 'tab-inactive'"
                                                            class="px-6 py-3 font-medium whitespace-nowrap">
                                                        <i class="fas fa-fan ml-2"></i>
                                                        فن‌ها
                                                    </button>
                                                </div>
                                            </div>
                                            
                                            <!-- AC Station Content -->
                                            <div>
                                                <!-- Airflow Section -->
                                                <div x-show="acStationTab === 'airflow'" x-transition>
                                                    <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 mb-6">
                                                        <h3 class="text-lg font-bold text-gray-800 dark:text-white mb-4">محاسبه جریان هوا</h3>
                                                        <p class="text-gray-600 dark:text-gray-300 mb-6">تعریف فضاها و محاسبه جریان هوا بر اساس ACH</p>
                                                        
                                                        <!-- Spaces List -->
                                                        <div class="mb-6">
                                                            <div class="flex items-center justify-between mb-4">
                                                                <h4 class="font-bold text-gray-800 dark:text-white">لیست فضاها</h4>
                                                                <button @click="addSpace()" class="btn-primary px-4 py-2 rounded-lg">
                                                                    <i class="fas fa-plus ml-2"></i>
                                                                    افزودن فضا
                                                                </button>
                                                            </div>
                                                            
                                                            <div class="overflow-x-auto">
                                                                <table class="data-table">
                                                                    <thead>
                                                                        <tr>
                                                                            <th>نام فضا</th>
                                                                            <th>طول (m)</th>
                                                                            <th>عرض (m)</th>
                                                                            <th>ارتفاع (m)</th>
                                                                            <th>ACH</th>
                                                                            <th>حجم (m³)</th>
                                                                            <th>جریان هوا (m³/s)</th>
                                                                            <th>عملیات</th>
                                                                        </tr>
                                                                    </thead>
                                                                    <tbody>
                                                                        <template x-for="(space, index) in acStation.spaces" :key="index">
                                                                            <tr>
                                                                                <td>
                                                                                    <input type="text" x-model="space.name" class="input-3d w-full p-2 rounded border-0">
                                                                                </td>
                                                                                <td>
                                                                                    <input type="number" x-model="space.length" @change="calculateSpace(space)" class="input-3d w-full p-2 rounded border-0">
                                                                                </td>
                                                                                <td>
                                                                                    <input type="number" x-model="space.width" @change="calculateSpace(space)" class="input-3d w-full p-2 rounded border-0">
                                                                                </td>
                                                                                <td>
                                                                                    <input type="number" x-model="space.height" @change="calculateSpace(space)" class="input-3d w-full p-2 rounded border-0">
                                                                                </td>
                                                                                <td>
                                                                                    <input type="number" x-model="space.ach" @change="calculateSpace(space)" class="input-3d w-full p-2 rounded border-0">
                                                                                </td>
                                                                                <td>
                                                                                    <span x-text="space.volume.toFixed(2)" class="font-bold"></span>
                                                                                </td>
                                                                                <td>
                                                                                    <span x-text="space.airflow.toFixed(3)" class="font-bold"></span>
                                                                                </td>
                                                                                <td>
                                                                                    <button @click="removeSpace(index)" class="text-red-600 hover:text-red-800">
                                                                                        <i class="fas fa-trash"></i>
                                                                                    </button>
                                                                                </td>
                                                                            </tr>
                                                                        </template>
                                                                    </tbody>
                                                                </table>
                                                            </div>
                                                        </div>
                                                        
                                                        <!-- Summary -->
                                                        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                                                            <div class="bg-gradient-to-r from-blue-50 to-blue-100 dark:from-blue-900 dark:to-blue-800 p-6 rounded-xl">
                                                                <p class="text-gray-600 dark:text-gray-300">جریان کل هوا</p>
                                                                <p class="text-2xl font-bold text-gray-800 dark:text-white">
                                                                    <span x-text="totalAirflow.toFixed(3)"></span> m³/s
                                                                </p>
                                                                <p class="text-sm text-gray-600 dark:text-gray-300 mt-1">
                                                                    <span x-text="(totalAirflow * 3600).toFixed(0)"></span> m³/h
                                                                </p>
                                                            </div>
                                                            
                                                            <div class="bg-gradient-to-r from-green-50 to-green-100 dark:from-green-900 dark:to-green-800 p-6 rounded-xl">
                                                                <p class="text-gray-600 dark:text-gray-300">تعداد ایستگاه‌ها</p>
                                                                <p class="text-2xl font-bold text-gray-800 dark:text-white" x-text="stationCount"></p>
                                                                <p class="text-sm text-gray-600 dark:text-gray-300 mt-1" x-text="stationCount === 1 ? 'تک ایستگاه' : 'چند ایستگاه'"></p>
                                                            </div>
                                                            
                                                            <div class="bg-gradient-to-r from-purple-50 to-purple-100 dark:from-purple-900 dark:to-purple-800 p-6 rounded-xl">
                                                                <p class="text-gray-600 dark:text-gray-300">جریان هر ایستگاه</p>
                                                                <p class="text-2xl font-bold text-gray-800 dark:text-white">
                                                                    <span x-text="stationAirflow.toFixed(3)"></span> m³/s
                                                                </p>
                                                                <p class="text-sm text-gray-600 dark:text-gray-300 mt-1">
                                                                    <span x-text="(stationAirflow * 3600).toFixed(0)"></span> m³/h
                                                                </p>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                
                                                <!-- Duct Design Section -->
                                                <div x-show="acStationTab === 'duct'" x-transition>
                                                    <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6">
                                                        <h3 class="text-lg font-bold text-gray-800 dark:text-white mb-4">طراحی کانال‌ها</h3>
                                                        <p class="text-gray-600 dark:text-gray-300 mb-6">طراحی کانال‌های رفت و برگشت</p>
                                                        
                                                        <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                                                            <!-- Feed Ducts -->
                                                            <div>
                                                                <h4 class="font-bold text-gray-800 dark:text-white mb-4">کانال‌های رفت</h4>
                                                                
                                                                <div class="space-y-4">
                                                                    <div>
                                                                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">تعداد شاخه‌های اصلی</label>
                                                                        <input type="number" x-model="ductDesign.feed.branches" min="1" max="10" class="input-3d w-full p-3 rounded-lg border-0">
                                                                    </div>
                                                                    
                                                                    <div>
                                                                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">سرعت هوا در کانال (m/s)</label>
                                                                        <input type="number" x-model="ductDesign.feed.velocity" min="1" max="20" step="0.1" class="input-3d w-full p-3 rounded-lg border-0">
                                                                        <p class="text-xs text-gray-500 dark:text-gray-400 mt-1">محدوده بهینه: 4-8 m/s</p>
                                                                    </div>
                                                                    
                                                                    <div>
                                                                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">فشار استاتیک (Pa)</label>
                                                                        <input type="number" x-model="ductDesign.feed.pressure" min="50" max="1000" step="10" class="input-3d w-full p-3 rounded-lg border-0">
                                                                    </div>
                                                                    
                                                                    <div>
                                                                        <button @click="calculateFeedDuct()" class="btn-primary w-full p-3 rounded-lg">
                                                                            محاسبه ابعاد کانال
                                                                        </button>
                                                                    </div>
                                                                    
                                                                    <div x-show="ductDesign.feed.calculated" class="p-4 bg-gradient-to-r from-blue-50 to-blue-100 dark:from-blue-900 dark:to-blue-800 rounded-lg">
                                                                        <h5 class="font-bold text-gray-800 dark:text-white mb-2">نتایج محاسبه کانال رفت:</h5>
                                                                        <div class="space-y-2">
                                                                            <div class="flex justify-between">
                                                                                <span class="text-gray-600 dark:text-gray-300">سطح مقطع کل:</span>
                                                                                <span class="font-bold" x-text="ductDesign.feed.totalArea.toFixed(2) + ' m²'"></span>
                                                                            </div>
                                                                            <div class="flex justify-between">
                                                                                <span class="text-gray-600 dark:text-gray-300">سطح مقطع هر شاخه:</span>
                                                                                <span class="font-bold" x-text="ductDesign.feed.branchArea.toFixed(2) + ' m²'"></span>
                                                                            </div>
                                                                            <div class="flex justify-between">
                                                                                <span class="text-gray-600 dark:text-gray-300">ابعاد استاندارد:</span>
                                                                                <span class="font-bold" x-text="ductDesign.feed.standardSize"></span>
                                                                            </div>
                                                                            <div class="flex justify-between">
                                                                                <span class="text-gray-600 dark:text-gray-300">افت فشار:</span>
                                                                                <span class="font-bold" x-text="ductDesign.feed.pressureDrop.toFixed(1) + ' Pa'"></span>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            
                                                            <!-- Return Ducts -->
                                                            <div>
                                                                <h4 class="font-bold text-gray-800 dark:text-white mb-4">کانال‌های برگشت</h4>
                                                                
                                                                <div class="space-y-4">
                                                                    <div>
                                                                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">کانال برگشت زیرزمینی</label>
                                                                        <label class="toggle-switch">
                                                                            <input type="checkbox" x-model="ductDesign.return.underground">
                                                                            <span class="toggle-slider"></span>
                                                                        </label>
                                                                    </div>
                                                                    
                                                                    <div>
                                                                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">تعداد شاخه‌ها</label>
                                                                        <input type="number" x-model="ductDesign.return.branches" min="1" max="10" class="input-3d w-full p-3 rounded-lg border-0">
                                                                    </div>
                                                                    
                                                                    <div>
                                                                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">سرعت هوا در کانال (m/s)</label>
                                                                        <input type="number" x-model="ductDesign.return.velocity" min="1" max="20" step="0.1" class="input-3d w-full p-3 rounded-lg border-0">
                                                                        <p class="text-xs text-gray-500 dark:text-gray-400 mt-1">محدوده بهینه: 3-6 m/s</p>
                                                                    </div>
                                                                    
                                                                    <div>
                                                                        <button @click="calculateReturnDuct()" class="btn-secondary w-full p-3 rounded-lg">
                                                                            محاسبه ابعاد کانال
                                                                        </button>
                                                                    </div>
                                                                    
                                                                    <div x-show="ductDesign.return.calculated" class="p-4 bg-gradient-to-r from-green-50 to-green-100 dark:from-green-900 dark:to-green-800 rounded-lg">
                                                                        <h5 class="font-bold text-gray-800 dark:text-white mb-2">نتایج محاسبه کانال برگشت:</h5>
                                                                        <div class="space-y-2">
                                                                            <div class="flex justify-between">
                                                                                <span class="text-gray-600 dark:text-gray-300">سطح مقطع کل:</span>
                                                                                <span class="font-bold" x-text="ductDesign.return.totalArea.toFixed(2) + ' m²'"></span>
                                                                            </div>
                                                                            <div class="flex justify-between">
                                                                                <span class="text-gray-600 dark:text-gray-300">سطح مقطع هر شاخه:</span>
                                                                                <span class="font-bold" x-text="ductDesign.return.branchArea.toFixed(2) + ' m²'"></span>
                                                                            </div>
                                                                            <div class="flex justify-between">
                                                                                <span class="text-gray-600 dark:text-gray-300">ابعاد استاندارد:</span>
                                                                                <span class="font-bold" x-text="ductDesign.return.standardSize"></span>
                                                                            </div>
                                                                            <div class="flex justify-between">
                                                                                <span class="text-gray-600 dark:text-gray-300">کانال زیرزمینی:</span>
                                                                                <span class="font-bold" x-text="ductDesign.return.underground ? 'بله' : 'خیر'"></span>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                
                                                <!-- Vent Design Section -->
                                                <div x-show="acStationTab === 'vent'" x-transition>
                                                    <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6">
                                                        <h3 class="text-lg font-bold text-gray-800 dark:text-white mb-4">طراحی دریچه‌ها</h3>
                                                        <p class="text-gray-600 dark:text-gray-300 mb-6">طراحی دریچه‌های رفت و برگشت</p>
                                                        
                                                        <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                                                            <!-- Feed Vents -->
                                                            <div>
                                                                <h4 class="font-bold text-gray-800 dark:text-white mb-4">دریچه‌های رفت</h4>
                                                                
                                                                <div class="space-y-4">
                                                                    <div>
                                                                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">تعداد دریچه‌ها</label>
                                                                        <input type="number" x-model="ventDesign.feed.count" min="1" max="100" class="input-3d w-full p-3 rounded-lg border-0">
                                                                    </div>
                                                                    
                                                                    <div>
                                                                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">عرض دریچه (m)</label>
                                                                        <input type="number" x-model="ventDesign.feed.width" min="0.1" max="2" step="0.1" class="input-3d w-full p-3 rounded-lg border-0">
                                                                    </div>
                                                                    
                                                                    <div>
                                                                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">طول دریچه (m)</label>
                                                                        <input type="number" x-model="ventDesign.feed.length" min="0.1" max="2" step="0.1" class="input-3d w-full p-3 rounded-lg border-0">
                                                                        <p class="text-xs text-gray-500 dark:text-gray-400 mt-1">معمولا طول = 2 × عرض</p>
                                                                    </div>
                                                                    
                                                                    <div>
                                                                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">سرعت هوا در دریچه (m/s)</label>
                                                                        <input type="number" x-model="ventDesign.feed.velocity" min="0.5" max="10" step="0.1" class="input-3d w-full p-3 rounded-lg border-0">
                                                                        <p class="text-xs text-gray-500 dark:text-gray-400 mt-1">محدوده بهینه: 2.2-2.5 m/s</p>
                                                                    </div>
                                                                    
                                                                    <div>
                                                                        <button @click="calculateFeedVent()" class="btn-primary w-full p-3 rounded-lg">
                                                                            محاسبه دریچه‌های رفت
                                                                        </button>
                                                                    </div>
                                                                    
                                                                    <div x-show="ventDesign.feed.calculated" class="p-4 bg-gradient-to-r from-blue-50 to-blue-100 dark:from-blue-900 dark:to-blue-800 rounded-lg">
                                                                        <h5 class="font-bold text-gray-800 dark:text-white mb-2">نتایج محاسبه دریچه رفت:</h5>
                                                                        <div class="space-y-2">
                                                                            <div class="flex justify-between">
                                                                                <span class="text-gray-600 dark:text-gray-300">سطح مقطع هر دریچه:</span>
                                                                                <span class="font-bold" x-text="ventDesign.feed.area.toFixed(3) + ' m²'"></span>
                                                                            </div>
                                                                            <div class="flex justify-between">
                                                                                <span class="text-gray-600 dark:text-gray-300">سطح مقطع کل:</span>
                                                                                <span class="font-bold" x-text="ventDesign.feed.totalArea.toFixed(2) + ' m²'"></span>
                                                                            </div>
                                                                            <div class="flex justify-between">
                                                                                <span class="text-gray-600 dark:text-gray-300">جریان هوا کل:</span>
                                                                                <span class="font-bold" x-text="ventDesign.feed.totalAirflow.toFixed(2) + ' m³/s'"></span>
                                                                            </div>
                                                                            <div class="flex justify-between">
                                                                                <span class="text-gray-600 dark:text-gray-300">نوع دریچه:</span>
                                                                                <span class="font-bold" x-text="ventDesign.feed.velocity > 5.6 ? 'نوع B با دیفیوزر' : 'نوع استاندارد'"></span>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            
                                                            <!-- Return Vents -->
                                                            <div>
                                                                <h4 class="font-bold text-gray-800 dark:text-white mb-4">دریچه‌های برگشت</h4>
                                                                
                                                                <div class="space-y-4">
                                                                    <div>
                                                                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">نوع دریچه برگشت</label>
                                                                        <select x-model="ventDesign.return.type" class="input-3d w-full p-3 rounded-lg border-0">
                                                                            <option value="narrow">نازک (عرض 5cm)</option>
                                                                            <option value="wide">پهن (عرض 50cm)</option>
                                                                        </select>
                                                                    </div>
                                                                    
                                                                    <div>
                                                                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">تعداد دریچه‌ها در هر کانال</label>
                                                                        <input type="number" x-model="ventDesign.return.countPerDuct" min="1" max="50" class="input-3d w-full p-3 rounded-lg border-0">
                                                                    </div>
                                                                    
                                                                    <div>
                                                                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">سرعت هوا در دریچه (m/s)</label>
                                                                        <input type="number" x-model="ventDesign.return.velocity" min="0.5" max="10" step="0.1" class="input-3d w-full p-3 rounded-lg border-0">
                                                                        <p class="text-xs text-gray-500 dark:text-gray-400 mt-1">محدوده بهینه: 3-3.5 m/s</p>
                                                                    </div>
                                                                    
                                                                    <div>
                                                                        <button @click="calculateReturnVent()" class="btn-secondary w-full p-3 rounded-lg">
                                                                            محاسبه دریچه‌های برگشت
                                                                        </button>
                                                                    </div>
                                                                    
                                                                    <div x-show="ventDesign.return.calculated" class="p-4 bg-gradient-to-r from-green-50 to-green-100 dark:from-green-900 dark:to-green-800 rounded-lg">
                                                                        <h5 class="font-bold text-gray-800 dark:text-white mb-2">نتایج محاسبه دریچه برگشت:</h5>
                                                                        <div class="space-y-2">
                                                                            <div class="flex justify-between">
                                                                                <span class="text-gray-600 dark:text-gray-300">عرض دریچه:</span>
                                                                                <span class="font-bold" x-text="ventDesign.return.width + ' m'"></span>
                                                                            </div>
                                                                            <div class="flex justify-between">
                                                                                <span class="text-gray-600 dark:text-gray-300">سطح مقطع هر دریچه:</span>
                                                                                <span class="font-bold" x-text="ventDesign.return.area.toFixed(3) + ' m²'"></span>
                                                                            </div>
                                                                            <div class="flex justify-between">
                                                                                <span class="text-gray-600 dark:text-gray-300">سطح مقطع کل:</span>
                                                                                <span class="font-bold" x-text="ventDesign.return.totalArea.toFixed(2) + ' m²'"></span>
                                                                            </div>
                                                                            <div class="flex justify-between">
                                                                                <span class="text-gray-600 dark:text-gray-300">تعداد کل دریچه‌ها:</span>
                                                                                <span class="font-bold" x-text="ventDesign.return.totalCount"></span>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                
                                                <!-- ARF Design Section -->
                                                <div x-show="acStationTab === 'arf'" x-transition>
                                                    <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6">
                                                        <h3 class="text-lg font-bold text-gray-800 dark:text-white mb-4">طراحی فیلتر دورانی (ARF)</h3>
                                                        <p class="text-gray-600 dark:text-gray-300 mb-6">طراحی فیلترهای دورانی بر اساس جریان هوا</p>
                                                        
                                                        <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-8">
                                                            <!-- ARF Selection -->
                                                            <div>
                                                                <h4 class="font-bold text-gray-800 dark:text-white mb-4">انتخاب فیلتر دورانی</h4>
                                                                
                                                                <div class="space-y-4">
                                                                    <div>
                                                                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">قطر فیلتر (m)</label>
                                                                        <select x-model="arfDesign.diameter" class="input-3d w-full p-3 rounded-lg border-0">
                                                                            <option value="2">2 متر</option>
                                                                            <option value="2.5">2.5 متر</option>
                                                                            <option value="3">3 متر</option>
                                                                        </select>
                                                                    </div>
                                                                    
                                                                    <div>
                                                                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">طول فیلتر (m)</label>
                                                                        <select x-model="arfDesign.length" class="input-3d w-full p-3 rounded-lg border-0">
                                                                            <option value="1.7">1.7 متر</option>
                                                                            <option value="3.4">3.4 متر</option>
                                                                            <option value="5.1">5.1 متر</option>
                                                                        </select>
                                                                    </div>
                                                                    
                                                                    <div>
                                                                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">تعداد فیلترها</label>
                                                                        <input type="number" x-model="arfDesign.count" min="1" max="20" class="input-3d w-full p-3 rounded-lg border-0">
                                                                    </div>
                                                                    
                                                                    <div>
                                                                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">سرعت هوا در فیلتر (m/s)</label>
                                                                        <input type="number" x-model="arfDesign.velocity" min="0.5" max="2" step="0.01" class="input-3d w-full p-3 rounded-lg border-0">
                                                                        <p class="text-xs text-gray-500 dark:text-gray-400 mt-1">محدوده بهینه: 1-1.22 m/s</p>
                                                                    </div>
                                                                    
                                                                    <div>
                                                                        <button @click="calculateARF()" class="btn-primary w-full p-3 rounded-lg">
                                                                            محاسبه فیلتر دورانی
                                                                        </button>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            
                                                            <!-- ARF Results -->
                                                            <div>
                                                                <h4 class="font-bold text-gray-800 dark:text-white mb-4">نتایج محاسبات</h4>
                                                                
                                                                <div x-show="arfDesign.calculated" class="p-6 bg-gradient-to-r from-purple-50 to-purple-100 dark:from-purple-900 dark:to-purple-800 rounded-xl">
                                                                    <div class="space-y-4">
                                                                        <div class="flex justify-between items-center">
                                                                            <span class="text-gray-600 dark:text-gray-300">سطح هر فیلتر:</span>
                                                                            <span class="text-xl font-bold text-gray-800 dark:text-white" x-text="arfDesign.area.toFixed(2) + ' m²'"></span>
                                                                        </div>
                                                                        
                                                                        <div class="flex justify-between items-center">
                                                                            <span class="text-gray-600 dark:text-gray-300">سطح کل فیلترها:</span>
                                                                            <span class="text-xl font-bold text-gray-800 dark:text-white" x-text="arfDesign.totalArea.toFixed(2) + ' m²'"></span>
                                                                        </div>
                                                                        
                                                                        <div class="flex justify-between items-center">
                                                                            <span class="text-gray-600 dark:text-gray-300">جریان هوای قابل عبور:</span>
                                                                            <span class="text-xl font-bold text-gray-800 dark:text-white" x-text="arfDesign.totalAirflow.toFixed(2) + ' m³/s'"></span>
                                                                        </div>
                                                                        
                                                                        <div class="flex justify-between items-center">
                                                                            <span class="text-gray-600 dark:text-gray-300">سرعت واقعی هوا:</span>
                                                                            <span class="text-xl font-bold text-gray-800 dark:text-white" x-text="arfDesign.actualVelocity.toFixed(2) + ' m/s'"></span>
                                                                        </div>
                                                                        
                                                                        <div class="mt-6 pt-4 border-t border-purple-200 dark:border-purple-700">
                                                                            <div class="flex items-center">
                                                                                <div class="w-10 h-10 rounded-lg bg-gradient-to-r from-purple-500 to-purple-600 flex items-center justify-center text-white ml-3">
                                                                                    <i class="fas fa-check"></i>
                                                                                </div>
                                                                                <div>
                                                                                    <p class="font-bold text-gray-800 dark:text-white" x-text="arfDesign.actualVelocity <= 1.22 ? 'سرعت هوا مناسب است' : 'سرعت هوا زیاد است'"></p>
                                                                                    <p class="text-sm text-gray-600 dark:text-gray-300" x-text="arfDesign.actualVelocity <= 1.22 ? 'فیلترهای انتخابی مناسب هستند' : 'لطفا تعداد فیلترها را افزایش دهید'"></p>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                
                                                                <div x-show="!arfDesign.calculated" class="p-6 bg-gradient-to-r from-gray-50 to-gray-100 dark:from-gray-700 dark:to-gray-800 rounded-xl flex items-center justify-center h-full">
                                                                    <div class="text-center">
                                                                        <i class="fas fa-filter text-4xl text-gray-400 mb-4"></i>
                                                                        <p class="text-gray-600 dark:text-gray-300">لطفا مقادیر را وارد و محاسبه کنید</p>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        
                                                        <!-- Dust Collector -->
                                                        <div class="bg-gradient-to-r from-blue-50 to-blue-100 dark:from-blue-900 dark:to-blue-800 rounded-xl p-6">
                                                            <h4 class="font-bold text-gray-800 dark:text-white mb-4">سیستم جمع‌آوری گرد و غبار</h4>
                                                            <p class="text-gray-600 dark:text-gray-300 mb-4">هر فیلتر دورانی دارای یک پکیج جمع‌آوری گرد و غبار شامل:</p>
                                                            
                                                            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                                                                <div class="component-item">
                                                                    <div class="component-icon">
                                                                        <i class="fas fa-fan"></i>
                                                                    </div>
                                                                    <p class="font-bold">فن گرد و غبار</p>
                                                                    <p class="text-sm text-gray-600 dark:text-gray-300">2 عدد 3.3 کیلووات</p>
                                                                </div>
                                                                
                                                                <div class="component-item">
                                                                    <div class="component-icon">
                                                                        <i class="fas fa-broom"></i>
                                                                    </div>
                                                                    <p class="font-bold">برس تمیزکننده</p>
                                                                    <p class="text-sm text-gray-600 dark:text-gray-300">1 عدد</p>
                                                                </div>
                                                                
                                                                <div class="component-item">
                                                                    <div class="component-icon">
                                                                        <i class="fas fa-road"></i>
                                                                    </div>
                                                                    <p class="font-bold">کانال</p>
                                                                    <p class="text-sm text-gray-600 dark:text-gray-300">1 عدد به ازای هر 1.7 متر</p>
                                                                </div>
                                                                
                                                                <div class="component-item">
                                                                    <div class="component-icon">
                                                                        <i class="fas fa-cogs"></i>
                                                                    </div>
                                                                    <p class="font-bold">مکانیزم</p>
                                                                    <p class="text-sm text-gray-600 dark:text-gray-300">موتور 100 وات با گیربکس</p>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                
                                                <!-- Damper Design Section -->
                                                <div x-show="acStationTab === 'damper'" x-transition>
                                                    <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6">
                                                        <h3 class="text-lg font-bold text-gray-800 dark:text-white mb-4">طراحی دمپرها</h3>
                                                        <p class="text-gray-600 dark:text-gray-300 mb-6">طراحی دمپرهای تازه، تخلیه و برگشت</p>
                                                        
                                                        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                                                            <!-- Fresh Damper -->
                                                            <div class="bg-gradient-to-r from-green-50 to-green-100 dark:from-green-900 dark:to-green-800 rounded-xl p-6">
                                                                <h4 class="font-bold text-gray-800 dark:text-white mb-4">دمپر هوای تازه</h4>
                                                                
                                                                <div class="space-y-3">
                                                                    <div>
                                                                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">تعداد دمپر</label>
                                                                        <input type="number" x-model="damperDesign.fresh.count" min="1" max="20" class="input-3d w-full p-2 rounded-lg border-0">
                                                                    </div>
                                                                    
                                                                    <div>
                                                                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">عرض (m)</label>
                                                                        <input type="number" x-model="damperDesign.fresh.width" min="0.1" max="5" step="0.1" class="input-3d w-full p-2 rounded-lg border-0">
                                                                    </div>
                                                                    
                                                                    <div>
                                                                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">ارتفاع (m)</label>
                                                                        <input type="number" x-model="damperDesign.fresh.height" min="0.1" max="5" step="0.1" class="input-3d w-full p-2 rounded-lg border-0">
                                                                    </div>
                                                                    
                                                                    <div>
                                                                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">ولتاژ کنترل</label>
                                                                        <select x-model="damperDesign.fresh.voltage" class="input-3d w-full p-2 rounded-lg border-0">
                                                                            <option value="24">24 VDC</option>
                                                                            <option value="220">220 VAC</option>
                                                                        </select>
                                                                    </div>
                                                                    
                                                                    <div class="pt-3">
                                                                        <div class="flex justify-between">
                                                                            <span class="text-gray-600 dark:text-gray-300">سطح موثر:</span>
                                                                            <span class="font-bold" x-text="(damperDesign.fresh.width * damperDesign.fresh.height * damperDesign.fresh.count * 0.92).toFixed(2) + ' m²'"></span>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            
                                                            <!-- Exhaust Damper -->
                                                            <div class="bg-gradient-to-r from-red-50 to-red-100 dark:from-red-900 dark:to-red-800 rounded-xl p-6">
                                                                <h4 class="font-bold text-gray-800 dark:text-white mb-4">دمپر تخلیه</h4>
                                                                
                                                                <div class="space-y-3">
                                                                    <div>
                                                                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">تعداد دمپر</label>
                                                                        <input type="number" x-model="damperDesign.exhaust.count" min="1" max="20" class="input-3d w-full p-2 rounded-lg border-0">
                                                                    </div>
                                                                    
                                                                    <div>
                                                                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">عرض (m)</label>
                                                                        <input type="number" x-model="damperDesign.exhaust.width" min="0.1" max="5" step="0.1" class="input-3d w-full p-2 rounded-lg border-0">
                                                                    </div>
                                                                    
                                                                    <div>
                                                                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">ارتفاع (m)</label>
                                                                        <input type="number" x-model="damperDesign.exhaust.height" min="0.1" max="5" step="0.1" class="input-3d w-full p-2 rounded-lg border-0">
                                                                    </div>
                                                                    
                                                                    <div>
                                                                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">ولتاژ کنترل</label>
                                                                        <select x-model="damperDesign.exhaust.voltage" class="input-3d w-full p-2 rounded-lg border-0">
                                                                            <option value="24">24 VDC</option>
                                                                            <option value="220">220 VAC</option>
                                                                        </select>
                                                                    </div>
                                                                    
                                                                    <div class="pt-3">
                                                                        <div class="flex justify-between">
                                                                            <span class="text-gray-600 dark:text-gray-300">سطح موثر:</span>
                                                                            <span class="font-bold" x-text="(damperDesign.exhaust.width * damperDesign.exhaust.height * damperDesign.exhaust.count * 0.92).toFixed(2) + ' m²'"></span>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            
                                                            <!-- Return Damper -->
                                                            <div class="bg-gradient-to-r from-blue-50 to-blue-100 dark:from-blue-900 dark:to-blue-800 rounded-xl p-6">
                                                                <h4 class="font-bold text-gray-800 dark:text-white mb-4">دمپر برگشت</h4>
                                                                
                                                                <div class="space-y-3">
                                                                    <div>
                                                                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">تعداد دمپر</label>
                                                                        <input type="number" x-model="damperDesign.return.count" min="1" max="20" class="input-3d w-full p-2 rounded-lg border-0">
                                                                    </div>
                                                                    
                                                                    <div>
                                                                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">عرض (m)</label>
                                                                        <input type="number" x-model="damperDesign.return.width" min="0.1" max="5" step="0.1" class="input-3d w-full p-2 rounded-lg border-0">
                                                                    </div>
                                                                    
                                                                    <div>
                                                                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">ارتفاع (m)</label>
                                                                        <input type="number" x-model="damperDesign.return.height" min="0.1" max="5" step="0.1" class="input-3d w-full p-2 rounded-lg border-0">
                                                                    </div>
                                                                    
                                                                    <div>
                                                                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">ولتاژ کنترل</label>
                                                                        <select x-model="damperDesign.return.voltage" class="input-3d w-full p-2 rounded-lg border-0">
                                                                            <option value="24">24 VDC</option>
                                                                            <option value="220">220 VAC</option>
                                                                        </select>
                                                                    </div>
                                                                    
                                                                    <div class="pt-3">
                                                                        <div class="flex justify-between">
                                                                            <span class="text-gray-600 dark:text-gray-300">سطح موثر:</span>
                                                                            <span class="font-bold" x-text="(damperDesign.return.width * damperDesign.return.height * damperDesign.return.count * 0.92).toFixed(2) + ' m²'"></span>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        
                                                        <!-- Damper Calculations -->
                                                        <div class="bg-gradient-to-r from-purple-50 to-purple-100 dark:from-purple-900 dark:to-purple-800 rounded-xl p-6">
                                                            <h4 class="font-bold text-gray-800 dark:text-white mb-4">محاسبات دمپرها</h4>
                                                            
                                                            <div class="space-y-4">
                                                                <div>
                                                                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">سرعت هوا در دمپر (m/s)</label>
                                                                    <input type="number" x-model="damperDesign.velocity" min="0.5" max="10" step="0.1" class="input-3d w-full p-3 rounded-lg border-0">
                                                                    <p class="text-xs text-gray-500 dark:text-gray-400 mt-1">محدوده بهینه: 5.8-6.6 m/s</p>
                                                                </div>
                                                                
                                                                <button @click="calculateDampers()" class="btn-primary w-full p-3 rounded-lg">
                                                                    محاسبه جریان هوا در دمپرها
                                                                </button>
                                                                
                                                                <div x-show="damperDesign.calculated" class="p-4 bg-white dark:bg-gray-800 rounded-lg">
                                                                    <h5 class="font-bold text-gray-800 dark:text-white mb-2">نتایج محاسبات:</h5>
                                                                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                                                        <div class="text-center p-3 bg-gradient-to-r from-green-50 to-green-100 dark:from-green-900 dark:to-green-800 rounded-lg">
                                                                            <p class="text-sm text-gray-600 dark:text-gray-300">دمپر تازه</p>
                                                                            <p class="text-xl font-bold text-gray-800 dark:text-white" x-text="damperDesign.fresh.airflow.toFixed(2) + ' m³/s'"></p>
                                                                            <p class="text-xs text-gray-600 dark:text-gray-300" x-text="damperDesign.fresh.airflow <= 6.6 ? 'سرعت مناسب' : 'سرعت زیاد'"></p>
                                                                        </div>
                                                                        
                                                                        <div class="text-center p-3 bg-gradient-to-r from-red-50 to-red-100 dark:from-red-900 dark:to-red-800 rounded-lg">
                                                                            <p class="text-sm text-gray-600 dark:text-gray-300">دمپر تخلیه</p>
                                                                            <p class="text-xl font-bold text-gray-800 dark:text-white" x-text="damperDesign.exhaust.airflow.toFixed(2) + ' m³/s'"></p>
                                                                            <p class="text-xs text-gray-600 dark:text-gray-300" x-text="damperDesign.exhaust.airflow <= 6.6 ? 'سرعت مناسب' : 'سرعت زیاد'"></p>
                                                                        </div>
                                                                        
                                                                        <div class="text-center p-3 bg-gradient-to-r from-blue-50 to-blue-100 dark:from-blue-900 dark:to-blue-800 rounded-lg">
                                                                            <p class="text-sm text-gray-600 dark:text-gray-300">دمپر برگشت</p>
                                                                            <p class="text-xl font-bold text-gray-800 dark:text-white" x-text="damperDesign.return.airflow.toFixed(2) + ' m³/s'"></p>
                                                                            <p class="text-xs text-gray-600 dark:text-gray-300" x-text="damperDesign.return.airflow <= 6.6 ? 'سرعت مناسب' : 'سرعت زیاد'"></p>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                
                                                <!-- Heating Coil Design Section -->
                                                <div x-show="acStationTab === 'coil'" x-transition>
                                                    <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6">
                                                        <h3 class="text-lg font-bold text-gray-800 dark:text-white mb-4">طراحی کویل گرمایش</h3>
                                                        <p class="text-gray-600 dark:text-gray-300 mb-6">طراحی کویل گرمایش با بخار</p>
                                                        
                                                        <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                                                            <!-- Coil Specifications -->
                                                            <div>
                                                                <h4 class="font-bold text-gray-800 dark:text-white mb-4">مشخصات کویل</h4>
                                                                
                                                                <div class="space-y-4">
                                                                    <div>
                                                                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">تعداد ردیف کویل</label>
                                                                        <select x-model="coilDesign.rows" class="input-3d w-full p-3 rounded-lg border-0">
                                                                            <option value="1">1 ردیف</option>
                                                                            <option value="2">2 ردیف</option>
                                                                            <option value="3">3 ردیف</option>
                                                                        </select>
                                                                    </div>
                                                                    
                                                                    <div>
                                                                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">ارتفاع کویل (m)</label>
                                                                        <input type="number" x-model="coilDesign.height" min="0.5" max="1.52" step="0.01" class="input-3d w-full p-3 rounded-lg border-0">
                                                                        <p class="text-xs text-gray-500 dark:text-gray-400 mt-1">حداکثر ارتفاع: 1.52 متر</p>
                                                                    </div>
                                                                    
                                                                    <div>
                                                                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">عرض کویل (m)</label>
                                                                        <input type="number" x-model="coilDesign.width" min="0.5" max="5" step="0.1" class="input-3d w-full p-3 rounded-lg border-0">
                                                                    </div>
                                                                    
                                                                    <div>
                                                                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">دمای ورودی هوا (°C)</label>
                                                                        <input type="number" x-model="coilDesign.inletTemp" min="-10" max="50" step="0.5" class="input-3d w-full p-3 rounded-lg border-0">
                                                                    </div>
                                                                    
                                                                    <div>
                                                                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">دمای خروجی هوا (°C)</label>
                                                                        <input type="number" x-model="coilDesign.outletTemp" min="0" max="80" step="0.5" class="input-3d w-full p-3 rounded-lg border-0">
                                                                    </div>
                                                                    
                                                                    <div>
                                                                        <button @click="calculateCoil()" class="btn-primary w-full p-3 rounded-lg">
                                                                            محاسبه کویل گرمایش
                                                                        </button>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            
                                                            <!-- Coil Results -->
                                                            <div>
                                                                <h4 class="font-bold text-gray-800 dark:text-white mb-4">نتایج محاسبات</h4>
                                                                
                                                                <div x-show="coilDesign.calculated" class="p-6 bg-gradient-to-r from-red-50 to-red-100 dark:from-red-900 dark:to-red-800 rounded-xl">
                                                                    <div class="space-y-4">
                                                                        <div class="flex justify-between items-center">
                                                                            <span class="text-gray-600 dark:text-gray-300">سطح کویل:</span>
                                                                            <span class="text-xl font-bold text-gray-800 dark:text-white" x-text="coilDesign.area.toFixed(2) + ' m²'"></span>
                                                                        </div>
                                                                        
                                                                        <div class="flex justify-between items-center">
                                                                            <span class="text-gray-600 dark:text-gray-300">بار حرارتی:</span>
                                                                            <span class="text-xl font-bold text-gray-800 dark:text-white" x-text="coilDesign.heatingLoad.toFixed(0) + ' kW'"></span>
                                                                        </div>
                                                                        
                                                                        <div class="flex justify-between items-center">
                                                                            <span class="text-gray-600 dark:text-gray-300">مصرف بخار:</span>
                                                                            <span class="text-xl font-bold text-gray-800 dark:text-white" x-text="coilDesign.steamConsumption.toFixed(1) + ' kg/h'"></span>
                                                                        </div>
                                                                        
                                                                        <div class="flex justify-between items-center">
                                                                            <span class="text-gray-600 dark:text-gray-300">افت فشار هوا:</span>
                                                                            <span class="text-xl font-bold text-gray-800 dark:text-white" x-text="coilDesign.pressureDrop.toFixed(0) + ' Pa'"></span>
                                                                        </div>
                                                                        
                                                                        <div class="mt-6 pt-4 border-t border-red-200 dark:border-red-700">
                                                                            <div class="flex items-center">
                                                                                <div class="w-10 h-10 rounded-lg bg-gradient-to-r from-red-500 to-red-600 flex items-center justify-center text-white ml-3">
                                                                                    <i class="fas fa-fire"></i>
                                                                                </div>
                                                                                <div>
                                                                                    <p class="font-bold text-gray-800 dark:text-white">سازگاری با دمپر برگشت</p>
                                                                                    <p class="text-sm text-gray-600 dark:text-gray-300" x-text="coilDesign.height <= 1.52 ? 'ارتفاع کویل مناسب است' : 'ارتفاع کویل باید کاهش یابد'"></p>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                
                                                                <div x-show="!coilDesign.calculated" class="p-6 bg-gradient-to-r from-gray-50 to-gray-100 dark:from-gray-700 dark:to-gray-800 rounded-xl flex items-center justify-center h-full">
                                                                    <div class="text-center">
                                                                        <i class="fas fa-fire text-4xl text-gray-400 mb-4"></i>
                                                                        <p class="text-gray-600 dark:text-gray-300">لطفا مقادیر را وارد و محاسبه کنید</p>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                
                                                <!-- AirWasher Design Section -->
                                                <div x-show="acStationTab === 'airwasher'" x-transition>
                                                    <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6">
                                                        <h3 class="text-lg font-bold text-gray-800 dark:text-white mb-4">طراحی ایرواشر</h3>
                                                        <p class="text-gray-600 dark:text-gray-300 mb-6">طراحی کامل ایرواشر با نازل‌ها، رایزرها و پمپ آب</p>
                                                        
                                                        <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-8">
                                                            <!-- AirWasher Specifications -->
                                                            <div>
                                                                <h4 class="font-bold text-gray-800 dark:text-white mb-4">مشخصات ایرواشر</h4>
                                                                
                                                                <div class="space-y-4">
                                                                    <div>
                                                                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">ارتفاع ایرواشر (m)</label>
                                                                        <input type="number" x-model="airwasherDesign.height" min="1" max="5" step="0.1" class="input-3d w-full p-3 rounded-lg border-0">
                                                                    </div>
                                                                    
                                                                    <div>
                                                                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">عرض ایرواشر (m)</label>
                                                                        <input type="number" x-model="airwasherDesign.width" min="1" max="10" step="0.1" class="input-3d w-full p-3 rounded-lg border-0">
                                                                    </div>
                                                                    
                                                                    <div>
                                                                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">تعداد زون‌ها</label>
                                                                        <input type="number" x-model="airwasherDesign.zones" min="1" max="5" class="input-3d w-full p-3 rounded-lg border-0" value="2">
                                                                        <p class="text-xs text-gray-500 dark:text-gray-400 mt-1">پیش‌فرض: 2 زون</p>
                                                                    </div>
                                                                    
                                                                    <div>
                                                                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">قطر کلکتور (اینچ)</label>
                                                                        <input type="number" x-model="airwasherDesign.collectorDiameter" min="2" max="8" step="0.5" class="input-3d w-full p-3 rounded-lg border-0" value="4">
                                                                        <p class="text-xs text-gray-500 dark:text-gray-400 mt-1">پیش‌فرض: 4 اینچ</p>
                                                                    </div>
                                                                    
                                                                    <div>
                                                                        <button @click="calculateAirwasher()" class="btn-primary w-full p-3 rounded-lg">
                                                                            محاسبه ایرواشر
                                                                        </button>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            
                                                            <!-- AirWasher Results -->
                                                            <div>
                                                                <h4 class="font-bold text-gray-800 dark:text-white mb-4">نتایج محاسبات</h4>
                                                                
                                                                <div x-show="airwasherDesign.calculated" class="p-6 bg-gradient-to-r from-blue-50 to-blue-100 dark:from-blue-900 dark:to-blue-800 rounded-xl">
                                                                    <div class="space-y-4">
                                                                        <div class="flex justify-between items-center">
                                                                            <span class="text-gray-600 dark:text-gray-300">سطح ایرواشر:</span>
                                                                            <span class="text-xl font-bold text-gray-800 dark:text-white" x-text="airwasherDesign.area.toFixed(2) + ' m²'"></span>
                                                                        </div>
                                                                        
                                                                        <div class="flex justify-between items-center">
                                                                            <span class="text-gray-600 dark:text-gray-300">سرعت هوا:</span>
                                                                            <span class="text-xl font-bold text-gray-800 dark:text-white" x-text="airwasherDesign.velocity.toFixed(2) + ' m/s'"></span>
                                                                        </div>
                                                                        
                                                                        <div class="flex justify-between items-center">
                                                                            <span class="text-gray-600 dark:text-gray-300">تعداد کل نازل‌ها:</span>
                                                                            <span class="text-xl font-bold text-gray-800 dark:text-white" x-text="airwasherDesign.totalNozzles"></span>
                                                                        </div>
                                                                        
                                                                        <div class="flex justify-between items-center">
                                                                            <span class="text-gray-600 dark:text-gray-300">دبی آب کل:</span>
                                                                            <span class="text-xl font-bold text-gray-800 dark:text-white" x-text="airwasherDesign.totalWaterFlow.toFixed(1) + ' L/min'"></span>
                                                                        </div>
                                                                        
                                                                        <div class="mt-6 pt-4 border-t border-blue-200 dark:border-blue-700">
                                                                            <div class="flex items-center">
                                                                                <div class="w-10 h-10 rounded-lg bg-gradient-to-r from-blue-500 to-blue-600 flex items-center justify-center text-white ml-3">
                                                                                    <i class="fas fa-tachometer-alt"></i>
                                                                                </div>
                                                                                <div>
                                                                                    <p class="font-bold text-gray-800 dark:text-white" x-text="airwasherDesign.velocity <= 3.8 ? 'سرعت هوا مناسب است' : 'سرعت هوا زیاد است'"></p>
                                                                                    <p class="text-sm text-gray-600 dark:text-gray-300">محدوده بهینه: 3.44-3.8 m/s</p>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                
                                                                <div x-show="!airwasherDesign.calculated" class="p-6 bg-gradient-to-r from-gray-50 to-gray-100 dark:from-gray-700 dark:to-gray-800 rounded-xl flex items-center justify-center h-full">
                                                                    <div class="text-center">
                                                                        <i class="fas fa-shower text-4xl text-gray-400 mb-4"></i>
                                                                        <p class="text-gray-600 dark:text-gray-300">لطفا مقادیر را وارد و محاسبه کنید</p>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        
                                                        <!-- Pump Calculation -->
                                                        <div class="bg-gradient-to-r from-green-50 to-green-100 dark:from-green-900 dark:to-green-800 rounded-xl p-6">
                                                            <h4 class="font-bold text-gray-800 dark:text-white mb-4">محاسبات پمپ آب</h4>
                                                            
                                                            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                                                                <div>
                                                                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">هد پمپ (m)</label>
                                                                    <input type="number" x-model="airwasherDesign.pumpHead" min="10" max="100" step="1" class="input-3d w-full p-3 rounded-lg border-0" value="35">
                                                                    <p class="text-xs text-gray-500 dark:text-gray-400 mt-1">پیش‌فرض: 35 متر</p>
                                                                </div>
                                                                
                                                                <div>
                                                                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">راندمان پمپ (%)</label>
                                                                    <input type="number" x-model="airwasherDesign.pumpEfficiency" min="50" max="95" step="1" class="input-3d w-full p-3 rounded-lg border-0" value="75">
                                                                </div>
                                                                
                                                                <div>
                                                                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">قطر لوله (mm)</label>
                                                                    <select x-model="airwasherDesign.pipeDiameter" class="input-3d w-full p-3 rounded-lg border-0">
                                                                        <option value="50">50 mm</option>
                                                                        <option value="65">65 mm</option>
                                                                        <option value="80">80 mm</option>
                                                                        <option value="100">100 mm</option>
                                                                    </select>
                                                                </div>
                                                            </div>
                                                            
                                                            <button @click="calculatePump()" class="btn-success w-full p-3 rounded-lg mt-6">
                                                                محاسبه توان پمپ
                                                            </button>
                                                            
                                                            <div x-show="airwasherDesign.pumpCalculated" class="p-4 bg-white dark:bg-gray-800 rounded-lg mt-4">
                                                                <div class="grid grid-cols-2 gap-4">
                                                                    <div>
                                                                        <p class="text-sm text-gray-600 dark:text-gray-300">توان پمپ:</p>
                                                                        <p class="text-xl font-bold text-gray-800 dark:text-white" x-text="airwasherDesign.pumpPower.toFixed(2) + ' kW'"></p>
                                                                    </div>
                                                                    
                                                                    <div>
                                                                        <p class="text-sm text-gray-600 dark:text-gray-300">قطر لوله انتخاب شده:</p>
                                                                        <p class="text-xl font-bold text-gray-800 dark:text-white" x-text="airwasherDesign.pipeDiameter + ' mm'"></p>
                                                                    </div>
                                                                    
                                                                    <div class="col-span-2">
                                                                        <p class="text-sm text-gray-600 dark:text-gray-300">پیشنهاد انتخاب:</p>
                                                                        <p class="text-gray-800 dark:text-white" x-text="airwasherDesign.pumpSuggestion"></p>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                
                                                <!-- Fan Design Section -->
                                                <div x-show="acStationTab === 'fan'" x-transition>
                                                    <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6">
                                                        <h3 class="text-lg font-bold text-gray-800 dark:text-white mb-4">طراحی فن‌ها</h3>
                                                        <p class="text-gray-600 dark:text-gray-300 mb-6">طراحی فن‌های رفت و برگشت</p>
                                                        
                                                        <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                                                            <!-- Fan Selection -->
                                                            <div>
                                                                <h4 class="font-bold text-gray-800 dark:text-white mb-4">انتخاب فن</h4>
                                                                
                                                                <div class="space-y-4">
                                                                    <div>
                                                                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">نوع فن</label>
                                                                        <select x-model="fanDesign.type" class="input-3d w-full p-3 rounded-lg border-0">
                                                                            <option value="axial">آکسیال (Luwa)</option>
                                                                            <option value="centrifugal">سانتریفیوژ</option>
                                                                            <option value="vane-axial">وان آکسیال</option>
                                                                        </select>
                                                                    </div>
                                                                    
                                                                    <div>
                                                                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">قطر فن (mm)</label>
                                                                        <select x-model="fanDesign.diameter" class="input-3d w-full p-3 rounded-lg border-0">
                                                                            <option value="1400">1400 mm</option>
                                                                            <option value="1600">1600 mm</option>
                                                                            <option value="1800">1800 mm</option>
                                                                            <option value="2000">2000 mm</option>
                                                                        </select>
                                                                    </div>
                                                                    
                                                                    <div>
                                                                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">تعداد پره</label>
                                                                        <input type="number" x-model="fanDesign.blades" min="4" max="16" class="input-3d w-full p-3 rounded-lg border-0" value="10">
                                                                    </div>
                                                                    
                                                                    <div>
                                                                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">سرعت چرخش (RPM)</label>
                                                                        <input type="number" x-model="fanDesign.rpm" min="500" max="1500" step="50" class="input-3d w-full p-3 rounded-lg border-0" value="1000">
                                                                    </div>
                                                                    
                                                                    <div>
                                                                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">افت فشار کل (Pa)</label>
                                                                        <input type="number" x-model="fanDesign.totalPressure" min="100" max="2000" step="10" class="input-3d w-full p-3 rounded-lg border-0">
                                                                    </div>
                                                                    
                                                                    <div>
                                                                        <button @click="calculateFan()" class="btn-primary w-full p-3 rounded-lg">
                                                                            محاسبه فن
                                                                        </button>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            
                                                            <!-- Fan Results -->
                                                            <div>
                                                                <h4 class="font-bold text-gray-800 dark:text-white mb-4">نتایج محاسبات</h4>
                                                                
                                                                <div x-show="fanDesign.calculated" class="p-6 bg-gradient-to-r from-blue-50 to-blue-100 dark:from-blue-900 dark:to-blue-800 rounded-xl">
                                                                    <div class="space-y-4">
                                                                        <div class="flex justify-between items-center">
                                                                            <span class="text-gray-600 dark:text-gray-300">توان فن:</span>
                                                                            <span class="text-xl font-bold text-gray-800 dark:text-white" x-text="fanDesign.power.toFixed(2) + ' kW'"></span>
                                                                        </div>
                                                                        
                                                                        <div class="flex justify-between items-center">
                                                                            <span class="text-gray-600 dark:text-gray-300">جریان هوا:</span>
                                                                            <span class="text-xl font-bold text-gray-800 dark:text-white" x-text="fanDesign.airflow.toFixed(2) + ' m³/s'"></span>
                                                                        </div>
                                                                        
                                                                        <div class="flex justify-between items-center">
                                                                            <span class="text-gray-600 dark:text-gray-300">راندمان فن:</span>
                                                                            <span class="text-xl font-bold text-gray-800 dark:text-white" x-text="fanDesign.efficiency.toFixed(1) + ' %'"></span>
                                                                        </div>
                                                                        
                                                                        <div class="flex justify-between items-center">
                                                                            <span class="text-gray-600 dark:text-gray-300">سرعت نوک پره:</span>
                                                                            <span class="text-xl font-bold text-gray-800 dark:text-white" x-text="fanDesign.tipSpeed.toFixed(1) + ' m/s'"></span>
                                                                        </div>
                                                                        
                                                                        <div class="mt-6 pt-4 border-t border-blue-200 dark:border-blue-700">
                                                                            <div class="flex items-center">
                                                                                <div class="w-10 h-10 rounded-lg bg-gradient-to-r from-blue-500 to-blue-600 flex items-center justify-center text-white ml-3">
                                                                                    <i class="fas fa-fan"></i>
                                                                                </div>
                                                                                <div>
                                                                                    <p class="font-bold text-gray-800 dark:text-white">پیشنهاد موتور</p>
                                                                                    <p class="text-sm text-gray-600 dark:text-gray-300" x-text="fanDesign.motorSuggestion"></p>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                
                                                                <div x-show="!fanDesign.calculated" class="p-6 bg-gradient-to-r from-gray-50 to-gray-100 dark:from-gray-700 dark:to-gray-800 rounded-xl flex items-center justify-center h-full">
                                                                    <div class="text-center">
                                                                        <i class="fas fa-fan text-4xl text-gray-400 mb-4"></i>
                                                                        <p class="text-gray-600 dark:text-gray-300">لطفا مقادیر را وارد و محاسبه کنید</p>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        
                                                        <!-- Fan Graphs -->
                                                        <div class="mt-8">
                                                            <h4 class="font-bold text-gray-800 dark:text-white mb-4">منحنی‌های عملکرد فن</h4>
                                                            <div class="bg-gradient-to-r from-gray-50 to-gray-100 dark:from-gray-700 dark:to-gray-800 rounded-xl p-6">
                                                                <div class="flex flex-col md:flex-row items-center justify-between">
                                                                    <div class="md:w-1/3 mb-6 md:mb-0">
                                                                        <h5 class="font-bold text-gray-800 dark:text-white mb-2">نمودار عملکرد</h5>
                                                                        <p class="text-sm text-gray-600 dark:text-gray-300">منحنی فشار-دبی فن انتخاب شده</p>
                                                                    </div>
                                                                    
                                                                    <div class="md:w-2/3">
                                                                        <div class="bg-white dark:bg-gray-800 rounded-lg p-4">
                                                                            <div class="flex items-center justify-center h-64">
                                                                                <div class="text-center">
                                                                                    <div class="relative w-64 h-48 mx-auto">
                                                                                        <!-- Simple fan curve visualization -->
                                                                                        <div class="absolute inset-0 border border-gray-300 dark:border-gray-600 rounded"></div>
                                                                                        <div class="absolute bottom-0 left-0 w-full h-px bg-gray-300 dark:bg-gray-600"></div>
                                                                                        <div class="absolute bottom-0 left-0 h-full w-px bg-gray-300 dark:bg-gray-600"></div>
                                                                                        
                                                                                        <!-- Pressure labels -->
                                                                                        <div class="absolute top-0 left-0 text-xs text-gray-500">Pa</div>
                                                                                        <div class="absolute top-0 right-0 text-xs text-gray-500">2500</div>
                                                                                        <div class="absolute top-1/4 right-0 text-xs text-gray-500">2000</div>
                                                                                        <div class="absolute top-2/4 right-0 text-xs text-gray-500">1500</div>
                                                                                        <div class="absolute top-3/4 right-0 text-xs text-gray-500">1000</div>
                                                                                        <div class="absolute bottom-0 right-0 text-xs text-gray-500">500</div>
                                                                                        
                                                                                        <!-- Flow labels -->
                                                                                        <div class="absolute bottom-0 left-0 text-xs text-gray-500">0</div>
                                                                                        <div class="absolute bottom-0 left-1/4 text-xs text-gray-500">5</div>
                                                                                        <div class="absolute bottom-0 left-2/4 text-xs text-gray-500">10</div>
                                                                                        <div class="absolute bottom-0 left-3/4 text-xs text-gray-500">15</div>
                                                                                        <div class="absolute bottom-0 right-0 text-xs text-gray-500">m³/s</div>
                                                                                        
                                                                                        <!-- Fan curve line -->
                                                                                        <svg class="absolute inset-0 w-full h-full" viewBox="0 0 100 100" preserveAspectRatio="none">
                                                                                            <path d="M0,100 Q25,80 50,60 T100,20" stroke="#3b82f6" stroke-width="2" fill="none"/>
                                                                                            
                                                                                            <!-- Operating point -->
                                                                                            <circle cx="50" cy="60" r="4" fill="#ef4444"/>
                                                                                            <text x="55" y="60" fill="#ef4444" font-size="8">OP</text>
                                                                                        </svg>
                                                                                    </div>
                                                                                    <p class="text-sm text-gray-600 dark:text-gray-300 mt-2">نقطه کارکرد: <span x-text="fanDesign.airflow.toFixed(2) + ' m³/s @ ' + fanDesign.totalPressure + ' Pa'"></span></p>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <!-- PLC Design -->
                                        <div x-show="activeTab === 'plc'" x-transition>
                                            <div class="mb-8">
                                                <div class="flex items-center justify-between">
                                                    <h2 class="text-2xl font-bold text-gray-800 dark:text-white">طراحی سیستم PLC</h2>
                                                    <div class="flex space-x-3 space-x-reverse">
                                                        <button @click="showPLCModal = true" class="btn-primary px-6 py-3 rounded-lg flex items-center">
                                                            <i class="fas fa-plus ml-2"></i>
                                                            پروژه PLC جدید
                                                        </button>
                                                        <button @click="generatePLCCode()" class="btn-success px-6 py-3 rounded-lg flex items-center">
                                                            <i class="fas fa-code ml-2"></i>
                                                            تولید کد
                                                        </button>
                                                    </div>
                                                </div>
                                                <p class="text-gray-600 dark:text-gray-300 mt-2">طراحی سیستم کنترل PLC برای ایستگاه تهویه</p>
                                            </div>
                                            
                                            <!-- PLC Templates -->
                                            <div class="mb-8">
                                                <h3 class="text-lg font-bold text-gray-800 dark:text-white mb-4">تمپلیت‌های PLC آماده</h3>
                                                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                                                    <div class="component-3d bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 text-center cursor-pointer hover:border-2 hover:border-blue-500"
                                                         @click="loadPLCTemplate('soft-starter')">
                                                        <div class="w-16 h-16 mx-auto mb-4 rounded-full bg-gradient-to-r from-blue-500 to-purple-500 flex items-center justify-center text-white">
                                                            <i class="fas fa-bolt text-2xl"></i>
                                                        </div>
                                                        <h4 class="font-bold text-gray-800 dark:text-white mb-2">AC Station Soft Starter</h4>
                                                        <p class="text-sm text-gray-600 dark:text-gray-300 mb-4">ایستگاه AC با سافت استارتر</p>
                                                        <div class="flex items-center justify-center text-sm text-gray-500">
                                                            <i class="fas fa-motor ml-1"></i>
                                                            <span>موتورها تا 60 کیلووات</span>
                                                        </div>
                                                    </div>
                                                    
                                                    <div class="component-3d bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 text-center cursor-pointer hover:border-2 hover:border-green-500"
                                                         @click="loadPLCTemplate('vfd')">
                                                        <div class="w-16 h-16 mx-auto mb-4 rounded-full bg-gradient-to-r from-green-500 to-teal-500 flex items-center justify-center text-white">
                                                            <i class="fas fa-tachometer-alt text-2xl"></i>
                                                        </div>
                                                        <h4 class="font-bold text-gray-800 dark:text-white mb-2">AC Station VFD</h4>
                                                        <p class="text-sm text-gray-600 dark:text-gray-300 mb-4">ایستگاه AC با درایو فرکانس متغیر</p>
                                                        <div class="flex items-center justify-center text-sm text-gray-500">
                                                            <i class="fas fa-motor ml-1"></i>
                                                            <span>موتورها با VFD</span>
                                                        </div>
                                                    </div>
                                                    
                                                    <div class="component-3d bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 text-center cursor-pointer hover:border-2 hover:border-purple-500"
                                                         @click="loadPLCTemplate('filter-soft')">
                                                        <div class="w-16 h-16 mx-auto mb-4 rounded-full bg-gradient-to-r from-purple-500 to-pink-500 flex items-center justify-center text-white">
                                                            <i class="fas fa-filter text-2xl"></i>
                                                        </div>
                                                        <h4 class="font-bold text-gray-800 dark:text-white mb-2">Filter Plant Soft Starter</h4>
                                                        <p class="text-sm text-gray-600 dark:text-gray-300 mb-4">فیلتر پلن با سافت استارتر</p>
                                                        <div class="flex items-center justify-center text-sm text-gray-500">
                                                            <i class="fas fa-industry ml-1"></i>
                                                            <span>اتاق‌های فیلتر</span>
                                                        </div>
                                                    </div>
                                                    
                                                    <div class="component-3d bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 text-center cursor-pointer hover:border-2 hover:border-yellow-500"
                                                         @click="loadPLCTemplate('filter-vfd')">
                                                        <div class="w-16 h-16 mx-auto mb-4 rounded-full bg-gradient-to-r from-yellow-500 to-orange-500 flex items-center justify-center text-white">
                                                            <i class="fas fa-filter text-2xl"></i>
                                                        </div>
                                                        <h4 class="font-bold text-gray-800 dark:text-white mb-2">Filter Plant VFD</h4>
                                                        <p class="text-sm text-gray-600 dark:text-gray-300 mb-4">فیلتر پلن با درایو فرکانس متغیر</p>
                                                        <div class="flex items-center justify-center text-sm text-gray-500">
                                                            <i class="fas fa-industry ml-1"></i>
                                                            <span>موتورهای بزرگ</span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            
                                            <!-- PLC Components -->
                                            <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 mb-8">
                                                <h3 class="text-lg font-bold text-gray-800 dark:text-white mb-4">کامپوننت‌های PLC</h3>
                                                <p class="text-gray-600 dark:text-gray-300 mb-6">طراحی و انتخاب کامپوننت‌های سیستم کنترل</p>
                                                
                                                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                                                    <!-- Motors -->
                                                    <div class="bg-gradient-to-r from-blue-50 to-blue-100 dark:from-blue-900 dark:to-blue-800 rounded-xl p-6">
                                                        <h4 class="font-bold text-gray-800 dark:text-white mb-4">موتورهای سه فاز</h4>
                                                        
                                                        <div class="space-y-4">
                                                            <div class="flex items-center justify-between">
                                                                <div>
                                                                    <p class="font-medium text-gray-800 dark:text-white">فن رفت</p>
                                                                    <p class="text-sm text-gray-600 dark:text-gray-300">پیش‌فرض: 2 عدد، 22 کیلووات</p>
                                                                </div>
                                                                <div class="flex items-center space-x-2 space-x-reverse">
                                                                    <input type="number" x-model="plcDesign.motors.fanFeed.count" min="0" max="10" class="input-3d w-16 p-2 rounded-lg border-0 text-center">
                                                                    <input type="number" x-model="plcDesign.motors.fanFeed.power" min="1" max="200" step="0.5" class="input-3d w-20 p-2 rounded-lg border-0 text-center">
                                                                    <span class="text-sm">kW</span>
                                                                </div>
                                                            </div>
                                                            
                                                            <div class="flex items-center justify-between">
                                                                <div>
                                                                    <p class="font-medium text-gray-800 dark:text-white">فن برگشت</p>
                                                                    <p class="text-sm text-gray-600 dark:text-gray-300">پیش‌فرض: 2 عدد، 30 کیلووات</p>
                                                                </div>
                                                                <div class="flex items-center space-x-2 space-x-reverse">
                                                                    <input type="number" x-model="plcDesign.motors.fanReturn.count" min="0" max="10" class="input-3d w-16 p-2 rounded-lg border-0 text-center">
                                                                    <input type="number" x-model="plcDesign.motors.fanReturn.power" min="1" max="200" step="0.5" class="input-3d w-20 p-2 rounded-lg border-0 text-center">
                                                                    <span class="text-sm">kW</span>
                                                                </div>
                                                            </div>
                                                            
                                                            <div class="flex items-center justify-between">
                                                                <div>
                                                                    <p class="font-medium text-gray-800 dark:text-white">پمپ آب</p>
                                                                    <p class="text-sm text-gray-600 dark:text-gray-300">پیش‌فرض: 1 عدد، 30 کیلووات</p>
                                                                </div>
                                                                <div class="flex items-center space-x-2 space-x-reverse">
                                                                    <input type="number" x-model="plcDesign.motors.pump.count" min="0" max="5" class="input-3d w-16 p-2 rounded-lg border-0 text-center">
                                                                    <input type="number" x-model="plcDesign.motors.pump.power" min="1" max="100" step="0.5" class="input-3d w-20 p-2 rounded-lg border-0 text-center">
                                                                    <span class="text-sm">kW</span>
                                                                </div>
                                                            </div>
                                                            
                                                            <div class="pt-4 border-t border-blue-200 dark:border-blue-700">
                                                                <div class="flex justify-between">
                                                                    <span class="text-gray-600 dark:text-gray-300">تعداد کل موتورها:</span>
                                                                    <span class="font-bold text-gray-800 dark:text-white" x-text="totalMotors"></span>
                                                                </div>
                                                                <div class="flex justify-between mt-1">
                                                                    <span class="text-gray-600 dark:text-gray-300">توان کل موتورها:</span>
                                                                    <span class="font-bold text-gray-800 dark:text-white" x-text="totalMotorPower.toFixed(1) + ' kW'"></span>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    
                                                    <!-- Actuators -->
                                                    <div class="bg-gradient-to-r from-green-50 to-green-100 dark:from-green-900 dark:to-green-800 rounded-xl p-6">
                                                        <h4 class="font-bold text-gray-800 dark:text-white mb-4">اکچویتورها و رله‌ها</h4>
                                                        
                                                        <div class="space-y-4">
                                                            <div class="flex items-center justify-between">
                                                                <div>
                                                                    <p class="font-medium text-gray-800 dark:text-white">دمپر هوای تازه</p>
                                                                    <p class="text-sm text-gray-600 dark:text-gray-300">پیش‌فرض: 2 عدد، 24 VDC</p>
                                                                </div>
                                                                <div class="flex items-center space-x-2 space-x-reverse">
                                                                    <input type="number" x-model="plcDesign.actuators.damperFresh.count" min="0" max="20" class="input-3d w-16 p-2 rounded-lg border-0 text-center">
                                                                    <select x-model="plcDesign.actuators.damperFresh.voltage" class="input-3d w-20 p-2 rounded-lg border-0">
                                                                        <option value="24">24V</option>
                                                                        <option value="220">220V</option>
                                                                    </select>
                                                                </div>
                                                            </div>
                                                            
                                                            <div class="flex items-center justify-between">
                                                                <div>
                                                                    <p class="font-medium text-gray-800 dark:text-white">دمپر تخلیه</p>
                                                                    <p class="text-sm text-gray-600 dark:text-gray-300">پیش‌فرض: 2 عدد، 24 VDC</p>
                                                                </div>
                                                                <div class="flex items-center space-x-2 space-x-reverse">
                                                                    <input type="number" x-model="plcDesign.actuators.damperExhaust.count" min="0" max="20" class="input-3d w-16 p-2 rounded-lg border-0 text-center">
                                                                    <select x-model="plcDesign.actuators.damperExhaust.voltage" class="input-3d w-20 p-2 rounded-lg border-0">
                                                                        <option value="24">24V</option>
                                                                        <option value="220">220V</option>
                                                                    </select>
                                                                </div>
                                                            </div>
                                                            
                                                            <div class="flex items-center justify-between">
                                                                <div>
                                                                    <p class="font-medium text-gray-800 dark:text-white">شیر بخار</p>
                                                                    <p class="text-sm text-gray-600 dark:text-gray-300">پیش‌فرض: 1 عدد، 24 VDC</p>
                                                                </div>
                                                                <div class="flex items-center space-x-2 space-x-reverse">
                                                                    <input type="number" x-model="plcDesign.actuators.steamValve.count" min="0" max="10" class="input-3d w-16 p-2 rounded-lg border-0 text-center">
                                                                    <select x-model="plcDesign.actuators.steamValve.voltage" class="input-3d w-20 p-2 rounded-lg border-0">
                                                                        <option value="24">24V</option>
                                                                        <option value="220">220V</option>
                                                                    </select>
                                                                </div>
                                                            </div>
                                                            
                                                            <div class="pt-4 border-t border-green-200 dark:border-green-700">
                                                                <div class="flex justify-between">
                                                                    <span class="text-gray-600 dark:text-gray-300">تعداد کل اکچویتورها:</span>
                                                                    <span class="font-bold text-gray-800 dark:text-white" x-text="totalActuators"></span>
                                                                </div>
                                                                <div class="flex justify-between mt-1">
                                                                    <span class="text-gray-600 dark:text-gray-300">تعداد رله‌های مورد نیاز:</span>
                                                                    <span class="font-bold text-gray-800 dark:text-white" x-text="totalActuators * 2"></span>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    
                                                    <!-- Sensors -->
                                                    <div class="bg-gradient-to-r from-purple-50 to-purple-100 dark:from-purple-900 dark:to-purple-800 rounded-xl p-6">
                                                        <h4 class="font-bold text-gray-800 dark:text-white mb-4">سنسورها</h4>
                                                        
                                                        <div class="space-y-4">
                                                            <div class="flex items-center justify-between">
                                                                <div>
                                                                    <p class="font-medium text-gray-800 dark:text-white">سنسور دما</p>
                                                                    <p class="text-sm text-gray-600 dark:text-gray-300">پیش‌فرض: 2 عدد، 4-20 mA</p>
                                                                </div>
                                                                <div class="flex items-center space-x-2 space-x-reverse">
                                                                    <input type="number" x-model="plcDesign.sensors.temperature.count" min="0" max="20" class="input-3d w-16 p-2 rounded-lg border-0 text-center">
                                                                    <select x-model="plcDesign.sensors.temperature.type" class="input-3d w-24 p-2 rounded-lg border-0">
                                                                        <option value="4-20ma">4-20 mA</option>
                                                                        <option value="0-10v">0-10 V</option>
                                                                        <option value="pt100">PT100</option>
                                                                    </select>
                                                                </div>
                                                            </div>
                                                            
                                                            <div class="flex items-center justify-between">
                                                                <div>
                                                                    <p class="font-medium text-gray-800 dark:text-white">سنسور رطوبت</p>
                                                                    <p class="text-sm text-gray-600 dark:text-gray-300">پیش‌فرض: 2 عدد، 4-20 mA</p>
                                                                </div>
                                                                <div class="flex items-center space-x-2 space-x-reverse">
                                                                    <input type="number" x-model="plcDesign.sensors.humidity.count" min="0" max="20" class="input-3d w-16 p-2 rounded-lg border-0 text-center">
                                                                    <select x-model="plcDesign.sensors.humidity.type" class="input-3d w-24 p-2 rounded-lg border-0">
                                                                        <option value="4-20ma">4-20 mA</option>
                                                                        <option value="0-10v">0-10 V</option>
                                                                    </select>
                                                                </div>
                                                            </div>
                                                            
                                                            <div class="flex items-center justify-between">
                                                                <div>
                                                                    <p class="font-medium text-gray-800 dark:text-white">میکروسوییچ</p>
                                                                    <p class="text-sm text-gray-600 dark:text-gray-300">پیش‌فرض: 5 عدد، ON/OFF</p>
                                                                </div>
                                                                <div class="flex items-center space-x-2 space-x-reverse">
                                                                    <input type="number" x-model="plcDesign.sensors.microSwitch.count" min="0" max="50" class="input-3d w-16 p-2 rounded-lg border-0 text-center">
                                                                    <span class="text-sm">ON/OFF</span>
                                                                </div>
                                                            </div>
                                                            
                                                            <div class="pt-4 border-t border-purple-200 dark:border-purple-700">
                                                                <div class="flex justify-between">
                                                                    <span class="text-gray-600 dark:text-gray-300">تعداد سنسورهای آنالوگ:</span>
                                                                    <span class="font-bold text-gray-800 dark:text-white" x-text="plcDesign.sensors.temperature.count + plcDesign.sensors.humidity.count"></span>
                                                                </div>
                                                                <div class="flex justify-between mt-1">
                                                                    <span class="text-gray-600 dark:text-gray-300">تعداد سنسورهای دیجیتال:</span>
                                                                    <span class="font-bold text-gray-800 dark:text-white" x-text="plcDesign.sensors.microSwitch.count"></span>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                
                                                <!-- Optional Components -->
                                                <div class="mt-8">
                                                    <h4 class="font-bold text-gray-800 dark:text-white mb-4">کامپوننت‌های اختیاری</h4>
                                                    
                                                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                                                        <div class="component-item">
                                                            <div class="component-icon">
                                                                <i class="fas fa-tachometer-alt"></i>
                                                            </div>
                                                            <p class="font-bold">درایو فرکانس متغیر (VFD)</p>
                                                            <div class="flex items-center justify-between w-full mt-2">
                                                                <span class="text-sm">تعداد:</span>
                                                                <input type="number" x-model="plcDesign.optional.vfd.count" min="0" max="10" class="input-3d w-16 p-2 rounded-lg border-0 text-center">
                                                            </div>
                                                            <div class="flex items-center justify-between w-full mt-2">
                                                                <span class="text-sm">توان (kW):</span>
                                                                <input type="number" x-model="plcDesign.optional.vfd.power" min="0" max="500" step="5" class="input-3d w-20 p-2 rounded-lg border-0 text-center">
                                                            </div>
                                                        </div>
                                                        
                                                        <div class="component-item">
                                                            <div class="component-icon">
                                                                <i class="fas fa-bolt"></i>
                                                            </div>
                                                            <p class="font-bold">سافت استارتر</p>
                                                            <div class="flex items-center justify-between w-full mt-2">
                                                                <span class="text-sm">تعداد:</span>
                                                                <input type="number" x-model="plcDesign.optional.softStarter.count" min="0" max="10" class="input-3d w-16 p-2 rounded-lg border-0 text-center">
                                                            </div>
                                                            <div class="flex items-center justify-between w-full mt-2">
                                                                <span class="text-sm">توان (kW):</span>
                                                                <input type="number" x-model="plcDesign.optional.softStarter.power" min="0" max="500" step="5" class="input-3d w-20 p-2 rounded-lg border-0 text-center">
                                                            </div>
                                                        </div>
                                                        
                                                        <div class="component-item">
                                                            <div class="component-icon">
                                                                <i class="fas fa-desktop"></i>
                                                            </div>
                                                            <p class="font-bold">HMI</p>
                                                            <div class="flex items-center justify-between w-full mt-2">
                                                                <span class="text-sm">تعداد:</span>
                                                                <input type="number" x-model="plcDesign.optional.hmi.count" min="0" max="5" class="input-3d w-16 p-2 rounded-lg border-0 text-center">
                                                            </div>
                                                            <div class="flex items-center justify-between w-full mt-2">
                                                                <span class="text-sm">سایز:</span>
                                                                <select x-model="plcDesign.optional.hmi.size" class="input-3d w-20 p-2 rounded-lg border-0">
                                                                    <option value="7">7 اینچ</option>
                                                                    <option value="10">10 اینچ</option>
                                                                    <option value="15">15 اینچ</option>
                                                                </select>
                                                            </div>
                                                        </div>
                                                        
                                                        <div class="component-item">
                                                            <div class="component-icon">
                                                                <i class="fas fa-fire"></i>
                                                            </div>
                                                            <p class="font-bold">سنسور حرارت داخل تابلو</p>
                                                            <div class="flex items-center justify-between w-full mt-2">
                                                                <span class="text-sm">تعداد:</span>
                                                                <input type="number" x-model="plcDesign.optional.cabinetTemp.count" min="0" max="10" class="input-3d w-16 p-2 rounded-lg border-0 text-center">
                                                            </div>
                                                            <div class="mt-2">
                                                                <label class="toggle-switch">
                                                                    <input type="checkbox" x-model="plcDesign.optional.cabinetTemp.enabled">
                                                                    <span class="toggle-slider"></span>
                                                                </label>
                                                                <span class="text-sm mr-2">فعال</span>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            
                                            <!-- IO Calculation -->
                                            <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 mb-8">
                                                <h3 class="text-lg font-bold text-gray-800 dark:text-white mb-4">محاسبه ورودی/خروجی‌های PLC</h3>
                                                
                                                <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                                                    <!-- Digital IO -->
                                                    <div class="bg-gradient-to-r from-blue-50 to-blue-100 dark:from-blue-900 dark:to-blue-800 rounded-xl p-6">
                                                        <h4 class="font-bold text-gray-800 dark:text-white mb-4">ورودی/خروجی دیجیتال</h4>
                                                        
                                                        <div class="space-y-4">
                                                            <div class="flex justify-between">
                                                                <span class="text-gray-600 dark:text-gray-300">موتورها (کنترل):</span>
                                                                <span class="font-bold text-gray-800 dark:text-white" x-text="totalMotors * 2"></span>
                                                            </div>
                                                            
                                                            <div class="flex justify-between">
                                                                <span class="text-gray-600 dark:text-gray-300">اکچویتورها (کنترل):</span>
                                                                <span class="font-bold text-gray-800 dark:text-white" x-text="totalActuators"></span>
                                                            </div>
                                                            
                                                            <div class="flex justify-between">
                                                                <span class="text-gray-600 dark:text-gray-300">میکروسوییچ‌ها (ورودی):</span>
                                                                <span class="font-bold text-gray-800 dark:text-white" x-text="plcDesign.sensors.microSwitch.count"></span>
                                                            </div>
                                                            
                                                            <div class="flex justify-between">
                                                                <span class="text-gray-600 dark:text-gray-300">دکمه‌های اضطراری (ورودی):</span>
                                                                <span class="font-bold text-gray-800 dark:text-white" x-text="plcDesign.safety.emergencyButtons"></span>
                                                            </div>
                                                            
                                                            <div class="flex justify-between">
                                                                <span class="text-gray-600 dark:text-gray-300">لامپ‌های نشانگر (خروجی):</span>
                                                                <span class="font-bold text-gray-800 dark:text-white" x-text="plcDesign.indicators.lamps"></span>
                                                            </div>
                                                            
                                                            <div class="pt-4 border-t border-blue-200 dark:border-blue-700">
                                                                <div class="flex justify-between">
                                                                    <span class="font-bold text-gray-800 dark:text-white">مجموع DI:</span>
                                                                    <span class="font-bold text-gray-800 dark:text-white" x-text="totalDI"></span>
                                                                </div>
                                                                <div class="flex justify-between mt-1">
                                                                    <span class="font-bold text-gray-800 dark:text-white">مجموع DO:</span>
                                                                    <span class="font-bold text-gray-800 dark:text-white" x-text="totalDO"></span>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    
                                                    <!-- Analog IO -->
                                                    <div class="bg-gradient-to-r from-green-50 to-green-100 dark:from-green-900 dark:to-green-800 rounded-xl p-6">
                                                        <h4 class="font-bold text-gray-800 dark:text-white mb-4">ورودی/خروجی آنالوگ</h4>
                                                        
                                                        <div class="space-y-4">
                                                            <div class="flex justify-between">
                                                                <span class="text-gray-600 dark:text-gray-300">سنسورهای دما (ورودی):</span>
                                                                <span class="font-bold text-gray-800 dark:text-white" x-text="plcDesign.sensors.temperature.count"></span>
                                                            </div>
                                                            
                                                            <div class="flex justify-between">
                                                                <span class="text-gray-600 dark:text-gray-300">سنسورهای رطوبت (ورودی):</span>
                                                                <span class="font-bold text-gray-800 dark:text-white" x-text="plcDesign.sensors.humidity.count"></span>
                                                            </div>
                                                            
                                                            <div class="flex justify-between">
                                                                <span class="text-gray-600 dark:text-gray-300">پوزیشنر دمپرها (ورودی):</span>
                                                                <span class="font-bold text-gray-800 dark:text-white" x-text="plcDesign.actuators.damperFresh.count + plcDesign.actuators.damperExhaust.count + plcDesign.actuators.damperReturn.count"></span>
                                                            </div>
                                                            
                                                            <div class="flex justify-between">
                                                                <span class="text-gray-600 dark:text-gray-300">سنسور فشار (ورودی):</span>
                                                                <span class="font-bold text-gray-800 dark:text-white" x-text="plcDesign.sensors.pressure"></span>
                                                            </div>
                                                            
                                                            <div class="flex justify-between">
                                                                <span class="text-gray-600 dark:text-gray-300">خروجی‌های کنترل سرعت (خروجی):</span>
                                                                <span class="font-bold text-gray-800 dark:text-white" x-text="plcDesign.optional.vfd.count"></span>
                                                            </div>
                                                            
                                                            <div class="pt-4 border-t border-green-200 dark:border-green-700">
                                                                <div class="flex justify-between">
                                                                    <span class="font-bold text-gray-800 dark:text-white">مجموع AI:</span>
                                                                    <span class="font-bold text-gray-800 dark:text-white" x-text="totalAI"></span>
                                                                </div>
                                                                <div class="flex justify-between mt-1">
                                                                    <span class="font-bold text-gray-800 dark:text-white">مجموع AO:</span>
                                                                    <span class="font-bold text-gray-800 dark:text-white" x-text="totalAO"></span>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                
                                                <!-- PLC Module Selection -->
                                                <div class="mt-8">
                                                    <h4 class="font-bold text-gray-800 dark:text-white mb-4">انتخاب ماژول‌های PLC</h4>
                                                    
                                                    <div class="overflow-x-auto">
                                                        <table class="data-table">
                                                            <thead>
                                                                <tr>
                                                                    <th>نوع ماژول</th>
                                                                    <th>تعداد مورد نیاز</th>
                                                                    <th>توضیحات</th>
                                                                    <th>قیمت تقریبی (USD)</th>
                                                                </tr>
                                                            </thead>
                                                            <tbody>
                                                                <tr>
                                                                    <td>CPU واحد مرکزی</td>
                                                                    <td>1</td>
                                                                    <td>CPU با حداقل 2 پورت اترنت</td>
                                                                    <td>$1,200</td>
                                                                </tr>
                                                                <tr>
                                                                    <td>ماژول DI 16 کاناله</td>
                                                                    <td x-text="Math.ceil(totalDI / 16)"></td>
                                                                    <td>ورودی دیجیتال 24VDC</td>
                                                                    <td>$250</td>
                                                                </tr>
                                                                <tr>
                                                                    <td>ماژول DO 16 کاناله</td>
                                                                    <td x-text="Math.ceil(totalDO / 16)"></td>
                                                                    <td>رله خروجی 10A</td>
                                                                    <td>$300</td>
                                                                </tr>
                                                                <tr>
                                                                    <td>ماژول AI 8 کاناله</td>
                                                                    <td x-text="Math.ceil(totalAI / 8)"></td>
                                                                    <td>ورودی آنالوگ 4-20mA/0-10V</td>
                                                                    <td>$450</td>
                                                                </tr>
                                                                <tr>
                                                                    <td>ماژول AO 4 کاناله</td>
                                                                    <td x-text="Math.ceil(totalAO / 4)"></td>
                                                                    <td>خروجی آنالوگ 4-20mA/0-10V</td>
                                                                    <td>$400</td>
                                                                </tr>
                                                                <tr>
                                                                    <td>ماژول ارتباطی</td>
                                                                    <td>1</td>
                                                                    <td>پروتکل Modbus TCP/RTU</td>
                                                                    <td>$350</td>
                                                                </tr>
                                                                <tr>
                                                                    <td>منبع تغذیه</td>
                                                                    <td>1</td>
                                                                    <td>24VDC 10A</td>
                                                                    <td>$200</td>
                                                                </tr>
                                                            </tbody>
                                                        </table>
                                                    </div>
                                                </div>
                                            </div>
                                            
                                            <!-- Safety Components -->
                                            <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 mb-8">
                                                <h3 class="text-lg font-bold text-gray-800 dark:text-white mb-4">کامپوننت‌های ایمنی</h3>
                                                
                                                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                                                    <div class="component-item">
                                                        <div class="component-icon">
                                                            <i class="fas fa-plug"></i>
                                                        </div>
                                                        <p class="font-bold">منبع تغذیه (PSU)</p>
                                                        <p class="text-sm text-gray-600 dark:text-gray-300">24VDC 10A با رگولاتور</p>
                                                    </div>
                                                    
                                                    <div class="component-item">
                                                        <div class="component-icon">
                                                            <i class="fas fa-bolt"></i>
                                                        </div>
                                                        <p class="font-bold">کلید قطع اضطراری</p>
                                                        <p class="text-sm text-gray-600 dark:text-gray-300">2 عدد قرمز بزرگ</p>
                                                    </div>
                                                    
                                                    <div class="component-item">
                                                        <div class="component-icon">
                                                            <i class="fas fa-temperature-high"></i>
                                                        </div>
                                                        <p class="font-bold">ترموستات تابلو</p>
                                                        <p class="text-sm text-gray-600 dark:text-gray-300">کنترل دمای داخل تابلو</p>
                                                    </div>
                                                    
                                                    <div class="component-item">
                                                        <div class="component-icon">
                                                            <i class="fas fa-tachometer-alt"></i>
                                                        </div>
                                                        <p class="font-bold">کنترل فاز</p>
                                                        <p class="text-sm text-gray-600 dark:text-gray-300">حفاظت در برابر عدم تعادل فاز</p>
                                                    </div>
                                                    
                                                    <div class="component-item">
                                                        <div class="component-icon">
                                                            <i class="fas fa-lightbulb"></i>
                                                        </div>
                                                        <p class="font-bold">لامپ نشانگر</p>
                                                        <p class="text-sm text-gray-600 dark:text-gray-300">LED 24VDC چند رنگ</p>
                                                    </div>
                                                    
                                                    <div class="component-item">
                                                        <div class="component-icon">
                                                            <i class="fas fa-compress-arrows-alt"></i>
                                                        </div>
                                                        <p class="font-bold">فیوز و کلید محافظ</p>
                                                        <p class="text-sm text-gray-600 dark:text-gray-300">حفاظت مدارهای قدرت</p>
                                                    </div>
                                                    
                                                    <div class="component-item">
                                                        <div class="component-icon">
                                                            <i class="fas fa-project-diagram"></i>
                                                        </div>
                                                        <p class="font-bold">تجهیزات ارت‌ینگ</p>
                                                        <p class="text-sm text-gray-600 dark:text-gray-300">سیستم ارت کامل</p>
                                                    </div>
                                                    
                                                    <div class="component-item">
                                                        <div class="component-icon">
                                                            <i class="fas fa-cable-car"></i>
                                                        </div>
                                                        <p class="font-bold">کابل و سیم</p>
                                                        <p class="text-sm text-gray-600 dark:text-gray-300">مشخصات استاندارد</p>
                                                    </div>
                                                </div>
                                            </div>
                                            
                                            <!-- Layout Design -->
                                            <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6">
                                                <h3 class="text-lg font-bold text-gray-800 dark:text-white mb-4">طراحی لیآوت تابلو</h3>
                                                
                                                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                                                    <!-- Layout Grid -->
                                                    <div>
                                                        <h4 class="font-bold text-gray-800 dark:text-white mb-4">گرید 3D در صفحه 2D</h4>
                                                        
                                                        <div class="bg-gradient-to-r from-gray-50 to-gray-100 dark:from-gray-700 dark:to-gray-800 rounded-xl p-6">
                                                            <div class="relative h-96 w-full bg-gradient-to-br from-blue-50 to-indigo-100 dark:from-gray-800 dark:to-gray-900 rounded-lg border-2 border-dashed border-gray-300 dark:border-gray-700">
                                                                <!-- Grid Lines -->
                                                                <div class="absolute inset-0 opacity-20">
                                                                    <div class="h-full w-full" style="background-size: 40px 40px; background-image: linear-gradient(to right, gray 1px, transparent 1px), linear-gradient(to bottom, gray 1px, transparent 1px);"></div>
                                                                </div>
                                                                
                                                                <!-- Components -->
                                                                <div class="absolute top-4 right-4 w-16 h-16 bg-gradient-to-r from-blue-500 to-blue-600 rounded-lg flex items-center justify-center text-white">
                                                                    <i class="fas fa-microchip text-xl"></i>
                                                                </div>
                                                                
                                                                <div class="absolute top-4 right-24 w-40 h-20 bg-gradient-to-r from-green-500 to-green-600 rounded-lg flex items-center justify-center text-white">
                                                                    <i class="fas fa-bolt text-xl ml-2"></i>
                                                                    <span>PSU</span>
                                                                </div>
                                                                
                                                                <div class="absolute top-32 right-4 w-20 h-20 bg-gradient-to-r from-yellow-500 to-yellow-600 rounded-lg flex items-center justify-center text-white">
                                                                    <i class="fas fa-plug text-xl"></i>
                                                                </div>
                                                                
                                                                <div class="absolute top-32 right-32 w-16 h-40 bg-gradient-to-r from-purple-500 to-purple-600 rounded-lg flex items-center justify-center text-white">
                                                                    <i class="fas fa-sliders-h text-xl"></i>
                                                                </div>
                                                                
                                                                <div class="absolute bottom-4 right-4 w-64 h-16 bg-gradient-to-r from-red-500 to-red-600 rounded-lg flex items-center justify-center text-white">
                                                                    <i class="fas fa-terminal text-xl ml-2"></i>
                                                                    <span>ترمینال</span>
                                                                </div>
                                                                
                                                                <div class="absolute top-24 left-1/4 w-12 h-32 bg-gradient-to-r from-teal-500 to-teal-600 rounded-lg flex items-center justify-center text-white">
                                                                    <i class="fas fa-exchange-alt text-xl"></i>
                                                                </div>
                                                                
                                                                <!-- Grid Info -->
                                                                <div class="absolute bottom-4 left-4 bg-white dark:bg-gray-800 p-3 rounded-lg shadow-lg">
                                                                    <div class="flex items-center space-x-2 space-x-reverse">
                                                                        <div class="w-4 h-4 bg-blue-500 rounded"></div>
                                                                        <span class="text-sm">PLC</span>
                                                                    </div>
                                                                    <div class="flex items-center space-x-2 space-x-reverse mt-1">
                                                                        <div class="w-4 h-4 bg-green-500 rounded"></div>
                                                                        <span class="text-sm">PSU</span>
                                                                    </div>
                                                                    <div class="flex items-center space-x-2 space-x-reverse mt-1">
                                                                        <div class="w-4 h-4 bg-yellow-500 rounded"></div>
                                                                        <span class="text-sm">رله</span>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    
                                                    <!-- Component Sizes -->
                                                    <div>
                                                        <h4 class="font-bold text-gray-800 dark:text-white mb-4">ابعاد استاندارد کامپوننت‌ها</h4>
                                                        
                                                        <div class="space-y-4">
                                                            <div class="flex items-center justify-between p-4 bg-gradient-to-r from-blue-50 to-blue-100 dark:from-blue-900 dark:to-blue-800 rounded-lg">
                                                                <div class="flex items-center">
                                                                    <i class="fas fa-microchip text-blue-600 dark:text-blue-300 text-xl ml-3"></i>
                                                                    <span>PLC</span>
                                                                </div>
                                                                <div class="text-right">
                                                                    <p class="font-bold" x-text="`${plcDesign.layout.plc.width} × ${plcDesign.layout.plc.height} cm`"></p>
                                                                    <p class="text-sm text-gray-600 dark:text-gray-300">حاشیه: <span x-text="plcDesign.layout.plc.margin + ' cm'"></span></p>
                                                                </div>
                                                            </div>
                                                            
                                                            <div class="flex items-center justify-between p-4 bg-gradient-to-r from-green-50 to-green-100 dark:from-green-900 dark:to-green-800 rounded-lg">
                                                                <div class="flex items-center">
                                                                    <i class="fas fa-tachometer-alt text-green-600 dark:text-green-300 text-xl ml-3"></i>
                                                                    <span>VFD/Inverter</span>
                                                                </div>
                                                                <div class="text-right">
                                                                    <p class="font-bold" x-text="`${plcDesign.layout.vfd.width} × ${plcDesign.layout.vfd.height} cm`"></p>
                                                                    <p class="text-sm text-gray-600 dark:text-gray-300">حاشیه: <span x-text="plcDesign.layout.vfd.margin + ' cm'"></span></p>
                                                                </div>
                                                            </div>
                                                            
                                                            <div class="flex items-center justify-between p-4 bg-gradient-to-r from-purple-50 to-purple-100 dark:from-purple-900 dark:to-purple-800 rounded-lg">
                                                                <div class="flex items-center">
                                                                    <i class="fas fa-bolt text-purple-600 dark:text-purple-300 text-xl ml-3"></i>
                                                                    <span>سافت استارتر</span>
                                                                </div>
                                                                <div class="text-right">
                                                                    <p class="font-bold" x-text="`${plcDesign.layout.softStarter.width} × ${plcDesign.layout.softStarter.height} cm`"></p>
                                                                    <p class="text-sm text-gray-600 dark:text-gray-300">حاشیه: <span x-text="plcDesign.layout.softStarter.margin + ' cm'"></span></p>
                                                                </div>
                                                            </div>
                                                            
                                                            <div class="flex items-center justify-between p-4 bg-gradient-to-r from-red-50 to-red-100 dark:from-red-900 dark:to-red-800 rounded-lg">
                                                                <div class="flex items-center">
                                                                    <i class="fas fa-plug text-red-600 dark:text-red-300 text-xl ml-3"></i>
                                                                    <span>کنتاکتور</span>
                                                                </div>
                                                                <div class="text-right">
                                                                    <p class="font-bold" x-text="`${plcDesign.layout.contactor.width} × ${plcDesign.layout.contactor.height} cm`"></p>
                                                                    <p class="text-sm text-gray-600 dark:text-gray-300">حاشیه: <span x-text="plcDesign.layout.contactor.margin + ' cm'"></span></p>
                                                                </div>
                                                            </div>
                                                            
                                                            <div class="flex items-center justify-between p-4 bg-gradient-to-r from-yellow-50 to-yellow-100 dark:from-yellow-900 dark:to-yellow-800 rounded-lg">
                                                                <div class="flex items-center">
                                                                    <i class="fas fa-exchange-alt text-yellow-600 dark:text-yellow-300 text-xl ml-3"></i>
                                                                    <span>رله</span>
                                                                </div>
                                                                <div class="text-right">
                                                                    <p class="font-bold" x-text="`${plcDesign.layout.relay.width} × ${plcDesign.layout.relay.height} cm`"></p>
                                                                    <p class="text-sm text-gray-600 dark:text-gray-300">بدون حاشیه</span></p>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        
                                                        <div class="mt-6">
                                                            <h5 class="font-bold text-gray-800 dark:text-white mb-2">محاسبه فضای مورد نیاز</h5>
                                                            <div class="p-4 bg-gradient-to-r from-gray-50 to-gray-100 dark:from-gray-700 dark:to-gray-800 rounded-lg">
                                                                <div class="flex justify-between mb-2">
                                                                    <span class="text-gray-600 dark:text-gray-300">عرض تابلو:</span>
                                                                    <span class="font-bold" x-text="plcDesign.layout.cabinetWidth + ' cm'"></span>
                                                                </div>
                                                                <div class="flex justify-between mb-2">
                                                                    <span class="text-gray-600 dark:text-gray-300">ارتفاع تابلو:</span>
                                                                    <span class="font-bold" x-text="plcDesign.layout.cabinetHeight + ' cm'"></span>
                                                                </div>
                                                                <div class="flex justify-between">
                                                                    <span class="text-gray-600 dark:text-gray-300">عمق تابلو:</span>
                                                                    <span class="font-bold" x-text="plcDesign.layout.cabinetDepth + ' cm'"></span>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <!-- BOM/MTO -->
                                        <div x-show="activeTab === 'bom'" x-transition>
                                            <div class="mb-8">
                                                <div class="flex items-center justify-between">
                                                    <h2 class="text-2xl font-bold text-gray-800 dark:text-white">لیست مواد و تجهیزات (BOM/MTO)</h2>
                                                    <div class="flex space-x-3 space-x-reverse">
                                                        <button @click="exportBOM()" class="btn-primary px-6 py-3 rounded-lg flex items-center">
                                                            <i class="fas fa-download ml-2"></i>
                                                            خروجی Excel
                                                        </button>
                                                        <button @click="printBOM()" class="btn-success px-6 py-3 rounded-lg flex items-center">
                                                            <i class="fas fa-print ml-2"></i>
                                                            چاپ
                                                        </button>
                                                    </div>
                                                </div>
                                                <p class="text-gray-600 dark:text-gray-300 mt-2">لیست دقیق مواد و تجهیزات با استانداردهای بین‌المللی</p>
                                            </div>
                                            
                                            <!-- BOM Summary -->
                                            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                                                <div class="bg-gradient-to-r from-blue-50 to-blue-100 dark:from-blue-900 dark:to-blue-800 rounded-xl p-6">
                                                    <div class="flex items-center justify-between">
                                                        <div>
                                                            <p class="text-gray-600 dark:text-gray-300">تعداد اقلام</p>
                                                            <p class="text-2xl font-bold text-gray-800 dark:text-white" x-text="bomItems.length"></p>
                                                        </div>
                                                        <div class="w-12 h-12 rounded-full bg-blue-100 dark:bg-blue-800 flex items-center justify-center">
                                                            <i class="fas fa-boxes text-blue-600 dark:text-blue-300 text-xl"></i>
                                                        </div>
                                                    </div>
                                                </div>
                                                
                                                <div class="bg-gradient-to-r from-green-50 to-green-100 dark:from-green-900 dark:to-green-800 rounded-xl p-6">
                                                    <div class="flex items-center justify-between">
                                                        <div>
                                                            <p class="text-gray-600 dark:text-gray-300">هزینه کل مواد</p>
                                                            <p class="text-2xl font-bold text-gray-800 dark:text-white">$<span x-text="totalMaterialCost.toLocaleString()"></span></p>
                                                        </div>
                                                        <div class="w-12 h-12 rounded-full bg-green-100 dark:bg-green-800 flex items-center justify-center">
                                                            <i class="fas fa-dollar-sign text-green-600 dark:text-green-300 text-xl"></i>
                                                        </div>
                                                    </div>
                                                </div>
                                                
                                                <div class="bg-gradient-to-r from-purple-50 to-purple-100 dark:from-purple-900 dark:to-purple-800 rounded-xl p-6">
                                                    <div class="flex items-center justify-between">
                                                        <div>
                                                            <p class="text-gray-600 dark:text-gray-300">هزینه نصب و راه‌اندازی</p>
                                                            <p class="text-2xl font-bold text-gray-800 dark:text-white">$<span x-text="installationCost.toLocaleString()"></span></p>
                                                        </div>
                                                        <div class="w-12 h-12 rounded-full bg-purple-100 dark:bg-purple-800 flex items-center justify-center">
                                                            <i class="fas fa-tools text-purple-600 dark:text-purple-300 text-xl"></i>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            
                                            <!-- BOM Filters -->
                                            <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 mb-6">
                                                <div class="flex flex-col md:flex-row md:items-center justify-between gap-4">
                                                    <div>
                                                        <h4 class="font-bold text-gray-800 dark:text-white mb-2">فیلترها</h4>
                                                        <div class="flex flex-wrap gap-2">
                                                            <button @click="bomFilter = 'all'" 
                                                                    :class="bomFilter === 'all' ? 'bg-blue-600 text-white' : 'bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-white'"
                                                                    class="px-4 py-2 rounded-lg text-sm">
                                                                همه
                                                            </button>
                                                            <button @click="bomFilter = 'plc'" 
                                                                    :class="bomFilter === 'plc' ? 'bg-blue-600 text-white' : 'bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-white'"
                                                                    class="px-4 py-2 rounded-lg text-sm">
                                                                PLC و کنترل
                                                            </button>
                                                            <button @click="bomFilter = 'hvac'" 
                                                                    :class="bomFilter === 'hvac' ? 'bg-blue-600 text-white' : 'bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-white'"
                                                                    class="px-4 py-2 rounded-lg text-sm">
                                                                HVAC
                                                            </button>
                                                            <button @click="bomFilter = 'electrical'" 
                                                                    :class="bomFilter === 'electrical' ? 'bg-blue-600 text-white' : 'bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-white'"
                                                                    class="px-4 py-2 rounded-lg text-sm">
                                                                تجهیزات الکتریکی
                                                            </button>
                                                            <button @click="bomFilter = 'mechanical'" 
                                                                    :class="bomFilter === 'mechanical' ? 'bg-blue-600 text-white' : 'bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-white'"
                                                                    class="px-4 py-2 rounded-lg text-sm">
                                                                تجهیزات مکانیکی
                                                            </button>
                                                        </div>
                                                    </div>
                                                    
                                                    <div class="flex items-center space-x-4 space-x-reverse">
                                                        <div class="relative">
                                                            <input type="text" x-model="bomSearch" placeholder="جستجو در BOM..." class="input-3d pr-10 pl-4 py-2 rounded-lg w-64">
                                                            <i class="fas fa-search absolute right-3 top-3 text-gray-400"></i>
                                                        </div>
                                                        <button @click="addBOMItem()" class="btn-primary px-4 py-2 rounded-lg">
                                                            <i class="fas fa-plus ml-2"></i>
                                                            افزودن آیتم
                                                        </button>
                                                    </div>
                                                </div>
                                            </div>
                                            
                                            <!-- BOM Table -->
                                            <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg overflow-hidden">
                                                <div class="overflow-x-auto">
                                                    <table class="data-table">
                                                        <thead>
                                                            <tr>
                                                                <th>#</th>
                                                                <th>کد آیتم</th>
                                                                <th>شرح</th>
                                                                <th>استاندارد</th>
                                                                <th>تعداد</th>
                                                                <th>واحد</th>
                                                                <th>قیمت واحد (USD)</th>
                                                                <th>قیمت کل (USD)</th>
                                                                <th>تأمین کننده</th>
                                                                <th>عملیات</th>
                                                            </tr>
                                                        </thead>
                                                        <tbody>
                                                            <template x-for="(item, index) in filteredBOM" :key="item.id">
                                                                <tr>
                                                                    <td x-text="index + 1"></td>
                                                                    <td>
                                                                        <span class="font-mono text-sm bg-gray-100 dark:bg-gray-700 px-2 py-1 rounded" x-text="item.code"></span>
                                                                    </td>
                                                                    <td>
                                                                        <div>
                                                                            <p class="font-medium text-gray-800 dark:text-white" x-text="item.description"></p>
                                                                            <p class="text-xs text-gray-600 dark:text-gray-300" x-text="item.specs"></p>
                                                                        </div>
                                                                    </td>
                                                                    <td>
                                                                        <span class="text-sm" x-text="item.standard"></span>
                                                                    </td>
                                                                    <td>
                                                                        <div class="flex items-center">
                                                                            <button @click="decreaseQuantity(item)" class="w-8 h-8 flex items-center justify-center bg-gray-200 dark:bg-gray-700 rounded-lg">
                                                                                <i class="fas fa-minus text-sm"></i>
                                                                            </button>
                                                                            <input type="number" x-model="item.quantity" min="1" class="input-3d w-16 mx-2 p-2 rounded-lg border-0 text-center">
                                                                            <button @click="increaseQuantity(item)" class="w-8 h-8 flex items-center justify-center bg-gray-200 dark:bg-gray-700 rounded-lg">
                                                                                <i class="fas fa-plus text-sm"></i>
                                                                            </button>
                                                                        </div>
                                                                    </td>
                                                                    <td x-text="item.unit"></td>
                                                                    <td>
                                                                        <input type="number" x-model="item.unitPrice" min="0" step="0.01" class="input-3d w-24 p-2 rounded-lg border-0 text-center">
                                                                    </td>
                                                                    <td class="font-bold" x-text="(item.quantity * item.unitPrice).toLocaleString(undefined, {minimumFractionDigits: 2})"></td>
                                                                    <td>
                                                                        <span class="text-sm" x-text="item.supplier"></span>
                                                                    </td>
                                                                    <td>
                                                                        <div class="flex space-x-2 space-x-reverse">
                                                                            <button @click="editBOMItem(item)" class="text-green-600 hover:text-green-800">
                                                                                <i class="fas fa-edit"></i>
                                                                            </button>
                                                                            <button @click="deleteBOMItem(item.id)" class="text-red-600 hover:text-red-800">
                                                                                <i class="fas fa-trash"></i>
                                                                            </button>
                                                                        </div>
                                                                    </td>
                                                                </tr>
                                                            </template>
                                                        </tbody>
                                                        <tfoot>
                                                            <tr class="bg-gradient-to-r from-gray-50 to-gray-100 dark:from-gray-800 dark:to-gray-900 font-bold">
                                                                <td colspan="7" class="text-right p-4">جمع کل:</td>
                                                                <td class="p-4">$<span x-text="totalBOMCost.toLocaleString(undefined, {minimumFractionDigits: 2})"></span></td>
                                                                <td colspan="2"></td>
                                                            </tr>
                                                        </tfoot>
                                                    </table>
                                                </div>
                                            </div>
                                            
                                            <!-- No BOM Items Message -->
                                            <div x-show="filteredBOM.length === 0" class="text-center py-12">
                                                <div class="w-24 h-24 mx-auto mb-6 rounded-full bg-gradient-to-r from-gray-100 to-gray-200 dark:from-gray-800 dark:to-gray-900 flex items-center justify-center">
                                                    <i class="fas fa-clipboard-list text-4xl text-gray-400"></i>
                                                </div>
                                                <h3 class="text-xl font-bold text-gray-800 dark:text-white mb-2">آیتمی در BOM وجود ندارد</h3>
                                                <p class="text-gray-600 dark:text-gray-300 mb-6">با افزودن آیتم‌ها شروع کنید یا یک تمپلیت بارگذاری کنید</p>
                                                <div class="flex justify-center space-x-4 space-x-reverse">
                                                    <button @click="addBOMItem()" class="btn-primary px-8 py-3 rounded-lg">
                                                        <i class="fas fa-plus ml-2"></i>
                                                        افزودن آیتم جدید
                                                    </button>
                                                    <button @click="loadBOMTemplate()" class="btn-secondary px-8 py-3 rounded-lg">
                                                        <i class="fas fa-download ml-2"></i>
                                                        بارگذاری تمپلیت
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <!-- Reports -->
                                        <div x-show="activeTab === 'reports'" x-transition>
                                            <div class="mb-8">
                                                <h2 class="text-2xl font-bold text-gray-800 dark:text-white">گزارش‌ها و تحلیلها</h2>
                                                <p class="text-gray-600 dark:text-gray-300 mt-2">گزارش‌های جامع پروژه شامل BOM، MTO، هزینه‌ها و مستندات</p>
                                            </div>
                                            
                                            <!-- Report Cards -->
                                            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8">
                                                <div class="dashboard-card bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 border-l-4 border-blue-500 cursor-pointer" @click="generateReport('bom')">
                                                    <div class="flex items-center justify-between">
                                                        <div>
                                                            <p class="text-gray-500 dark:text-gray-400 text-sm">گزارش BOM</p>
                                                            <p class="text-2xl font-bold text-gray-800 dark:text-white mt-1">مشخصات فنی</p>
                                                        </div>
                                                        <div class="w-12 h-12 rounded-full bg-blue-100 dark:bg-blue-900 flex items-center justify-center">
                                                            <i class="fas fa-clipboard-list text-blue-600 dark:text-blue-300 text-xl"></i>
                                                        </div>
                                                    </div>
                                                    <div class="mt-4">
                                                        <div class="flex items-center text-sm text-gray-600 dark:text-gray-300">
                                                            <i class="fas fa-file-pdf text-red-500 ml-1"></i>
                                                            <span>PDF, Excel, Word</span>
                                                        </div>
                                                    </div>
                                                </div>
                                                
                                                <div class="dashboard-card bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 border-l-4 border-green-500 cursor-pointer" @click="generateReport('mto')">
                                                    <div class="flex items-center justify-between">
                                                        <div>
                                                            <p class="text-gray-500 dark:text-gray-400 text-sm">گزارش MTO</p>
                                                            <p class="text-2xl font-bold text-gray-800 dark:text-white mt-1">مواد و مقادیر</p>
                                                        </div>
                                                        <div class="w-12 h-12 rounded-full bg-green-100 dark:bg-green-900 flex items-center justify-center">
                                                            <i class="fas fa-boxes text-green-600 dark:text-green-300 text-xl"></i>
                                                        </div>
                                                    </div>
                                                    <div class="mt-4">
                                                        <div class="flex items-center text-sm text-gray-600 dark:text-gray-300">
                                                            <i class="fas fa-file-excel text-green-500 ml-1"></i>
                                                            <span>Excel, CSV</span>
                                                        </div>
                                                    </div>
                                                </div>
                                                
                                                <div class="dashboard-card bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 border-l-4 border-purple-500 cursor-pointer" @click="generateReport('cost')">
                                                    <div class="flex items-center justify-between">
                                                        <div>
                                                            <p class="text-gray-500 dark:text-gray-400 text-sm">گزارش هزینه</p>
                                                            <p class="text-2xl font-bold text-gray-800 dark:text-white mt-1">تحلیل مالی</p>
                                                        </div>
                                                        <div class="w-12 h-12 rounded-full bg-purple-100 dark:bg-purple-900 flex items-center justify-center">
                                                            <i class="fas fa-dollar-sign text-purple-600 dark:text-purple-300 text-xl"></i>
                                                        </div>
                                                    </div>
                                                    <div class="mt-4">
                                                        <div class="flex items-center text-sm text-gray-600 dark:text-gray-300">
                                                            <i class="fas fa-chart-line text-yellow-500 ml-1"></i>
                                                            <span>نمودارها و جداول</span>
                                                        </div>
                                                    </div>
                                                </div>
                                                
                                                <div class="dashboard-card bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 border-l-4 border-red-500 cursor-pointer" @click="generateReport('drawings')">
                                                    <div class="flex items-center justify-between">
                                                        <div>
                                                            <p class="text-gray-500 dark:text-gray-400 text-sm">نقشه‌ها</p>
                                                            <p class="text-2xl font-bold text-gray-800 dark:text-white mt-1">مدارات و لیآوت</p>
                                                        </div>
                                                        <div class="w-12 h-12 rounded-full bg-red-100 dark:bg-red-900 flex items-center justify-center">
                                                            <i class="fas fa-drafting-compass text-red-600 dark:text-red-300 text-xl"></i>
                                                        </div>
                                                    </div>
                                                    <div class="mt-4">
                                                        <div class="flex items-center text-sm text-gray-600 dark:text-gray-300">
                                                            <i class="fas fa-file-image text-blue-500 ml-1"></i>
                                                            <span>DWG, DXF, PDF</span>
                                                        </div>
                                                    </div>
                                                </div>
                                                
                                                <div class="dashboard-card bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 border-l-4 border-yellow-500 cursor-pointer" @click="generateReport('documents')">
                                                    <div class="flex items-center justify-between">
                                                        <div>
                                                            <p class="text-gray-500 dark:text-gray-400 text-sm">مستندات</p>
                                                            <p class="text-2xl font-bold text-gray-800 dark:text-white mt-1">دفترچه راهنما</p>
                                                        </div>
                                                        <div class="w-12 h-12 rounded-full bg-yellow-100 dark:bg-yellow-900 flex items-center justify-center">
                                                            <i class="fas fa-book text-yellow-600 dark:text-yellow-300 text-xl"></i>
                                                        </div>
                                                    </div>
                                                    <div class="mt-4">
                                                        <div class="flex items-center text-sm text-gray-600 dark:text-gray-300">
                                                            <i class="fas fa-file-word text-blue-500 ml-1"></i>
                                                            <span>Word, PDF</span>
                                                        </div>
                                                    </div>
                                                </div>
                                                
                                                <div class="dashboard-card bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 border-l-4 border-teal-500 cursor-pointer" @click="generateReport('scenario')">
                                                    <div class="flex items-center justify-between">
                                                        <div>
                                                            <p class="text-gray-500 dark:text-gray-400 text-sm">سناریو کنترل</p>
                                                            <p class="text-2xl font-bold text-gray-800 dark:text-white mt-1">الگوریتم‌ها و کد</p>
                                                        </div>
                                                        <div class="w-12 h-12 rounded-full bg-teal-100 dark:bg-teal-900 flex items-center justify-center">
                                                            <i class="fas fa-code text-teal-600 dark:text-teal-300 text-xl"></i>
                                                        </div>
                                                    </div>
                                                    <div class="mt-4">
                                                        <div class="flex items-center text-sm text-gray-600 dark:text-gray-300">
                                                            <i class="fas fa-file-alt text-gray-500 ml-1"></i>
                                                            <span>Ladder, ST, FBD</span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            
                                            <!-- Report Content -->
                                            <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6">
                                                <h3 class="text-lg font-bold text-gray-800 dark:text-white mb-4">گزارش انتخاب شده</h3>
                                                
                                                <div x-show="selectedReport === 'bom'">
                                                    <h4 class="font-bold text-gray-800 dark:text-white mb-4">گزارش BOM - لیست مواد و تجهیزات</h4>
                                                    <div class="overflow-x-auto">
                                                        <table class="data-table">
                                                            <thead>
                                                                <tr>
                                                                    <th>گروه</th>
                                                                    <th>تعداد اقلام</th>
                                                                    <th>هزینه کل (USD)</th>
                                                                    <th>درصد از کل</th>
                                                                    <th>وضعیت</th>
                                                                </tr>
                                                            </thead>
                                                            <tbody>
                                                                <tr>
                                                                    <td>تجهیزات PLC و کنترل</td>
                                                                    <td>24</td>
                                                                    <td>$12,450</td>
                                                                    <td>32%</td>
                                                                    <td><span class="stage-indicator stage-active"></span> تایید شده</td>
                                                                </tr>
                                                                <tr>
                                                                    <td>تجهیزات الکتریکی</td>
                                                                    <td>18</td>
                                                                    <td>$8,750</td>
                                                                    <td>22%</td>
                                                                    <td><span class="stage-indicator stage-active"></span> تایید شده</td>
                                                                </tr>
                                                                <tr>
                                                                    <td>تجهیزات مکانیکی HVAC</td>
                                                                    <td>15</td>
                                                                    <td>$10,200</td>
                                                                    <td>26%</td>
                                                                    <td><span class="stage-indicator bg-yellow-500"></span> در حال بررسی</td>
                                                                </tr>
                                                                <tr>
                                                                    <td>سنسورها و ابزار دقیق</td>
                                                                    <td>12</td>
                                                                    <td>$3,850</td>
                                                                    <td>10%</td>
                                                                    <td><span class="stage-indicator stage-active"></span> تایید شده</td>
                                                                </tr>
                                                                <tr>
                                                                    <td>تجهیزات نصب و سیم‌کشی</td>
                                                                    <td>8</td>
                                                                    <td>$2,750</td>
                                                                    <td>7%</td>
                                                                    <td><span class="stage-indicator stage-inactive"></span> برنامه‌ریزی</td>
                                                                </tr>
                                                                <tr class="font-bold bg-gradient-to-r from-gray-50 to-gray-100 dark:from-gray-800 dark:to-gray-900">
                                                                    <td>جمع کل</td>
                                                                    <td>77</td>
                                                                    <td>$38,000</td>
                                                                    <td>100%</td>
                                                                    <td></td>
                                                                </tr>
                                                            </tbody>
                                                        </table>
                                                    </div>
                                                </div>
                                                
                                                <div x-show="selectedReport === 'cost'">
                                                    <h4 class="font-bold text-gray-800 dark:text-white mb-4">گزارش هزینه - تحلیل مالی پروژه</h4>
                                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                                                        <div>
                                                            <h5 class="font-bold text-gray-800 dark:text-white mb-3">توزیع هزینه‌ها</h5>
                                                            <div class="space-y-4">
                                                                <div>
                                                                    <div class="flex justify-between mb-1">
                                                                        <span class="text-gray-600 dark:text-gray-300">تجهیزات PLC</span>
                                                                        <span class="font-bold">32%</span>
                                                                    </div>
                                                                    <div class="progress-bar">
                                                                        <div class="progress-fill" style="width: 32%"></div>
                                                                    </div>
                                                                </div>
                                                                <div>
                                                                    <div class="flex justify-between mb-1">
                                                                        <span class="text-gray-600 dark:text-gray-300">تجهیزات الکتریکی</span>
                                                                        <span class="font-bold">22%</span>
                                                                    </div>
                                                                    <div class="progress-bar">
                                                                        <div class="progress-fill" style="width: 22%"></div>
                                                                    </div>
                                                                </div>
                                                                <div>
                                                                    <div class="flex justify-between mb-1">
                                                                        <span class="text-gray-600 dark:text-gray-300">تجهیزات مکانیکی</span>
                                                                        <span class="font-bold">26%</span>
                                                                    </div>
                                                                    <div class="progress-bar">
                                                                        <div class="progress-fill" style="width: 26%"></div>
                                                                    </div>
                                                                </div>
                                                                <div>
                                                                    <div class="flex justify-between mb-1">
                                                                        <span class="text-gray-600 dark:text-gray-300">سنسورها و ابزار دقیق</span>
                                                                        <span class="font-bold">10%</span>
                                                                    </div>
                                                                    <div class="progress-bar">
                                                                        <div class="progress-fill" style="width: 10%"></div>
                                                                    </div>
                                                                </div>
                                                                <div>
                                                                    <div class="flex justify-between mb-1">
                                                                        <span class="text-gray-600 dark:text-gray-300">نصب و راه‌اندازی</span>
                                                                        <span class="font-bold">7%</span>
                                                                    </div>
                                                                    <div class="progress-bar">
                                                                        <div class="progress-fill" style="width: 7%"></div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div>
                                                            <h5 class="font-bold text-gray-800 dark:text-white mb-3">خلاصه هزینه‌ها</h5>
                                                            <div class="space-y-3">
                                                                <div class="flex justify-between p-3 bg-gradient-to-r from-blue-50 to-blue-100 dark:from-blue-900 dark:to-blue-800 rounded-lg">
                                                                    <span>هزینه مواد و تجهیزات:</span>
                                                                    <span class="font-bold">$38,000</span>
                                                                </div>
                                                                <div class="flex justify-between p-3 bg-gradient-to-r from-green-50 to-green-100 dark:from-green-900 dark:to-green-800 rounded-lg">
                                                                    <span>هزینه نصب و راه‌اندازی:</span>
                                                                    <span class="font-bold">$12,000</span>
                                                                </div>
                                                                <div class="flex justify-between p-3 bg-gradient-to-r from-yellow-50 to-yellow-100 dark:from-yellow-900 dark:to-yellow-800 rounded-lg">
                                                                    <span>هزینه مهندسی و طراحی:</span>
                                                                    <span class="font-bold">$8,500</span>
                                                                </div>
                                                                <div class="flex justify-between p-3 bg-gradient-to-r from-purple-50 to-purple-100 dark:from-purple-900 dark:to-purple-800 rounded-lg">
                                                                    <span>هزینه حمل و نقل:</span>
                                                                    <span class="font-bold">$2,500</span>
                                                                </div>
                                                                <div class="flex justify-between p-3 bg-gradient-to-r from-red-50 to-red-100 dark:from-red-900 dark:to-red-800 rounded-lg font-bold">
                                                                    <span>هزینه کل پروژه:</span>
                                                                    <span>$61,000</span>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                
                                                <div x-show="selectedReport === 'scenario'">
                                                    <h4 class="font-bold text-gray-800 dark:text-white mb-4">گزارش سناریو کنترل - الگوریتم‌ها و کد PLC</h4>
                                                    <div class="bg-gradient-to-r from-gray-50 to-gray-100 dark:from-gray-700 dark:to-gray-800 rounded-xl p-6">
                                                        <h5 class="font-bold text-gray-800 dark:text-white mb-3">الگوریتم کنترل تهویه نساجی</h5>
                                                        <div class="space-y-4">
                                                            <div class="p-4 bg-white dark:bg-gray-800 rounded-lg">
                                                                <p class="font-medium text-gray-800 dark:text-white mb-2">محاسبه هوای تخلیه:</p>
                                                                <code class="text-sm text-gray-600 dark:text-gray-300">
                                                                    هوای تخلیه = درصد دمپر تخلیه × هوای برگشت × راندمان (پیش‌فرض 1)
                                                                </code>
                                                            </div>
                                                            <div class="p-4 bg-white dark:bg-gray-800 rounded-lg">
                                                                <p class="font-medium text-gray-800 dark:text-white mb-2">محاسبه هوای باقی‌مانده:</p>
                                                                <code class="text-sm text-gray-600 dark:text-gray-300">
                                                                    هوای باقی‌مانده = درصد جریان هوای برگشت که تخلیه نشده<br>
                                                                    درصد باقی‌مانده = 1 - درصد تخلیه
                                                                </code>
                                                            </div>
                                                            <div class="p-4 bg-white dark:bg-gray-800 rounded-lg">
                                                                <p class="font-medium text-gray-800 dark:text-white mb-2">کنترل دمپرها:</p>
                                                                <code class="text-sm text-gray-600 dark:text-gray-300">
                                                                    درصد باقی‌مانده و درصد تخلیه توسط موقعیت دمپر کنترل می‌شوند<br>
                                                                    دمپر تخلیه برای تخلیه هوا<br>
                                                                    دمپر تازه برای ورود هوای تازه بیرون<br>
                                                                    دمپر سیرکوله برای گردش هوای باقی‌مانده
                                                                </code>
                                                            </div>
                                                            <div class="p-4 bg-white dark:bg-gray-800 rounded-lg">
                                                                <p class="font-medium text-gray-800 dark:text-white mb-2">محاسبه دمپر تازه:</p>
                                                                <code class="text-sm text-gray-600 dark:text-gray-300">
                                                                    دمپر تازه = دمپر تخلیه + ضریب تصحیح فشار (پیش‌فرض 0)
                                                                </code>
                                                            </div>
                                                            <div class="p-4 bg-white dark:bg-gray-800 rounded-lg">
                                                                <p class="font-medium text-gray-800 dark:text-white mb-2">محاسبه هوای سیرکوله:</p>
                                                                <code class="text-sm text-gray-600 dark:text-gray-300">
                                                                    اگر شیر گرمایش باز باشد:<br>
                                                                    &nbsp;&nbsp;سیرکوله = هوای باقی‌مانده + ثابت حرارتی دمای مرطوب<br>
                                                                    در غیر این صورت:<br>
                                                                    &nbsp;&nbsp;سیرکوله = هوای باقی‌مانده
                                                                </code>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                
                                                <div x-show="!selectedReport" class="text-center py-12">
                                                    <div class="w-24 h-24 mx-auto mb-6 rounded-full bg-gradient-to-r from-blue-100 to-purple-100 dark:from-blue-900 dark:to-purple-900 flex items-center justify-center">
                                                        <i class="fas fa-chart-bar text-4xl text-blue-600 dark:text-blue-300"></i>
                                                    </div>
                                                    <h3 class="text-xl font-bold text-gray-800 dark:text-white mb-2">گزارشی انتخاب نشده است</h3>
                                                    <p class="text-gray-600 dark:text-gray-300">لطفاً یکی از گزارش‌های بالا را انتخاب کنید</p>
                                                </div>
                                            </div>
                                        </div>
                                    </main>
                                    
                                    <!-- Modals -->
                                    
                                    <!-- New Project Modal -->
                                    <div x-show="showNewProjectModal" class="modal-overlay fixed inset-0 z-50 flex items-center justify-center p-4">
                                        <div class="modal-content bg-white dark:bg-gray-800 rounded-xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto">
                                            <div class="p-6">
                                                <div class="flex items-center justify-between mb-6">
                                                    <h3 class="text-xl font-bold text-gray-800 dark:text-white">ایجاد پروژه جدید</h3>
                                                    <button @click="showNewProjectModal = false" class="text-gray-500 hover:text-gray-800 dark:hover:text-white">
                                                        <i class="fas fa-times text-xl"></i>
                                                    </button>
                                                </div>
                                                
                                                <div class="space-y-6">
                                                    <div>
                                                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">نام پروژه</label>
                                                        <input type="text" x-model="newProject.name" class="input-3d w-full p-3 rounded-lg border-0" placeholder="مثلاً: پروژه تهویه نساجی کارخانه X">
                                                    </div>
                                                    
                                                    <div>
                                                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">توضیحات</label>
                                                        <textarea x-model="newProject.description" rows="3" class="input-3d w-full p-3 rounded-lg border-0" placeholder="توضیحات پروژه..."></textarea>
                                                    </div>
                                                    
                                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                                        <div>
                                                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">محل پروژه</label>
                                                            <input type="text" x-model="newProject.location" class="input-3d w-full p-3 rounded-lg border-0" placeholder="شهر، استان">
                                                        </div>
                                                        
                                                        <div>
                                                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">نام طراح</label>
                                                            <input type="text" x-model="newProject.author" class="input-3d w-full p-3 rounded-lg border-0" placeholder="نام و نام خانوادگی">
                                                        </div>
                                                    </div>
                                                    
                                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                                        <div>
                                                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">ورژن</label>
                                                            <input type="text" x-model="newProject.version" class="input-3d w-full p-3 rounded-lg border-0" placeholder="1.0.0">
                                                        </div>
                                                        
                                                        <div>
                                                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">تاریخ</label>
                                                            <input type="date" x-model="newProject.date" class="input-3d w-full p-3 rounded-lg border-0">
                                                        </div>
                                                    </div>
                                                    
                                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                                        <div>
                                                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">هزینه تخمینی (USD)</label>
                                                            <input type="number" x-model="newProject.estimatedCost" min="0" step="1000" class="input-3d w-full p-3 rounded-lg border-0">
                                                        </div>
                                                        
                                                        <div>
                                                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">وضعیت</label>
                                                            <select x-model="newProject.status" class="input-3d w-full p-3 rounded-lg border-0">
                                                                <option value="planned">برنامه‌ریزی</option>
                                                                <option value="in-progress">در حال انجام</option>
                                                                <option value="completed">تکمیل</option>
                                                            </select>
                                                        </div>
                                                    </div>
                                                    
                                                    <div>
                                                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">پیشرفت پروژه (%)</label>
                                                        <input type="range" x-model="newProject.progress" min="0" max="100" step="5" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer">
                                                        <div class="flex justify-between mt-2">
                                                            <span class="text-sm text-gray-600 dark:text-gray-300">0%</span>
                                                            <span class="text-sm font-bold" x-text="newProject.progress + '%'"></span>
                                                            <span class="text-sm text-gray-600 dark:text-gray-300">100%</span>
                                                        </div>
                                                    </div>
                                                </div>
                                                
                                                <div class="flex justify-end space-x-3 space-x-reverse mt-8">
                                                    <button @click="showNewProjectModal = false" class="px-6 py-3 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700">
                                                        انصراف
                                                    </button>
                                                    <button @click="saveNewProject()" class="btn-primary px-6 py-3 rounded-lg">
                                                        ذخیره پروژه
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- Notification Toast -->
                                    <div x-show="showNotification" 
                                         x-transition:enter="transition ease-out duration-300"
                                         x-transition:enter-start="opacity-0 translate-x-full"
                                         x-transition:enter-end="opacity-100 translate-x-0"
                                         x-transition:leave="transition ease-in duration-200"
                                         x-transition:leave-start="opacity-100 translate-x-0"
                                         x-transition:leave-end="opacity-0 translate-x-full"
                                         class="notification">
                                        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg p-4 max-w-sm border-l-4"
                                             :class="{
                                                 'border-green-500': notificationType === 'success',
                                                 'border-blue-500': notificationType === 'info',
                                                 'border-yellow-500': notificationType === 'warning',
                                                 'border-red-500': notificationType === 'error'
                                             }">
                                            <div class="flex items-start">
                                                <div class="flex-shrink-0">
                                                    <i class="fas text-xl"
                                                       :class="{
                                                           'fa-check-circle text-green-500': notificationType === 'success',
                                                           'fa-info-circle text-blue-500': notificationType === 'info',
                                                           'fa-exclamation-triangle text-yellow-500': notificationType === 'warning',
                                                           'fa-exclamation-circle text-red-500': notificationType === 'error'
                                                       }"></i>
                                                </div>
                                                <div class="mr-3 w-0 flex-1">
                                                    <p class="font-medium text-gray-800 dark:text-white" x-text="notificationTitle"></p>
                                                    <p class="mt-1 text-sm text-gray-600 dark:text-gray-300" x-text="notificationMessage"></p>
                                                </div>
                                                <button @click="showNotification = false" class="flex-shrink-0 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300">
                                                    <i class="fas fa-times"></i>
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- Loading Overlay -->
                                    <div x-show="isLoading" class="fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center">
                                        <div class="bg-white dark:bg-gray-800 rounded-xl p-8 flex flex-col items-center">
                                            <div class="w-16 h-16 rounded-full border-4 border-blue-500 border-t-transparent animate-spin mb-4"></div>
                                            <p class="text-gray-800 dark:text-white font-medium">در حال بارگذاری...</p>
                                        </div>
                                    </div>
                                    
                                    <script>
                                        function app() {
                                            return {
                                                // App State
                                                activeTab: 'dashboard',
                                                darkMode: false,
                                                isLoading: false,
                                                userMenuOpen: false,
                                                notificationsOpen: false,
                                                projectMenuOpen: null,
                                                showNewProjectModal: false,
                                                showACStationModal: false,
                                                showPLCModal: false,
                                                
                                                // AC Station State
                                                acStationTab: 'airflow',
                                                
                                                // Reports
                                                selectedReport: null,
                                                
                                                // BOM
                                                bomFilter: 'all',
                                                bomSearch: '',
                                                
                                                // Notifications
                                                showNotification: false,
                                                notificationTitle: '',
                                                notificationMessage: '',
                                                notificationType: 'info',
                                                notifications: [
                                                    { id: 1, title: 'پروژه جدید ایجاد شد', message: 'پروژه تهویه نساجی کارخانه X با موفقیت ایجاد شد.', type: 'success', time: '۵ دقیقه پیش', read: false },
                                                    { id: 2, title: 'محاسبات HVAC تکمیل شد', message: 'محاسبات بار حرارتی و برودتی با موفقیت انجام شد.', type: 'info', time: '۱ ساعت پیش', read: false },
                                                    { id: 3, title: 'BOM به‌روزرسانی شد', message: 'لیست مواد و تجهیزات با آخرین تغییرات به‌روزرسانی شد.', type: 'success', time: '۲ ساعت پیش', read: true },
                                                    { id: 4, title: 'هشدار: سرعت هوا زیاد است', message: 'سرعت هوا در کانال اصلی از حد مجاز بیشتر است.', type: 'warning', time: '۵ ساعت پیش', read: true },
                                                    { id: 5, title: 'ارسال موفق گزارش', message: 'گزارش BOM با موفقیت به ایمیل ارسال شد.', type: 'success', time: '۱ روز پیش', read: true }
                                                ],
                                                unreadNotifications: 2,
                                                
                                                // Dashboard Stats
                                                projectCount: 5,
                                                saloonCount: 12,
                                                acStationCount: 8,
                                                totalBomCost: 38500,
                                                
                                                // Projects
                                                projects: [
                                                    { id: 1, name: 'تهویه نساجی کارخانه کاشان', location: 'کاشان، اصفهان', description: 'طراحی کامل سیستم تهویه برای سالن‌های ریسندگی', status: 'completed', progress: 100, estimatedCost: 45000, author: 'مهندس احمدی', date: '1402/05/15', version: '1.2.0' },
                                                    { id: 2, name: 'فیلتر پلن کارخانه یزد', location: 'یزد', description: 'طراحی سیستم فیلتراسیون برای کارخانه پنبه', status: 'in-progress', progress: 75, estimatedCost: 32000, author: 'مهندس رضایی', date: '1402/06/20', version: '1.0.5' },
                                                    { id: 3, name: 'ایستگاه تهویه کارخانه تهران', location: 'تهران', description: 'طراحی ایستگاه تهویه مرکزی برای سالن بافندگی', status: 'in-progress', progress: 60, estimatedCost: 28000, author: 'مهندس محمدی', date: '1402/07/10', version: '1.1.0' },
                                                    { id: 4, name: 'سیستم کنترل PLC کارخانه مشهد', location: 'مشهد', description: 'طراحی سیستم کنترل PLC برای خط تولید', status: 'planned', progress: 10, estimatedCost: 18500, author: 'مهندس کریمی', date: '1402/08/05', version: '0.9.0' },
                                                    { id: 5, name: 'به‌روزرسانی سیستم قدیمی تبریز', location: 'تبریز', description: 'نوسازی سیستم تهویه کارخانه نساجی قدیمی', status: 'planned', progress: 5, estimatedCost: 52000, author: 'مهندس حسینی', date: '1402/08/15', version: '0.5.0' }
                                                ],
                                                recentProjects: [
                                                    { id: 1, name: 'تهویه نساجی کارخانه کاشان', location: 'کاشان، اصفهان', status: 'completed', estimatedCost: 45000, date: '1402/05/15' },
                                                    { id: 2, name: 'فیلتر پلن کارخانه یزد', location: 'یزد', status: 'in-progress', estimatedCost: 32000, date: '1402/06/20' },
                                                    { id: 3, name: 'ایستگاه تهویه کارخانه تهران', location: 'تهران', status: 'in-progress', estimatedCost: 28000, date: '1402/07/10' }
                                                ],
                                                
                                                // New Project
                                                newProject: {
                                                    name: '',
                                                    description: '',
                                                    location: '',
                                                    author: '',
                                                    version: '1.0.0',
                                                    date: new Date().toISOString().split('T')[0],
                                                    estimatedCost: 0,
                                                    status: 'planned',
                                                    progress: 0
                                                },
                                                
                                                // Quick Calculations
                                                quickCalc: {
                                                    airflow: 25,
                                                    inletTemp: 35,
                                                    outletTemp: 27,
                                                    inletHumidity: 40,
                                                    outletHumidity: 65
                                                },
                                                quickCalcResult: null,
                                                
                                                // AC Station Design
                                                acStation: {
                                                    spaces: [
                                                        { name: 'سالن ریسندگی', length: 44, width: 35, height: 5, ach: 35, volume: 0, airflow: 0 }
                                                    ]
                                                },
                                                
                                                // Duct Design
                                                ductDesign: {
                                                    feed: {
                                                        branches: 3,
                                                        velocity: 6,
                                                        pressure: 300,
                                                        calculated: false,
                                                        totalArea: 0,
                                                        branchArea: 0,
                                                        standardSize: '',
                                                        pressureDrop: 0
                                                    },
                                                    return: {
                                                        underground: true,
                                                        branches: 2,
                                                        velocity: 4,
                                                        calculated: false,
                                                        totalArea: 0,
                                                        branchArea: 0,
                                                        standardSize: ''
                                                    }
                                                },
                                                
                                                // Vent Design
                                                ventDesign: {
                                                    feed: {
                                                        count: 15,
                                                        width: 0.7,
                                                        length: 1.4,
                                                        velocity: 2.3,
                                                        calculated: false,
                                                        area: 0,
                                                        totalArea: 0,
                                                        totalAirflow: 0
                                                    },
                                                    return: {
                                                        type: 'narrow',
                                                        countPerDuct: 10,
                                                        velocity: 3.2,
                                                        calculated: false,
                                                        width: 0.05,
                                                        area: 0,
                                                        totalArea: 0,
                                                        totalCount: 0
                                                    }
                                                },
                                                
                                                // ARF Design
                                                arfDesign: {
                                                    diameter: 2.5,
                                                    length: 3.4,
                                                    count: 2,
                                                    velocity: 1.2,
                                                    calculated: false,
                                                    area: 0,
                                                    totalArea: 0,
                                                    totalAirflow: 0,
                                                    actualVelocity: 0
                                                },
                                                
                                                // Damper Design
                                                damperDesign: {
                                                    fresh: {
                                                        count: 2,
                                                        width: 1.2,
                                                        height: 0.8,
                                                        voltage: '24',
                                                        airflow: 0
                                                    },
                                                    exhaust: {
                                                        count: 2,
                                                        width: 1.2,
                                                        height: 0.8,
                                                        voltage: '24',
                                                        airflow: 0
                                                    },
                                                    return: {
                                                        count: 2,
                                                        width: 1.2,
                                                        height: 0.8,
                                                        voltage: '24',
                                                        airflow: 0
                                                    },
                                                    velocity: 5.8,
                                                    calculated: false
                                                },
                                                
                                                // Coil Design
                                                coilDesign: {
                                                    rows: 2,
                                                    height: 1.2,
                                                    width: 2.5,
                                                    inletTemp: 15,
                                                    outletTemp: 27,
                                                    calculated: false,
                                                    area: 0,
                                                    heatingLoad: 0,
                                                    steamConsumption: 0,
                                                    pressureDrop: 0
                                                },
                                                
                                                // AirWasher Design
                                                airwasherDesign: {
                                                    height: 2.5,
                                                    width: 3.8,
                                                    zones: 2,
                                                    collectorDiameter: 4,
                                                    calculated: false,
                                                    area: 0,
                                                    velocity: 0,
                                                    totalNozzles: 0,
                                                    totalWaterFlow: 0,
                                                    pumpHead: 35,
                                                    pumpEfficiency: 75,
                                                    pipeDiameter: 65,
                                                    pumpCalculated: false,
                                                    pumpPower: 0,
                                                    pumpSuggestion: ''
                                                },
                                                
                                                // Fan Design
                                                fanDesign: {
                                                    type: 'axial',
                                                    diameter: 1600,
                                                    blades: 10,
                                                    rpm: 1000,
                                                    totalPressure: 800,
                                                    calculated: false,
                                                    power: 0,
                                                    airflow: 0,
                                                    efficiency: 0,
                                                    tipSpeed: 0,
                                                    motorSuggestion: ''
                                                },
                                                
                                                // PLC Design
                                                plcDesign: {
                                                    motors: {
                                                        fanFeed: { count: 2, power: 22 },
                                                        fanReturn: { count: 2, power: 30 },
                                                        pump: { count: 1, power: 30 }
                                                    },
                                                    actuators: {
                                                        damperFresh: { count: 2, voltage: '24' },
                                                        damperExhaust: { count: 2, voltage: '24' },
                                                        damperReturn: { count: 2, voltage: '24' },
                                                        steamValve: { count: 1, voltage: '24' }
                                                    },
                                                    sensors: {
                                                        temperature: { count: 2, type: '4-20ma' },
                                                        humidity: { count: 2, type: '4-20ma' },
                                                        microSwitch: { count: 5 },
                                                        pressure: 2
                                                    },
                                                    safety: {
                                                        emergencyButtons: 3
                                                    },
                                                    indicators: {
                                                        lamps: 8
                                                    },
                                                    optional: {
                                                        vfd: { count: 0, power: 30 },
                                                        softStarter: { count: 1, power: 30 },
                                                        hmi: { count: 1, size: '7' },
                                                        cabinetTemp: { count: 1, enabled: false }
                                                    },
                                                    layout: {
                                                        plc: { width: 30, height: 25, margin: 5 },
                                                        vfd: { width: 40, height: 40, margin: 5 },
                                                        softStarter: { width: 40, height: 20, margin: 4 },
                                                        contactor: { width: 16, height: 20, margin: 4 },
                                                        relay: { width: 2, height: 10, margin: 0 },
                                                        cabinetWidth: 120,
                                                        cabinetHeight: 200,
                                                        cabinetDepth: 50
                                                    }
                                                },
                                                
                                                // BOM
                                                bomItems: [
                                                    { id: 1, code: 'PLC-CPU-001', description: 'واحد پردازش مرکزی PLC', specs: 'SIMATIC S7-1200 CPU 1214C', standard: 'IEC 61131', quantity: 1, unit: 'عدد', unitPrice: 1200, supplier: 'Siemens', category: 'plc' },
                                                    { id: 2, code: 'PLC-DI-002', description: 'ماژول ورودی دیجیتال', specs: '16 DI 24VDC', standard: 'IEC 61131', quantity: 2, unit: 'عدد', unitPrice: 250, supplier: 'Siemens', category: 'plc' },
                                                    { id: 3, code: 'PLC-DO-003', description: 'ماژول خروجی دیجیتال', specs: '16 DO Relay 10A', standard: 'IEC 61131', quantity: 2, unit: 'عدد', unitPrice: 300, supplier: 'Siemens', category: 'plc' },
                                                    { id: 4, code: 'PLC-AI-004', description: 'ماژول ورودی آنالوگ', specs: '8 AI 4-20mA/0-10V', standard: 'IEC 61131', quantity: 1, unit: 'عدد', unitPrice: 450, supplier: 'Siemens', category: 'plc' },
                                                    { id: 5, code: 'MTR-FAN-005', description: 'موتور فن رفت', specs: '22kW, 1500RPM, 3Phase', standard: 'IEC 60034', quantity: 2, unit: 'عدد', unitPrice: 1850, supplier: 'ABB', category: 'electrical' },
                                                    { id: 6, code: 'MTR-FAN-006', description: 'موتور فن برگشت', specs: '30kW, 1500RPM, 3Phase', standard: 'IEC 60034', quantity: 2, unit: 'عدد', unitPrice: 2450, supplier: 'ABB', category: 'electrical' },
                                                    { id: 7, code: 'VFD-007', description: 'درایو فرکانس متغیر', specs: '30kW, 3Phase, IP54', standard: 'IEC 61800', quantity: 1, unit: 'عدد', unitPrice: 3200, supplier: 'Danfoss', category: 'electrical' },
                                                    { id: 8, code: 'SNS-TEMP-008', description: 'سنسور دما', specs: 'PT100, 4-20mA, -50 to 150°C', standard: 'IEC 60751', quantity: 2, unit: 'عدد', unitPrice: 120, supplier: 'Endress+Hauser', category: 'sensors' },
                                                    { id: 9, code: 'SNS-HUM-009', description: 'سنسور رطوبت', specs: '0-100%RH, 4-20mA', standard: 'IEC 60751', quantity: 2, unit: 'عدد', unitPrice: 180, supplier: 'Vaisala', category: 'sensors' },
                                                    { id: 10, code: 'DUCT-010', description: 'کانال رفت گالوانیزه', specs: '1200x600mm, 1mm thickness', standard: 'SMACNA', quantity: 45, unit: 'متر', unitPrice: 85, supplier: 'محلی', category: 'hvac' },
                                                    { id: 11, code: 'FILTER-011', description: 'فیلتر دورانی (ARF)', specs: 'قطر 2.5m, طول 3.4m', standard: 'ASHRAE 52.2', quantity: 2, unit: 'عدد', unitPrice: 4200, supplier: 'Luwa', category: 'hvac' },
                                                    { id: 12, code: 'DAMPER-012', description: 'دمپر هوای تازه', specs: '1200x800mm, 24VDC Actuator', standard: 'AMCA 500', quantity: 2, unit: 'عدد', unitPrice: 850, supplier: 'Trox', category: 'hvac' }
                                                ],
                                                totalMaterialCost: 38500,
                                                installationCost: 12000,
                                                
                                                // Computed Properties
                                                get totalAirflow() {
                                                    return this.acStation.spaces.reduce((sum, space) => sum + space.airflow, 0);
                                                },
                                                get stationCount() {
                                                    return this.totalAirflow > 100 ? 2 : 1;
                                                },
                                                get stationAirflow() {
                                                    return this.totalAirflow / this.stationCount;
                                                },
                                                get totalMotors() {
                                                    const motors = this.plcDesign.motors;
                                                    return motors.fanFeed.count + motors.fanReturn.count + motors.pump.count;
                                                },
                                                get totalMotorPower() {
                                                    const motors = this.plcDesign.motors;
                                                    return (motors.fanFeed.count * motors.fanFeed.power) + 
                                                           (motors.fanReturn.count * motors.fanReturn.power) + 
                                                           (motors.pump.count * motors.pump.power);
                                                },
                                                get totalActuators() {
                                                    const actuators = this.plcDesign.actuators;
                                                    return actuators.damperFresh.count + actuators.damperExhaust.count + 
                                                           actuators.damperReturn.count + actuators.steamValve.count;
                                                },
                                                get totalDI() {
                                                    return this.plcDesign.sensors.microSwitch.count + this.plcDesign.safety.emergencyButtons;
                                                },
                                                get totalDO() {
                                                    return (this.totalMotors * 2) + this.totalActuators + this.plcDesign.indicators.lamps;
                                                },
                                                get totalAI() {
                                                    return this.plcDesign.sensors.temperature.count + this.plcDesign.sensors.humidity.count + 
                                                           this.totalActuators + this.plcDesign.sensors.pressure;
                                                },
                                                get totalAO() {
                                                    return this.plcDesign.optional.vfd.count;
                                                },
                                                get filteredBOM() {
                                                    let items = this.bomItems;
                                                    
                                                    // Apply category filter
                                                    if (this.bomFilter !== 'all') {
                                                        items = items.filter(item => item.category === this.bomFilter);
                                                    }
                                                    
                                                    // Apply search filter
                                                    if (this.bomSearch) {
                                                        const searchTerm = this.bomSearch.toLowerCase();
                                                        items = items.filter(item => 
                                                            item.code.toLowerCase().includes(searchTerm) ||
                                                            item.description.toLowerCase().includes(searchTerm) ||
                                                            item.specs.toLowerCase().includes(searchTerm)
                                                        );
                                                    }
                                                    
                                                    return items;
                                                },
                                                get totalBOMCost() {
                                                    return this.filteredBOM.reduce((sum, item) => sum + (item.quantity * item.unitPrice), 0);
                                                },
                                                
                                                // Methods
                                                initApp() {
                                                    // Calculate initial space
                                                    this.calculateSpace(this.acStation.spaces[0]);
                                                    console.log('App initialized');
                                                },
                                                
                                                showNotificationFunc(title, message, type = 'info') {
                                                    this.notificationTitle = title;
                                                    this.notificationMessage = message;
                                                    this.notificationType = type;
                                                    this.showNotification = true;
                                                    
                                                    // Auto hide after 5 seconds
                                                    setTimeout(() => {
                                                        this.showNotification = false;
                                                    }, 5000);
                                                },
                                                
                                                markNotificationRead(id) {
                                                    const notification = this.notifications.find(n => n.id === id);
                                                    if (notification && !notification.read) {
                                                        notification.read = true;
                                                        this.unreadNotifications--;
                                                    }
                                                },
                                                
                                                clearNotifications() {
                                                    this.notifications = [];
                                                    this.unreadNotifications = 0;
                                                    this.notificationsOpen = false;
                                                },
                                                
                                                logout() {
                                                    this.showNotificationFunc('خروج از سیستم', 'شما با موفقیت از سیستم خارج شدید.', 'info');
                                                    this.userMenuOpen = false;
                                                },
                                                
                                                // Project Methods
                                                newProject() {
                                                    this.newProject = {
                                                        name: '',
                                                        description: '',
                                                        location: '',
                                                        author: 'مهندس سیستم',
                                                        version: '1.0.0',
                                                        date: new Date().toISOString().split('T')[0],
                                                        estimatedCost: 0,
                                                        status: 'planned',
                                                        progress: 0
                                                    };
                                                    this.showNewProjectModal = true;
                                                },
                                                
                                                saveNewProject() {
                                                    if (!this.newProject.name.trim()) {
                                                        this.showNotificationFunc('خطا', 'لطفا نام پروژه را وارد کنید.', 'error');
                                                        return;
                                                    }
                                                    
                                                    const newId = this.projects.length > 0 ? Math.max(...this.projects.map(p => p.id)) + 1 : 1;
                                                    
                                                    this.projects.unshift({
                                                        id: newId,
                                                        ...this.newProject
                                                    });
                                                    
                                                    this.projectCount++;
                                                    this.showNewProjectModal = false;
                                                    this.showNotificationFunc('موفق', `پروژه "${this.newProject.name}" با موفقیت ایجاد شد.`, 'success');
                                                },
                                                
                                                openProject(id) {
                                                    const project = this.projects.find(p => p.id === id);
                                                    if (project) {
                                                        this.showNotificationFunc('باز کردن پروژه', `پروژه "${project.name}" باز شد.`, 'info');
                                                        // In a real app, you would load the project data here
                                                    }
                                                },
                                                
                                                editProject(id) {
                                                    const project = this.projects.find(p => p.id === id);
                                                    if (project) {
                                                        this.newProject = { ...project };
                                                        this.showNewProjectModal = true;
                                                    }
                                                },
                                                
                                                duplicateProject(id) {
                                                    const project = this.projects.find(p => p.id === id);
                                                    if (project) {
                                                        const newId = this.projects.length > 0 ? Math.max(...this.projects.map(p => p.id)) + 1 : 1;
                                                        const duplicated = {
                                                            ...project,
                                                            id: newId,
                                                            name: `${project.name} (کپی)`,
                                                            date: new Date().toISOString().split('T')[0]
                                                        };
                                                        
                                                        this.projects.unshift(duplicated);
                                                        this.projectCount++;
                                                        this.showNotificationFunc('موفق', `پروژه "${project.name}" با موفقیت تکثیر شد.`, 'success');
                                                    }
                                                },
                                                
                                                deleteProject(id) {
                                                    if (confirm('آیا از حذف این پروژه اطمینان دارید؟')) {
                                                        const index = this.projects.findIndex(p => p.id === id);
                                                        if (index !== -1) {
                                                            const projectName = this.projects[index].name;
                                                            this.projects.splice(index, 1);
                                                            this.projectCount--;
                                                            this.showNotificationFunc('موفق', `پروژه "${projectName}" با موفقیت حذف شد.`, 'success');
                                                        }
                                                    }
                                                },
                                                
                                                exportProject(id) {
                                                    const project = this.projects.find(p => p.id === id);
                                                    if (project) {
                                                        this.showNotificationFunc('خروجی', `پروژه "${project.name}" برای خروجی آماده شد.`, 'info');
                                                        // In a real app, you would generate export file here
                                                    }
                                                },
                                                
                                                // AC Station Methods
                                                newACStation() {
                                                    this.showACStationModal = true;
                                                },
                                                
                                                addSpace() {
                                                    this.acStation.spaces.push({
                                                        name: `فضای ${this.acStation.spaces.length + 1}`,
                                                        length: 20,
                                                        width: 15,
                                                        height: 4,
                                                        ach: 30,
                                                        volume: 0,
                                                        airflow: 0
                                                    });
                                                    this.calculateSpace(this.acStation.spaces[this.acStation.spaces.length - 1]);
                                                },
                                                
                                                calculateSpace(space) {
                                                    space.volume = space.length * space.width * space.height;
                                                    space.airflow = (space.volume * space.ach) / 3600;
                                                },
                                                
                                                removeSpace(index) {
                                                    this.acStation.spaces.splice(index, 1);
                                                },
                                                
                                                calculateHVAC() {
                                                    const { airflow, inletTemp, outletTemp, inletHumidity, outletHumidity } = this.quickCalc;
                                                    
                                                    // Simplified HVAC calculations
                                                    const tempDifference = inletTemp - outletTemp;
                                                    const heatingLoad = Math.max(0, tempDifference) * airflow * 1.2 * 1.2;
                                                    const coolingLoad = Math.max(0, -tempDifference) * airflow * 1.2 * 1.2;
                                                    const dehumidification = Math.max(0, inletHumidity - outletHumidity) * airflow * 0.8;
                                                    const humidification = Math.max(0, outletHumidity - inletHumidity) * airflow * 0.8;
                                                    
                                                    this.quickCalcResult = {
                                                        heating: heatingLoad.toFixed(1),
                                                        cooling: coolingLoad.toFixed(1),
                                                        dehumidification: dehumidification.toFixed(1),
                                                        humidification: humidification.toFixed(1)
                                                    };
                                                    
                                                    this.showNotificationFunc('محاسبات HVAC', 'محاسبات بار حرارتی و برودتی با موفقیت انجام شد.', 'success');
                                                },
                                                
                                                calculateFeedDuct() {
                                                    const { branches, velocity, pressure } = this.ductDesign.feed;
                                                    const airflow = this.stationAirflow;
                                                    
                                                    this.ductDesign.feed.totalArea = airflow / velocity;
                                                    this.ductDesign.feed.branchArea = this.ductDesign.feed.totalArea / branches;
                                                    
                                                    // Determine standard size
                                                    const area = this.ductDesign.feed.branchArea;
                                                    let width, height;
                                                    
                                                    if (area <= 0.5) {
                                                        width = 0.4;
                                                        height = 0.4;
                                                    } else if (area <= 1.0) {
                                                        width = 0.6;
                                                        height = 0.6;
                                                    } else if (area <= 1.5) {
                                                        width = 0.8;
                                                        height = 0.8;
                                                    } else {
                                                        width = 1.0;
                                                        height = 1.0;
                                                    }
                                                    
                                                    this.ductDesign.feed.standardSize = `${width * 100} × ${height * 100} cm`;
                                                    this.ductDesign.feed.pressureDrop = pressure * 0.8;
                                                    this.ductDesign.feed.calculated = true;
                                                    
                                                    this.showNotificationFunc('محاسبه کانال رفت', 'محاسبات کانال رفت با موفقیت انجام شد.', 'success');
                                                },
                                                
                                                calculateReturnDuct() {
                                                    const { branches, velocity } = this.ductDesign.return;
                                                    const airflow = this.stationAirflow;
                                                    
                                                    this.ductDesign.return.totalArea = airflow / velocity;
                                                    this.ductDesign.return.branchArea = this.ductDesign.return.totalArea / branches;
                                                    
                                                    // Determine standard size
                                                    const area = this.ductDesign.return.branchArea;
                                                    let width, height;
                                                    
                                                    if (area <= 0.5) {
                                                        width = 0.5;
                                                        height = 0.4;
                                                    } else if (area <= 1.0) {
                                                        width = 0.8;
                                                        height = 0.6;
                                                    } else if (area <= 1.5) {
                                                        width = 1.2;
                                                        height = 0.8;
                                                    } else {
                                                        width = 1.5;
                                                        height = 1.0;
                                                    }
                                                    
                                                    this.ductDesign.return.standardSize = `${width * 100} × ${height * 100} cm`;
                                                    this.ductDesign.return.calculated = true;
                                                    
                                                    this.showNotificationFunc('محاسبه کانال برگشت', 'محاسبات کانال برگشت با موفقیت انجام شد.', 'success');
                                                },
                                                
                                                calculateFeedVent() {
                                                    const { count, width, length, velocity } = this.ventDesign.feed;
                                                    
                                                    this.ventDesign.feed.area = width * length;
                                                    this.ventDesign.feed.totalArea = this.ventDesign.feed.area * count;
                                                    this.ventDesign.feed.totalAirflow = this.ventDesign.feed.totalArea * velocity;
                                                    this.ventDesign.feed.calculated = true;
                                                    
                                                    this.showNotificationFunc('محاسبه دریچه رفت', 'محاسبات دریچه‌های رفت با موفقیت انجام شد.', 'success');
                                                },
                                                
                                                calculateReturnVent() {
                                                    const { countPerDuct, velocity, type } = this.ventDesign.return;
                                                    
                                                    // Set width based on type
                                                    this.ventDesign.return.width = type === 'narrow' ? 0.05 : 0.5;
                                                    
                                                    // Assume duct width from duct design
                                                    const ductWidth = this.ductDesign.return.branchArea <= 1.0 ? 0.8 : 1.2;
                                                    this.ventDesign.return.area = this.ventDesign.return.width * ductWidth;
                                                    this.ventDesign.return.totalCount = countPerDuct * this.ductDesign.return.branches;
                                                    this.ventDesign.return.totalArea = this.ventDesign.return.area * this.ventDesign.return.totalCount;
                                                    this.ventDesign.return.calculated = true;
                                                    
                                                    this.showNotificationFunc('محاسبه دریچه برگشت', 'محاسبات دریچه‌های برگشت با موفقیت انجام شد.', 'success');
                                                },
                                                
                                                calculateARF() {
                                                    const { diameter, length, count, velocity } = this.arfDesign;
                                                    
                                                    this.arfDesign.area = Math.PI * diameter * length;
                                                    this.arfDesign.totalArea = this.arfDesign.area * count;
                                                    this.arfDesign.totalAirflow = this.arfDesign.totalArea * velocity;
                                                    this.arfDesign.actualVelocity = this.stationAirflow / this.arfDesign.totalArea;
                                                    this.arfDesign.calculated = true;
                                                    
                                                    this.showNotificationFunc('محاسبه فیلتر دورانی', 'محاسبات فیلتر دورانی با موفقیت انجام شد.', 'success');
                                                },
                                                
                                                calculateDampers() {
                                                    const { fresh, exhaust, return: returnDamper, velocity } = this.damperDesign;
                                                    
                                                    // Calculate effective area for each damper
                                                    const freshArea = fresh.width * fresh.height * fresh.count * 0.92;
                                                    const exhaustArea = exhaust.width * exhaust.height * exhaust.count * 0.92;
                                                    const returnArea = returnDamper.width * returnDamper.height * returnDamper.count * 0.92;
                                                    
                                                    // Calculate airflow
                                                    this.damperDesign.fresh.airflow = freshArea * velocity;
                                                    this.damperDesign.exhaust.airflow = exhaustArea * velocity;
                                                    this.damperDesign.return.airflow = returnArea * velocity;
                                                    this.damperDesign.calculated = true;
                                                    
                                                    this.showNotificationFunc('محاسبه دمپرها', 'محاسبات دمپرها با موفقیت انجام شد.', 'success');
                                                },
                                                
                                                calculateCoil() {
                                                    const { rows, height, width, inletTemp, outletTemp } = this.coilDesign;
                                                    
                                                    this.coilDesign.area = height * width * rows;
                                                    
                                                    // Simplified heating load calculation
                                                    const tempDifference = outletTemp - inletTemp;
                                                    const airflow = this.stationAirflow;
                                                    this.coilDesign.heatingLoad = Math.max(0, tempDifference) * airflow * 1.2 * 1.2;
                                                    
                                                    // Steam consumption (approx 0.65 kg/kWh)
                                                    this.coilDesign.steamConsumption = this.coilDesign.heatingLoad * 0.65;
                                                    
                                                    // Pressure drop (simplified)
                                                    this.coilDesign.pressureDrop = rows * 25;
                                                    this.coilDesign.calculated = true;
                                                    
                                                    this.showNotificationFunc('محاسبه کویل گرمایش', 'محاسبات کویل گرمایش با موفقیت انجام شد.', 'success');
                                                },
                                                
                                                calculateAirwasher() {
                                                    const { height, width, zones, collectorDiameter } = this.airwasherDesign;
                                                    
                                                    this.airwasherDesign.area = height * width;
                                                    this.airwasherDesign.velocity = this.stationAirflow / this.airwasherDesign.area;
                                                    
                                                    // Calculate number of nozzles
                                                    const riserLength = height - (collectorDiameter * 0.0254); // Convert inches to meters
                                                    const nozzleSpace = 0.076; // 76mm in meters
                                                    const nozzlesPerRiser = Math.floor(riserLength / nozzleSpace);
                                                    const riserSpace = 0.304; // 304mm in meters
                                                    const risersPerZone = Math.floor(width / riserSpace) - 1;
                                                    const totalNozzles = zones * risersPerZone * nozzlesPerRiser;
                                                    
                                                    this.airwasherDesign.totalNozzles = totalNozzles;
                                                    this.airwasherDesign.totalWaterFlow = totalNozzles * 2.5; // 2.5 L/min per nozzle
                                                    this.airwasherDesign.calculated = true;
                                                    
                                                    this.showNotificationFunc('محاسبه ایرواشر', 'محاسبات ایرواشر با موفقیت انجام شد.', 'success');
                                                },
                                                
                                                calculatePump() {
                                                    const { totalWaterFlow, pumpHead, pumpEfficiency, pipeDiameter } = this.airwasherDesign;
                                                    
                                                    // Convert L/min to m³/s
                                                    const flowRate = totalWaterFlow / 60000;
                                                    
                                                    // Pump power calculation: P = (ρ * g * Q * H) / η
                                                    const rho = 1000; // Water density kg/m³
                                                    const g = 9.81; // Gravity m/s²
                                                    const power = (rho * g * flowRate * pumpHead) / (pumpEfficiency * 1000); // in kW
                                                    
                                                    this.airwasherDesign.pumpPower = power;
                                                    
                                                    // Pump suggestion based on power
                                                    if (power < 5) {
                                                        this.airwasherDesign.pumpSuggestion = 'پمپ سانتریفیوژ 5.5 کیلووات با هد 35 متر';
                                                    } else if (power < 10) {
                                                        this.airwasherDesign.pumpSuggestion = 'پمپ سانتریفیوژ 11 کیلووات با هد 35 متر';
                                                    } else {
                                                        this.airwasherDesign.pumpSuggestion = 'پمپ سانتریفیوژ 15 کیلووات با هد 35 متر';
                                                    }
                                                    
                                                    this.airwasherDesign.pumpCalculated = true;
                                                    
                                                    this.showNotificationFunc('محاسبه پمپ', 'محاسبات پمپ آب با موفقیت انجام شد.', 'success');
                                                },
                                                
                                                calculateFan() {
                                                    const { diameter, rpm, totalPressure } = this.fanDesign;
                                                    
                                                    // Simplified fan calculations
                                                    const radius = diameter / 2000; // Convert mm to m
                                                    const tipSpeed = (2 * Math.PI * radius * rpm) / 60;
                                                    
                                                    // Airflow based on fan type and size
                                                    let airflow;
                                                    if (this.fanDesign.type === 'axial') {
                                                        airflow = Math.PI * radius * radius * 15; // Approximate
                                                    } else {
                                                        airflow = Math.PI * radius * radius * 12; // Approximate for centrifugal
                                                    }
                                                    
                                                    // Fan power: P = (Q * ΔP) / η
                                                    const efficiency = 0.75; // Assume 75% efficiency
                                                    const power = (airflow * totalPressure) / (efficiency * 1000); // in kW
                                                    
                                                    this.fanDesign.tipSpeed = tipSpeed;
                                                    this.fanDesign.airflow = airflow;
                                                    this.fanDesign.power = power;
                                                    this.fanDesign.efficiency = efficiency * 100;
                                                    
                                                    // Motor suggestion
                                                    const motorPower = power * 1.2; // Add 20% margin
                                                    this.fanDesign.motorSuggestion = `موتور ${motorPower.toFixed(1)} کیلووات، ${rpm} RPM`;
                                                    
                                                    this.fanDesign.calculated = true;
                                                    
                                                    this.showNotificationFunc('محاسبه فن', 'محاسبات فن با موفقیت انجام شد.', 'success');
                                                },
                                                
                                                calculateACStation() {
                                                    this.showNotificationFunc('محاسبه ایستگاه تهویه', 'تمام محاسبات ایستگاه تهویه با موفقیت انجام شد.', 'success');
                                                },
                                                
                                                // PLC Methods
                                                newPLCProject() {
                                                    this.showPLCModal = true;
                                                },
                                                
                                                loadTemplate(template) {
                                                    switch(template) {
                                                        case 'soft-starter':
                                                            this.plcDesign = {
                                                                motors: {
                                                                    fanFeed: { count: 2, power: 22 },
                                                                    fanReturn: { count: 2, power: 30 },
                                                                    pump: { count: 1, power: 30 }
                                                                },
                                                                actuators: {
                                                                    damperFresh: { count: 2, voltage: '24' },
                                                                    damperExhaust: { count: 2, voltage: '24' },
                                                                    damperReturn: { count: 2, voltage: '24' },
                                                                    steamValve: { count: 1, voltage: '24' }
                                                                },
                                                                sensors: {
                                                                    temperature: { count: 2, type: '4-20ma' },
                                                                    humidity: { count: 2, type: '4-20ma' },
                                                                    microSwitch: { count: 5 },
                                                                    pressure: 2
                                                                },
                                                                safety: {
                                                                    emergencyButtons: 3
                                                                },
                                                                indicators: {
                                                                    lamps: 8
                                                                },
                                                                optional: {
                                                                    vfd: { count: 0, power: 30 },
                                                                    softStarter: { count: 2, power: 30 },
                                                                    hmi: { count: 1, size: '7' },
                                                                    cabinetTemp: { count: 1, enabled: false }
                                                                },
                                                                layout: {
                                                                    plc: { width: 30, height: 25, margin: 5 },
                                                                    vfd: { width: 40, height: 40, margin: 5 },
                                                                    softStarter: { width: 40, height: 20, margin: 4 },
                                                                    contactor: { width: 16, height: 20, margin: 4 },
                                                                    relay: { width: 2, height: 10, margin: 0 },
                                                                    cabinetWidth: 120,
                                                                    cabinetHeight: 200,
                                                                    cabinetDepth: 50
                                                                }
                                                            };
                                                            this.showNotificationFunc('بارگذاری تمپلیت', 'تمپلیت AC Station Soft Starter بارگذاری شد.', 'success');
                                                            break;
                                                        case 'vfd':
                                                            this.plcDesign.optional.vfd.count = 2;
                                                            this.plcDesign.optional.softStarter.count = 0;
                                                            this.showNotificationFunc('بارگذاری تمپلیت', 'تمپلیت AC Station VFD بارگذاری شد.', 'success');
                                                            break;
                                                        case 'filter-soft':
                                                            this.plcDesign.motors.fanFeed.count = 1;
                                                            this.plcDesign.motors.fanFeed.power = 75;
                                                            this.plcDesign.optional.softStarter.count = 1;
                                                            this.showNotificationFunc('بارگذاری تمپلیت', 'تمپلیت Filter Plant Soft Starter بارگذاری شد.', 'success');
                                                            break;
                                                        case 'filter-vfd':
                                                            this.plcDesign.motors.fanFeed.count = 1;
                                                            this.plcDesign.motors.fanFeed.power = 75;
                                                            this.plcDesign.optional.vfd.count = 1;
                                                            this.plcDesign.optional.softStarter.count = 0;
                                                            this.showNotificationFunc('بارگذاری تمپلیت', 'تمپلیت Filter Plant VFD بارگذاری شد.', 'success');
                                                            break;
                                                    }
                                                },
                                                
                                                loadPLCTemplate(template) {
                                                    this.loadTemplate(template);
                                                },
                                                
                                                generatePLCCode() {
                                                    this.showNotificationFunc('تولید کد PLC', 'کد برنامه PLC با موفقیت تولید شد.', 'success');
                                                },
                                                
                                                // BOM Methods
                                                exportBOM() {
                                                    this.showNotificationFunc('خروجی BOM', 'فایل Excel لیست مواد و تجهیزات ایجاد شد.', 'success');
                                                },
                                                
                                                printBOM() {
                                                    window.print();
                                                    this.showNotificationFunc('چاپ BOM', 'لیست مواد و تجهیزات برای چاپ آماده شد.', 'info');
                                                },
                                                
                                                addBOMItem() {
                                                    const newId = this.bomItems.length > 0 ? Math.max(...this.bomItems.map(i => i.id)) + 1 : 1;
                                                    this.bomItems.push({
                                                        id: newId,
                                                        code: `ITEM-${newId.toString().padStart(3, '0')}`,
                                                        description: 'آیتم جدید',
                                                        specs: 'مشخصات فنی',
                                                        standard: 'استاندارد',
                                                        quantity: 1,
                                                        unit: 'عدد',
                                                        unitPrice: 0,
                                                        supplier: 'تأمین کننده',
                                                        category: 'plc'
                                                    });
                                                    
                                                    this.showNotificationFunc('افزودن آیتم', 'آیتم جدید به لیست BOM اضافه شد.', 'success');
                                                },
                                                
                                                editBOMItem(item) {
                                                    this.showNotificationFunc('ویرایش آیتم', `آیتم ${item.code} برای ویرایش انتخاب شد.`, 'info');
                                                },
                                                
                                                deleteBOMItem(id) {
                                                    if (confirm('آیا از حذف این آیتم اطمینان دارید؟')) {
                                                        const index = this.bomItems.findIndex(i => i.id === id);
                                                        if (index !== -1) {
                                                            const itemCode = this.bomItems[index].code;
                                                            this.bomItems.splice(index, 1);
                                                            this.showNotificationFunc('حذف آیتم', `آیتم ${itemCode} از لیست BOM حذف شد.`, 'success');
                                                        }
                                                    }
                                                },
                                                
                                                increaseQuantity(item) {
                                                    item.quantity++;
                                                },
                                                
                                                decreaseQuantity(item) {
                                                    if (item.quantity > 1) {
                                                        item.quantity--;
                                                    }
                                                },
                                                
                                                loadBOMTemplate() {
                                                    this.showNotificationFunc('بارگذاری تمپلیت BOM', 'تمپلیت استاندارد BOM بارگذاری شد.', 'success');
                                                },
                                                
                                                // Report Methods
                                                generateReport(type) {
                                                    this.selectedReport = type;
                                                    this.activeTab = 'reports';
                                                    
                                                    let message = '';
                                                    switch(type) {
                                                        case 'bom':
                                                            message = 'گزارش BOM تولید شد.';
                                                            break;
                                                        case 'mto':
                                                            message = 'گزارش MTO تولید شد.';
                                                            break;
                                                        case 'cost':
                                                            message = 'گزارش هزینه تولید شد.';
                                                            break;
                                                        case 'drawings':
                                                            message = 'نقشه‌های فنی تولید شدند.';
                                                            break;
                                                        case 'documents':
                                                            message = 'مستندات فنی تولید شدند.';
                                                            break;
                                                        case 'scenario':
                                                            message = 'گزارش سناریو کنترل تولید شد.';
                                                            break;
                                                    }
                                                    
                                                    this.showNotificationFunc('تولید گزارش', message, 'success');
                                                }
                                            }
                                        }
                                    </script>
</body>
</html>